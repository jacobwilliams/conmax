<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="CONMAX -- General nonlinearly constrained function minimization">
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>conenr &ndash; conmax</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">conmax </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../sourcefile/conmax.f90.html">Source File</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>conenr
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 7.3% of total for procedures.">250 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/conmax.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/conmax.f90.html'>conmax.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/conmax_module.html'>conmax_module</a></li>
            <li class="breadcrumb-item active" aria-current="page">conenr</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/conenr.html#src">conenr</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>private  subroutine conenr(n, m, Pmat1, r, Istrt1, Ncor, Icor, Tol, Iwork, Liwrk, Work, Lwrk, Vec, Ptnrr, Picor, Nparm, Numgr, Coef, Ptnr, Dist, Nmaj, Nmin, Jflag)  
</h2>
    

    <p>Given m n-dimensional vectors p(j) as the first m columns
of the matrix pmat1 and an n-vector r, this subroutine returns in
ptnr the nearest point to r in the cone of points summation(
coef(j)*p(j)), where coef(j) &gt;= 0.0 for j=1,...,m (unless jflag &gt; 0,
which indicates failure).  the number of vectors p(j) in
the final corral is returned in ncor with their indices in icor,
the distance is returned in dist, the number of major cycles (i.e.
adding a vector) is returned in nmaj, and the number of minor cycles
(i.e. removing a vector) is returned in nmin.  if the user sets
istrt1=0 the subroutne starts from scratch, but the user can set
istrt1=1 and initially specify ncor, icor, and coef (noting that ncor
must be &lt;= n, and if j does not occur in icor, then coef(j) should
be set to 0.0.)</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-n~3"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-m~6"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>m</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-pmat1~2"></span>
              real(kind=wp)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Pmat1</strong>(Nparm+1,Numgr)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-r~2"></span>
              real(kind=wp)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>r</strong>(Nparm+1)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-istrt1"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Istrt1</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncor~3"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ncor</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icor~2"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Icor</strong>(Nparm+1)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tol"></span>
              real(kind=wp)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Tol</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iwork~12"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Iwork</strong>(Liwrk)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-liwrk~12"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Liwrk</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-work~11"></span>
              real(kind=wp)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Work</strong>(Lwrk)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwrk~11"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Lwrk</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-vec"></span>
              real(kind=wp)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Vec</strong>(Nparm+1)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ptnrr"></span>
              real(kind=wp)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ptnrr</strong>(Nparm+1)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-picor"></span>
              real(kind=wp)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Picor</strong>(Nparm+1,Nparm+1)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nparm~18"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Nparm</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-numgr~19"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Numgr</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-coef~2"></span>
              real(kind=wp)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Coef</strong>(Numgr)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ptnr~2"></span>
              real(kind=wp)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ptnr</strong>(Nparm+1)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dist"></span>
              real(kind=wp)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Dist</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nmaj~2"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Nmaj</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nmin~2"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Nmin</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jflag~2"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Jflag</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~conenr~~CallsGraph Pages: 1 -->
<svg id="procconenrCallsGraph" width="152pt" height="116pt"
 viewBox="0.00 0.00 152.00 116.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~conenr~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 112)">
<title>proc~~conenr~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-112 148,-112 148,4 -4,4"/>
<!-- proc~conenr -->
<g id="proc~~conenr~~CallsGraph_node1" class="node">
<title>proc~conenr</title>
<polygon fill="none" stroke="black" points="54,-66 0,-66 0,-42 54,-42 54,-66"/>
<text text-anchor="middle" x="27" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50">conenr</text>
</g>
<!-- proc~dotprd -->
<g id="proc~~conenr~~CallsGraph_node2" class="node">
<title>proc~dotprd</title>
<g id="a_proc~~conenr~~CallsGraph_node2"><a xlink:href="../proc/dotprd.html" xlink:title="dotprd">
<polygon fill="#d94e8f" stroke="#d94e8f" points="144,-108 90,-108 90,-84 144,-84 144,-108"/>
<text text-anchor="middle" x="117" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dotprd</text>
</a>
</g>
</g>
<!-- proc~conenr&#45;&gt;proc~dotprd -->
<g id="proc~~conenr~~CallsGraph_edge1" class="edge">
<title>proc~conenr&#45;&gt;proc~dotprd</title>
<path fill="none" stroke="#000000" d="M53.45,-66.15C62.21,-70.33 72.17,-75.08 81.52,-79.54"/>
<polygon fill="#000000" stroke="#000000" points="80.07,-82.73 90.6,-83.88 83.09,-76.41 80.07,-82.73"/>
</g>
<!-- proc~house -->
<g id="proc~~conenr~~CallsGraph_node3" class="node">
<title>proc~house</title>
<g id="a_proc~~conenr~~CallsGraph_node3"><a xlink:href="../proc/house.html" xlink:title="house">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-66 90,-66 90,-42 144,-42 144,-66"/>
<text text-anchor="middle" x="117" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">house</text>
</a>
</g>
</g>
<!-- proc~conenr&#45;&gt;proc~house -->
<g id="proc~~conenr~~CallsGraph_edge2" class="edge">
<title>proc~conenr&#45;&gt;proc~house</title>
<path fill="none" stroke="#000000" d="M54.4,-54C62.39,-54 71.31,-54 79.82,-54"/>
<polygon fill="#000000" stroke="#000000" points="79.92,-57.5 89.92,-54 79.92,-50.5 79.92,-57.5"/>
</g>
<!-- proc~iloc -->
<g id="proc~~conenr~~CallsGraph_node4" class="node">
<title>proc~iloc</title>
<g id="a_proc~~conenr~~CallsGraph_node4"><a xlink:href="../proc/iloc.html" xlink:title="iloc">
<polygon fill="#d94e8f" stroke="#d94e8f" points="144,-24 90,-24 90,0 144,0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iloc</text>
</a>
</g>
</g>
<!-- proc~conenr&#45;&gt;proc~iloc -->
<g id="proc~~conenr~~CallsGraph_edge3" class="edge">
<title>proc~conenr&#45;&gt;proc~iloc</title>
<path fill="none" stroke="#000000" d="M53.45,-41.85C62.21,-37.67 72.17,-32.92 81.52,-28.46"/>
<polygon fill="#000000" stroke="#000000" points="83.09,-31.59 90.6,-24.12 80.07,-25.27 83.09,-31.59"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Called by</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~conenr~~CalledByGraph Pages: 1 -->
<svg id="procconenrCalledByGraph" width="641pt" height="116pt"
 viewBox="0.00 0.00 641.00 116.06" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~conenr~~CalledByGraph" class="graph" transform="scale(0.76 0.76) rotate(0) translate(4 149)">
<title>proc~~conenr~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-149 841,-149 841,4 -4,4"/>
<!-- proc~conenr -->
<g id="proc~~conenr~~CalledByGraph_node1" class="node">
<title>proc~conenr</title>
<polygon fill="none" stroke="black" points="837,-64.97 783,-64.97 783,-40.97 837,-40.97 837,-64.97"/>
<text text-anchor="middle" x="810" y="-50.57" font-family="Helvetica,sans-Serif" font-size="10.50">conenr</text>
</g>
<!-- proc~wolfe -->
<g id="proc~~conenr~~CalledByGraph_node2" class="node">
<title>proc~wolfe</title>
<g id="a_proc~~conenr~~CalledByGraph_node2"><a xlink:href="../proc/wolfe.html" xlink:title="wolfe">
<polygon fill="#d9534f" stroke="#d9534f" points="747,-64.97 693,-64.97 693,-40.97 747,-40.97 747,-64.97"/>
<text text-anchor="middle" x="720" y="-50.57" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wolfe</text>
</a>
</g>
</g>
<!-- proc~wolfe&#45;&gt;proc~conenr -->
<g id="proc~~conenr~~CalledByGraph_edge1" class="edge">
<title>proc~wolfe&#45;&gt;proc~conenr</title>
<path fill="none" stroke="#000000" d="M747.4,-52.97C755.39,-52.97 764.31,-52.97 772.82,-52.97"/>
<polygon fill="#000000" stroke="#000000" points="772.92,-56.47 782.92,-52.97 772.92,-49.47 772.92,-56.47"/>
</g>
<!-- proc~conmax -->
<g id="proc~~conenr~~CalledByGraph_node3" class="node">
<title>proc~conmax</title>
<g id="a_proc~~conenr~~CalledByGraph_node3"><a xlink:href="../proc/conmax.html" xlink:title="conmax_solver%conmax">
<polygon fill="#d9534f" stroke="#d9534f" points="145,-124.97 0,-124.97 0,-100.97 145,-100.97 145,-124.97"/>
<text text-anchor="middle" x="72.5" y="-110.57" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmax_solver%conmax</text>
</a>
</g>
</g>
<!-- proc~conmax&#45;&gt;proc~wolfe -->
<g id="proc~~conenr~~CalledByGraph_edge2" class="edge">
<title>proc~conmax&#45;&gt;proc~wolfe</title>
<path fill="none" stroke="#000000" d="M124.33,-124.99C142.14,-128.64 162.36,-132.17 181,-133.97 316.81,-147.11 352.48,-149.79 488,-133.97 564.67,-125.02 586.16,-124.62 657,-93.97 670.64,-88.07 684.56,-79.18 695.75,-71.18"/>
<polygon fill="#000000" stroke="#000000" points="698.11,-73.79 704.07,-65.03 693.95,-68.16 698.11,-73.79"/>
</g>
<!-- proc~rkcon -->
<g id="proc~~conenr~~CalledByGraph_node5" class="node">
<title>proc~rkcon</title>
<g id="a_proc~~conenr~~CalledByGraph_node5"><a xlink:href="../proc/rkcon.html" xlink:title="conmax_solver%rkcon">
<polygon fill="#d9534f" stroke="#d9534f" points="316,-82.97 183,-82.97 183,-58.97 316,-58.97 316,-82.97"/>
<text text-anchor="middle" x="249.5" y="-68.57" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmax_solver%rkcon</text>
</a>
</g>
</g>
<!-- proc~conmax&#45;&gt;proc~rkcon -->
<g id="proc~~conenr~~CalledByGraph_edge9" class="edge">
<title>proc~conmax&#45;&gt;proc~rkcon</title>
<path fill="none" stroke="#000000" d="M123.65,-100.94C143.88,-96.08 167.38,-90.44 188.51,-85.37"/>
<polygon fill="#000000" stroke="#000000" points="189.44,-88.75 198.34,-83.01 187.8,-81.94 189.44,-88.75"/>
</g>
<!-- proc~slpcon -->
<g id="proc~~conenr~~CalledByGraph_node8" class="node">
<title>proc~slpcon</title>
<g id="a_proc~~conenr~~CalledByGraph_node8"><a xlink:href="../proc/slpcon.html" xlink:title="conmax_solver%slpcon">
<polygon fill="#d9534f" stroke="#d9534f" points="318,-124.97 181,-124.97 181,-100.97 318,-100.97 318,-124.97"/>
<text text-anchor="middle" x="249.5" y="-110.57" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmax_solver%slpcon</text>
</a>
</g>
</g>
<!-- proc~conmax&#45;&gt;proc~slpcon -->
<g id="proc~~conenr~~CalledByGraph_edge13" class="edge">
<title>proc~conmax&#45;&gt;proc~slpcon</title>
<path fill="none" stroke="#000000" d="M145.18,-112.97C153.57,-112.97 162.16,-112.97 170.63,-112.97"/>
<polygon fill="#000000" stroke="#000000" points="170.87,-116.47 180.87,-112.97 170.87,-109.47 170.87,-116.47"/>
</g>
<!-- proc~corrct -->
<g id="proc~~conenr~~CalledByGraph_node4" class="node">
<title>proc~corrct</title>
<g id="a_proc~~conenr~~CalledByGraph_node4"><a xlink:href="../proc/corrct.html" xlink:title="conmax_solver%corrct">
<polygon fill="#d9534f" stroke="#d9534f" points="657,-84.97 524,-84.97 524,-60.97 657,-60.97 657,-84.97"/>
<text text-anchor="middle" x="590.5" y="-70.57" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmax_solver%corrct</text>
</a>
</g>
</g>
<!-- proc~corrct&#45;&gt;proc~wolfe -->
<g id="proc~~conenr~~CalledByGraph_edge3" class="edge">
<title>proc~corrct&#45;&gt;proc~wolfe</title>
<path fill="none" stroke="#000000" d="M657.12,-62.68C665.94,-61.3 674.72,-59.92 682.77,-58.66"/>
<polygon fill="#000000" stroke="#000000" points="683.54,-62.08 692.88,-57.07 682.46,-55.16 683.54,-62.08"/>
</g>
<!-- proc~rkcon&#45;&gt;proc~wolfe -->
<g id="proc~~conenr~~CalledByGraph_edge4" class="edge">
<title>proc~rkcon&#45;&gt;proc~wolfe</title>
<path fill="none" stroke="#000000" d="M265.85,-58.78C285.12,-44.31 319.81,-21.03 354,-11.97 471.84,19.26 617.25,-19.03 683.32,-40.41"/>
<polygon fill="#000000" stroke="#000000" points="682.26,-43.75 692.85,-43.56 684.45,-37.1 682.26,-43.75"/>
</g>
<!-- proc~rkcon&#45;&gt;proc~corrct -->
<g id="proc~~conenr~~CalledByGraph_edge6" class="edge">
<title>proc~rkcon&#45;&gt;proc~corrct</title>
<path fill="none" stroke="#000000" d="M316.26,-71.36C372.87,-71.69 454.56,-72.18 513.86,-72.53"/>
<polygon fill="#000000" stroke="#000000" points="513.9,-76.03 523.92,-72.59 513.94,-69.03 513.9,-76.03"/>
</g>
<!-- proc~rkpar -->
<g id="proc~~conenr~~CalledByGraph_node6" class="node">
<title>proc~rkpar</title>
<g id="a_proc~~conenr~~CalledByGraph_node6"><a xlink:href="../proc/rkpar.html" xlink:title="conmax_solver%rkpar">
<polygon fill="#d9534f" stroke="#d9534f" points="486.5,-44.97 355.5,-44.97 355.5,-20.97 486.5,-20.97 486.5,-44.97"/>
<text text-anchor="middle" x="421" y="-30.57" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmax_solver%rkpar</text>
</a>
</g>
</g>
<!-- proc~rkcon&#45;&gt;proc~rkpar -->
<g id="proc~~conenr~~CalledByGraph_edge10" class="edge">
<title>proc~rkcon&#45;&gt;proc~rkpar</title>
<path fill="none" stroke="#000000" d="M304.13,-58.95C320.75,-55.22 339.23,-51.08 356.45,-47.22"/>
<polygon fill="#000000" stroke="#000000" points="357.44,-50.59 366.43,-44.98 355.9,-43.76 357.44,-50.59"/>
</g>
<!-- proc~searsl -->
<g id="proc~~conenr~~CalledByGraph_node7" class="node">
<title>proc~searsl</title>
<g id="a_proc~~conenr~~CalledByGraph_node7"><a xlink:href="../proc/searsl.html" xlink:title="conmax_solver%searsl">
<polygon fill="#d9534f" stroke="#d9534f" points="488,-124.97 354,-124.97 354,-100.97 488,-100.97 488,-124.97"/>
<text text-anchor="middle" x="421" y="-110.57" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmax_solver%searsl</text>
</a>
</g>
</g>
<!-- proc~rkcon&#45;&gt;proc~searsl -->
<g id="proc~~conenr~~CalledByGraph_edge11" class="edge">
<title>proc~rkcon&#45;&gt;proc~searsl</title>
<path fill="none" stroke="#000000" d="M299.07,-83.01C318.58,-87.84 341.23,-93.45 361.62,-98.51"/>
<polygon fill="#000000" stroke="#000000" points="360.87,-101.93 371.42,-100.94 362.56,-95.13 360.87,-101.93"/>
</g>
<!-- proc~rkpar&#45;&gt;proc~wolfe -->
<g id="proc~~conenr~~CalledByGraph_edge5" class="edge">
<title>proc~rkpar&#45;&gt;proc~wolfe</title>
<path fill="none" stroke="#000000" d="M486.81,-37.34C546.92,-41.38 634.19,-47.26 682.82,-50.54"/>
<polygon fill="#000000" stroke="#000000" points="682.66,-54.03 692.87,-51.21 683.13,-47.05 682.66,-54.03"/>
</g>
<!-- proc~rkpar&#45;&gt;proc~corrct -->
<g id="proc~~conenr~~CalledByGraph_edge7" class="edge">
<title>proc~rkpar&#45;&gt;proc~corrct</title>
<path fill="none" stroke="#000000" d="M472.26,-44.97C490.14,-49.25 510.47,-54.1 529.12,-58.55"/>
<polygon fill="#000000" stroke="#000000" points="528.45,-61.99 538.99,-60.91 530.08,-55.18 528.45,-61.99"/>
</g>
<!-- proc~searsl&#45;&gt;proc~corrct -->
<g id="proc~~conenr~~CalledByGraph_edge8" class="edge">
<title>proc~searsl&#45;&gt;proc~corrct</title>
<path fill="none" stroke="#000000" d="M472.26,-100.97C490.14,-96.7 510.47,-91.84 529.12,-87.39"/>
<polygon fill="#000000" stroke="#000000" points="530.08,-90.76 538.99,-85.03 528.45,-83.95 530.08,-90.76"/>
</g>
<!-- proc~slpcon&#45;&gt;proc~searsl -->
<g id="proc~~conenr~~CalledByGraph_edge12" class="edge">
<title>proc~slpcon&#45;&gt;proc~searsl</title>
<path fill="none" stroke="#000000" d="M318.47,-112.97C326.78,-112.97 335.32,-112.97 343.75,-112.97"/>
<polygon fill="#000000" stroke="#000000" points="343.95,-116.47 353.95,-112.97 343.95,-109.47 343.95,-116.47"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprocconenrCalledByGraph = svgPanZoom('#procconenrCalledByGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">    </span><span class="k">subroutine </span><span class="n">conenr</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">Pmat1</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">Istrt1</span><span class="p">,</span><span class="w"> </span><span class="n">Ncor</span><span class="p">,</span><span class="w"> </span><span class="n">Icor</span><span class="p">,</span><span class="w"> </span><span class="n">Tol</span><span class="p">,</span><span class="w"> </span><span class="n">Iwork</span><span class="p">,</span><span class="w"> </span><span class="n">Liwrk</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">Work</span><span class="p">,</span><span class="w"> </span><span class="n">Lwrk</span><span class="p">,</span><span class="w"> </span><span class="n">Vec</span><span class="p">,</span><span class="w"> </span><span class="n">Ptnrr</span><span class="p">,</span><span class="w"> </span><span class="n">Picor</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">,</span><span class="w"> </span><span class="n">Coef</span><span class="p">,</span><span class="w"> </span><span class="n">Ptnr</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">Dist</span><span class="p">,</span><span class="w"> </span><span class="n">Nmaj</span><span class="p">,</span><span class="w"> </span><span class="n">Nmin</span><span class="p">,</span><span class="w"> </span><span class="n">Jflag</span><span class="p">)</span>

<span class="w">        </span><span class="k">implicit none</span>

<span class="k">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Liwrk</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Lwrk</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Nparm</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Numgr</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Istrt1</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Jflag</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Ncor</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Nmaj</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Nmin</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Dist</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Tol</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Coef</span><span class="p">(</span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Icor</span><span class="p">(</span><span class="n">Nparm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="n">Liwrk</span><span class="p">)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Picor</span><span class="p">(</span><span class="n">Nparm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Pmat1</span><span class="p">(</span><span class="n">Nparm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Ptnr</span><span class="p">(</span><span class="n">Nparm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Ptnrr</span><span class="p">(</span><span class="n">Nparm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="n">Nparm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Vec</span><span class="p">(</span><span class="n">Nparm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">Lwrk</span><span class="p">)</span>

<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">amax</span><span class="p">,</span><span class="w"> </span><span class="nb">amin</span><span class="p">,</span><span class="w"> </span><span class="n">cjj</span><span class="p">,</span><span class="w"> </span><span class="n">diff</span><span class="p">,</span><span class="w"> </span><span class="nb">dmax</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">dsq</span><span class="p">,</span><span class="w"> </span><span class="n">omt</span><span class="p">,</span><span class="w"> </span><span class="n">pdotj</span><span class="p">,</span><span class="w"> </span><span class="n">quot</span><span class="p">,</span><span class="w"> </span><span class="n">theta</span><span class="p">,</span><span class="w"> </span><span class="n">tst</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">icoro</span><span class="p">,</span><span class="w"> </span><span class="n">ihouse</span><span class="p">,</span><span class="w"> </span><span class="n">ii</span><span class="p">,</span><span class="w"> </span><span class="n">ilc01</span><span class="p">,</span><span class="w"> </span><span class="n">ilc03</span><span class="p">,</span><span class="w"> </span><span class="n">ilc04</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">ilc09</span><span class="p">,</span><span class="w"> </span><span class="n">ilc23</span><span class="p">,</span><span class="w"> </span><span class="n">ilc34</span><span class="p">,</span><span class="w"> </span><span class="n">itst1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">jj</span><span class="p">,</span><span class="w"> </span><span class="n">jmax</span><span class="p">,</span><span class="w"> </span><span class="n">jmin</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">kntsl</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">limsl</span><span class="p">,</span><span class="w"> </span><span class="n">ll</span><span class="p">,</span><span class="w"> </span><span class="n">mincf</span><span class="p">,</span><span class="w"> </span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">ncoro</span><span class="p">,</span><span class="w"> </span><span class="n">ndm</span>

<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tolel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ten</span><span class="o">*</span><span class="n">ten</span><span class="o">*</span><span class="n">spcmn</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">z1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ten</span><span class="o">*</span><span class="n">tolel</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">z2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ten</span><span class="o">*</span><span class="n">z1</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">z3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ten</span><span class="o">*</span><span class="n">z1</span>

<span class="w">        </span><span class="n">ilc01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">        </span><span class="n">ilc03</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">        </span><span class="n">ilc04</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">        </span><span class="n">ilc09</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">        </span><span class="n">ilc23</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">        </span><span class="n">ilc34</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">34</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">        </span><span class="n">kntsl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">limsl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span>
<span class="w">        </span><span class="n">mp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="n">ndm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="n">Nmaj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">Nmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">Jflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">itst1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">ncoro</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Istrt1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">200</span>

<span class="w">        </span><span class="c">! HERE ISTRT1=0 SO WE START FROM SCRATCH.  FIND THE INDEX JMAX FOR</span>
<span class="w">        </span><span class="c">! WHICH (P(J).R)/SQRT(P(J).P(J)) IS MAXIMIZED FOR P(J).P(J) &gt; Z1.</span>
<span class="mi">100</span><span class="w">     </span><span class="nb">amax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">        </span><span class="n">jmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                </span><span class="n">Vec</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pmat1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">            </span><span class="n">pdotj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dotprd</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">Vec</span><span class="p">,</span><span class="w"> </span><span class="n">Vec</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pdotj</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">z1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">quot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dotprd</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">Vec</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">)</span><span class="o">/</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">pdotj</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">quot</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nb">amax</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="nb">amax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">quot</span>
<span class="w">                    </span><span class="n">jmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">        end do</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">jmax</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! IF AMAX IS NOT SIGINFICANTLY POSITIVE WE PROCEED AS IF IT WERE ZERO.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">amax</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">ndm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">one</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">tolel</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="c">! HERE WE FOUND THE RAY CLOSEST TO R AND WE COMPLETE THE</span>
<span class="w">                </span><span class="c">! INITIALIZATION BY SETTING NCOR=1, ICOR(1)=JMAX, AND COEF(JMAX)=1.0</span>
<span class="w">                </span><span class="c">! (WITH ALL OTHER ENTRIES OF COEF EQUAL TO ZERO).</span>
<span class="w">                </span><span class="n">Ncor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                </span><span class="n">Icor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jmax</span>
<span class="w">                </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span>
<span class="w">                    </span><span class="n">Coef</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                </span><span class="k">end do</span>
<span class="k">                </span><span class="n">Coef</span><span class="p">(</span><span class="n">jmax</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="mi">200</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">        end if</span>

<span class="w">        </span><span class="c">! HERE THERE WERE NO VECTORS P(J) WHICH HAVE BOTH LENGTH SQUARED</span>
<span class="w">        </span><span class="c">! GREATER THAN Z1 AND ANGLE WITH R SIGNIFICANTLY LESS THAN 90 DEGREES,</span>
<span class="w">        </span><span class="c">! AND WE SET NCOR=0, PTNR=THE ZERO VECTOR, COEF=THE ZERO VECTOR, DIST=</span>
<span class="w">        </span><span class="c">! THE LENGTH OF R, AND WE RETURN.</span>
<span class="w">        </span><span class="n">Ncor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">            </span><span class="n">Ptnr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">        </span><span class="k">end do</span>
<span class="k">        do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span>
<span class="w">            </span><span class="n">Coef</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">        </span><span class="k">end do</span>
<span class="k">        </span><span class="n">Dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="n">dotprd</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">))</span>
<span class="w">        </span><span class="k">return</span>

<span class="w">        </span><span class="c">! SET PTNR TO THE CURRENT NEAREST POINT.  FIRST ZERO IT OUT.</span>
<span class="mi">200</span><span class="w">     </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">            </span><span class="n">Ptnr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">        </span><span class="k">end do</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">Ncor</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! HERE NCOR &gt; 0 AND WE SET PTNR=SUMMATION(COEF(J)*P(J)).</span>
<span class="w">            </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Ncor</span>
<span class="w">                </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icor</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">                </span><span class="n">cjj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Coef</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span>
<span class="w">                </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                    </span><span class="n">Ptnr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ptnr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cjj</span><span class="o">*</span><span class="n">Pmat1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">jj</span><span class="p">)</span>
<span class="w">                </span><span class="k">end do</span>
<span class="k">            end do</span>
<span class="k">        end if</span>

<span class="w">        </span><span class="c">! PUT PTNR-R INTO PTNRR AND COMPUTE THE DISTANCE FROM PTNR TO R.</span>
<span class="w">        </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">            </span><span class="n">Ptnrr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ptnr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">        </span><span class="k">end do</span>
<span class="k">        </span><span class="n">dsq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dotprd</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">Ptnrr</span><span class="p">,</span><span class="w"> </span><span class="n">Ptnrr</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">)</span>
<span class="w">        </span><span class="n">Dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="n">dsq</span><span class="p">)</span>

<span class="w">        </span><span class="c">! NOW CHECK OPTIMALITY.</span>
<span class="w">        </span><span class="c">! FIRST SEE WHETHER THE HYPERPLANE THROUGH PTNR PERPENDICULAR TO</span>
<span class="w">        </span><span class="c">! PTNR-R PASSES THROUGH THE ORIGIN.  IF NCOR=0 THIS WILL</span>
<span class="w">        </span><span class="c">! AUTOMATICALLY BE TRUE SINCE THEN PTNR IS THE ORIGIN.  IF IT IS NOT</span>
<span class="w">        </span><span class="c">! TRUE WE GO DOWN TO SOLVE FOR A NEW NEAREST POINT IN THE SUBSPACE</span>
<span class="w">        </span><span class="c">! DETERMINED BY THE CURRENT ICOR.</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Ncor</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">tst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dotprd</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">Ptnr</span><span class="p">,</span><span class="w"> </span><span class="n">Ptnrr</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">tst</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">z1</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">300</span>
<span class="w">        </span><span class="k">end if</span>
<span class="w">        </span><span class="c">! HERE THE HYPERPLANE ROUGHLY PASSES THROUGH THE ORIGIN, AND WE</span>
<span class="w">        </span><span class="c">! CHECK WHETHER ALL P(J) VECTORS ARE ROUGHLY SEPARATED FROM R BY IT.</span>
<span class="w">        </span><span class="c">! PUT THE MINIMUM OF (PTNR-R).(P(J)-R) IN AMIN AND THE INDEX WHERE IT</span>
<span class="w">        </span><span class="c">! IS ACHIEVED IN JMIN.</span>
<span class="w">        </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">            </span><span class="n">Vec</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pmat1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">        </span><span class="k">end do</span>
<span class="k">        </span><span class="n">jmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="nb">amin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dotprd</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">Ptnrr</span><span class="p">,</span><span class="w"> </span><span class="n">Vec</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">m</span>
<span class="w">                </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                    </span><span class="n">Vec</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pmat1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                </span><span class="k">end do</span>
<span class="k">                </span><span class="n">dp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dotprd</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">Ptnrr</span><span class="p">,</span><span class="w"> </span><span class="n">Vec</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dp</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nb">amin</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="nb">amin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dp</span>
<span class="w">                    </span><span class="n">jmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end do</span>
<span class="k">        end if</span>

<span class="w">        </span><span class="c">! FOR TESTING PURPOSES COMPUTE THE MAXIMUM OF THE SQUARES OF THE</span>
<span class="w">        </span><span class="c">! LENGTHS OF THE DISTANCES CONSIDERED.</span>
<span class="w">        </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">            </span><span class="n">Vec</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pmat1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">jmin</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">        </span><span class="k">end do</span>
<span class="k">        </span><span class="nb">dmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dotprd</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">Vec</span><span class="p">,</span><span class="w"> </span><span class="n">Vec</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Ncor</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Ncor</span>
<span class="w">                </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icor</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">                </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                    </span><span class="n">Vec</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pmat1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                </span><span class="k">end do</span>
<span class="k">                </span><span class="n">dp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dotprd</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">Vec</span><span class="p">,</span><span class="w"> </span><span class="n">Vec</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nb">dmax</span><span class="p">)</span><span class="w"> </span><span class="nb">dmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dp</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">        end if</span>
<span class="w">        </span><span class="c">! DO THE TEST.  IF IT IS SUCCESSFUL, THEN WE HAVE (APPROXIMATE)</span>
<span class="w">        </span><span class="c">! OPTIMALITY AND WE RETURN.</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">amin</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dsq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z1</span><span class="o">*</span><span class="nb">dmax</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! HERE PTNR IS NOT OPTIMAL.  AS A CHECK AGAINST BLUNDERS WE MAKE SURE</span>
<span class="w">            </span><span class="c">! NCOR &lt; N AND JMIN IS NOT IN ICOR.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Ncor</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">Ncor</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    do </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Ncor</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jmin</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Icor</span><span class="p">(</span><span class="n">l</span><span class="p">))</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">220</span>
<span class="w">                    </span><span class="k">end do</span>
<span class="k">                    goto</span><span class="w"> </span><span class="mi">250</span>
<span class="w">                </span><span class="k">end if</span>
<span class="w">                </span><span class="c">! HERE WE HAVE BLUNDERED SO WE SET JFLAG=1 AS A WARNING, COMPUTE DIST,</span>
<span class="w">                </span><span class="c">! AND RETURN.  FIRST TRY FROM SCRATCH IF THIS HAS NOT BEEN DONE.</span>
<span class="mi">220</span><span class="w">             </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Istrt1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Jflag</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">Jflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="c">! write(nwrit,&#39;(A)&#39;) &#39;*****JFLAG IS 1 IN CONENR&#39;</span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                else</span>
<span class="k">                    </span><span class="n">Jflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                    </span><span class="n">kntsl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                    </span><span class="k">goto</span><span class="w"> </span><span class="mi">100</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="w">            </span><span class="c">! HERE PTNR IS NOT OPTIMAL, NCOR &lt; N, AND JMIN IS NOT IN ICOR.</span>
<span class="w">            </span><span class="c">! WE INCREMENT THE MAJOR CYCLE COUNTER AND ADD P(JMIN).</span>
<span class="mi">250</span><span class="w">         </span><span class="n">Nmaj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Nmaj</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="n">Ncor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ncor</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="n">Icor</span><span class="p">(</span><span class="n">Ncor</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jmin</span>
<span class="w">            </span><span class="n">Coef</span><span class="p">(</span><span class="n">jmin</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">        </span><span class="k">else</span>
<span class="k">            return</span>
<span class="k">        end if</span>

<span class="w">        </span><span class="c">! CHECK TO SEE IF WE HAVE SOLVED THE SYSTEM BELOW LIMSL TIMES ALREADY,</span>
<span class="w">        </span><span class="c">! AND IF SO, SET JFLAG=6 AS A WARNING AND RETURN (BUT</span>
<span class="w">        </span><span class="c">! TRY FROM SCRATCH BEFORE GIVING UP IF THIS HAS NOT ALREADY BEEN DONE).</span>
<span class="mi">300</span><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">kntsl</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">limsl</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="w">            </span><span class="c">! CHECK TO SEE IF NCOR AND THE LAST ELEMENT IN ICOR ARE UNCHANGED FROM THE</span>
<span class="w">            </span><span class="c">! PREVIOUS HOUSE CALL (HA HA), WHICH INDICATES FAILURE.  NOTE THAT HERE WE</span>
<span class="w">            </span><span class="c">! MUST HAVE NCOR &gt; 0.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Ncor</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">ncoro</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">ncoro</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ncor</span>
<span class="w">            </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">Icor</span><span class="p">(</span><span class="n">Ncor</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">icoro</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="c">! HERE WE HAVE CYCLING AND WE SET JFLAG=2 AS A WARNING AND RETURN.  FIRST</span>
<span class="w">                </span><span class="c">! TRY FROM SCRATCH IF THIS HAS NOT BEEN DONE.</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Istrt1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Jflag</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">Jflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                else</span>
<span class="k">                    </span><span class="n">Jflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                    </span><span class="n">kntsl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                    </span><span class="k">goto</span><span class="w"> </span><span class="mi">100</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">            </span><span class="n">icoro</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icor</span><span class="p">(</span><span class="n">Ncor</span><span class="p">)</span>
<span class="w">            </span><span class="n">kntsl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kntsl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>

<span class="w">            </span><span class="c">! NOW WE SOLVE THE SYSTEM PICOR*VEC = R IN THE LEAST SQUARES</span>
<span class="w">            </span><span class="c">! SENSE FOR THE COEFFICIENT VECTOR VEC (RELATIVE TO</span>
<span class="w">            </span><span class="c">! ICOR) OF THE NEAREST POINT TO R IN THE SUBSPACE SPANNED BY</span>
<span class="w">            </span><span class="c">! P(ICOR(1)),...,P(ICOR(NCOR)), WHERE P(ICOR) IS THE N X NCOR MATRIX</span>
<span class="w">            </span><span class="c">! WHOSE COLUMNS ARE THESE VECTORS.</span>
<span class="w">            </span><span class="c">! NOW FILL IN PICOR AND CALL HOUSE TO COMPUTE VEC.</span>
<span class="w">            </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Ncor</span>
<span class="w">                </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icor</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">                </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                    </span><span class="n">Picor</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pmat1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">jj</span><span class="p">)</span>
<span class="w">                </span><span class="k">end do</span>
<span class="k">            end do</span>

<span class="k">            call </span><span class="n">house</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">Ncor</span><span class="p">,</span><span class="w"> </span><span class="n">Picor</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="n">ilc23</span><span class="p">),</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc01</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                       </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc04</span><span class="p">),</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc09</span><span class="p">),</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc34</span><span class="p">),</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc03</span><span class="p">),</span><span class="w"> </span><span class="n">Vec</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                       </span><span class="n">ihouse</span><span class="p">)</span>

<span class="w">            </span><span class="c">! IF HOUSE FAILS (INDICATED BY IHOUSE=1) WE SET JFLAG=3 AS A</span>
<span class="w">            </span><span class="c">! WARNING AND RETURN.  FIRST TRY FROM SCRATCH IF THIS HAS NOT BEEN DONE.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ihouse</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="c">! CHECK TO SEE IF ALL THE COEFFICIENTS IN VEC ARE &gt; Z2, AND IF SO,</span>
<span class="w">                </span><span class="c">! PUT VEC INTO COEF AND GO BACK TO COMPUTE PTNR.  THE COEFFICIENTS IN</span>
<span class="w">                </span><span class="c">! COEF NOT CORRESPONDING TO THOSE IN VEC WILL REMAIN EQUAL TO ZERO.</span>
<span class="w">                </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Ncor</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Vec</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">z2</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">350</span>
<span class="w">                </span><span class="k">end do</span>
<span class="k">                do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Ncor</span>
<span class="w">                    </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icor</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                    </span><span class="n">Coef</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vec</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                </span><span class="k">end do</span>
<span class="k">                goto</span><span class="w"> </span><span class="mi">200</span>
<span class="w">            </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">Istrt1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Jflag</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">Jflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
<span class="w">                </span><span class="k">return</span>
<span class="k">            else</span>
<span class="k">                </span><span class="n">Jflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                </span><span class="n">kntsl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="mi">100</span>
<span class="w">            </span><span class="k">end if</span>

<span class="w">            </span><span class="c">! HERE SOME ELEMENT OF VEC IS &lt;= Z2.  COMPUTE THETA=MIN(1.0, MIN(</span>
<span class="w">            </span><span class="c">! COEF(ICOR(I))/(COEF(ICOR(I))-VEC(I)): COEF(ICOR(I))-VEC(I) &gt; Z3)).</span>
<span class="mi">350</span><span class="w">         </span><span class="n">theta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">            </span><span class="k">do </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Ncor</span>
<span class="w">                </span><span class="n">ll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icor</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="w">                </span><span class="n">diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Coef</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Vec</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">diff</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">z3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">quot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Coef</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">/</span><span class="n">diff</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">quot</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">theta</span><span class="p">)</span><span class="w"> </span><span class="n">theta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">quot</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end do</span>
<span class="w">            </span><span class="c">! COMPUTE THE NEW COEF AS (1.0-THETA)*COEF+THETA*VEC.</span>
<span class="w">            </span><span class="n">omt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">theta</span>
<span class="w">            </span><span class="k">do </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Ncor</span>
<span class="w">                </span><span class="n">ll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icor</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="w">                </span><span class="n">Coef</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">omt</span><span class="o">*</span><span class="n">Coef</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theta</span><span class="o">*</span><span class="n">Vec</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>
<span class="w">            </span><span class="c">! COMPUTE THE INDEX MINCF (RELATIVE TO ICOR) OF THE SMALLEST ELEMENT OF</span>
<span class="w">            </span><span class="c">! COEF AND SET ALL ELEMENTS OF COEF WHICH ARE &lt;= Z2 TO ZERO.</span>
<span class="w">            </span><span class="n">mincf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="nb">amin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z2</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Ncor</span>
<span class="w">                </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icor</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Coef</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">z2</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="n">Coef</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nb">amin</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="nb">amin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Coef</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<span class="w">                        </span><span class="n">mincf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                    </span><span class="n">Coef</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end do</span>

<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">mincf</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="c">! HERE MINCF=0 AND AN UNLIKELY BLUNDER HAS OCCURRED.  THIS MUST BE DUE TO</span>
<span class="w">                </span><span class="c">! ROUNDOFF ERROR SINCE IN THEORY (NEW) COEF(ICOR(I)) MUST BE &lt;= Z2</span>
<span class="w">                </span><span class="c">! FOR SOME I=1,...,NCOR, WHICH MAKES MINCF &gt; 0 IN THE LAST LOOP.</span>
<span class="w">                </span><span class="c">! TO SEE THIS, FIRST NOTE THAT FOR SOME IBAR=1,...,NCOR, VEC(IBAR) MUST</span>
<span class="w">                </span><span class="c">! BE &lt;= Z2 SINCE OTHERWISE WE WOULD NOT BE HERE.  BY ITS DEFINITION,</span>
<span class="w">                </span><span class="c">! THETA MUST BE &lt;= 1.0.  IF THETA = 1.0, THEN (NEW) COEF(ICOR(IBAR))</span>
<span class="w">                </span><span class="c">! = (1.0 - THETA)*(OLD) COEF(ICOR(IBAR)) + THETA*VEC(IBAR) = VEC(IBAR)</span>
<span class="w">                </span><span class="c">! &lt;= Z2.  IF ON THE OTHER HAND THETA &lt; 1.0, THEN FOR SOME ISTAR=1,</span>
<span class="w">                </span><span class="c">! ...,ICOR WE HAVE (OLD) COEF(ICOR(ISTAR)) - VEC(ISTAR) &gt;= Z3 AND</span>
<span class="w">                </span><span class="c">! THETA = (OLD) COEF(ICOR(ISTAR))/((OLD) COEF(ICOR(ISTAR)) - VEC(ISTAR)),</span>
<span class="w">                </span><span class="c">! SO (NEW) COEF(ICOR(ISTAR)) = (1.0 - THETA)*(OLD) COEF(ICOR(ISTAR)) +</span>
<span class="w">                </span><span class="c">! THETA*VEC(ISTAR) = (-VEC(ISTAR)*(OLD) COEF(ICOR(ISTAR)) + (OLD)</span>
<span class="w">                </span><span class="c">! COEF(ICOR(ISTAR))*VEC(ISTAR))/((OLD) COEF(ICOR(ISTAR)) - VEC(ISTAR))</span>
<span class="w">                </span><span class="c">! = 0.0.  NOTE THAT WE HAVE Z2 &gt;= 0.0 AND Z3 &gt; 0.0.</span>
<span class="w">                </span><span class="c">! TO CORRECT THIS BLUNDER WE SET MINCF = AN INDEX I FOR WHICH (NEW)</span>
<span class="w">                </span><span class="c">! COEF(ICOR(I)) IS MINIMIZED AND SET COEF(ICOR(I)) = 0.0.</span>
<span class="w">                </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Ncor</span>
<span class="w">                    </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icor</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        if</span><span class="w"> </span><span class="p">(</span><span class="n">Coef</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nb">amin</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="k">                    end if</span>
<span class="k">                    </span><span class="nb">amin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Coef</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<span class="w">                    </span><span class="n">mincf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">                </span><span class="k">end do</span>
<span class="k">                </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icor</span><span class="p">(</span><span class="n">mincf</span><span class="p">)</span>
<span class="w">                </span><span class="n">Coef</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">            </span><span class="k">end if</span>
<span class="w">            </span><span class="c">! INCREMENT THE MINOR ITERATION COUNTER NMIN, REMOVE ICOR(MINCF),</span>
<span class="w">            </span><span class="c">! AND DECREMENT NCOR.</span>
<span class="w">            </span><span class="n">Nmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Nmin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">do </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Ncor</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">mincf</span><span class="p">)</span><span class="w"> </span><span class="n">Icor</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icor</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">            </span><span class="n">Ncor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ncor</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="c">! GO BACK TO COMPUTE PTNR.</span>
<span class="w">            </span><span class="k">goto</span><span class="w"> </span><span class="mi">200</span>
<span class="w">        </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">Istrt1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Jflag</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">Jflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span>
<span class="w">            </span><span class="c">! write(nwrit,&#39;(A)&#39;) &#39;*****JFLAG IS 6 IN CONENR&#39;</span>
<span class="w">            </span><span class="k">return</span>
<span class="k">        else</span>
<span class="k">            </span><span class="n">Jflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">            </span><span class="n">kntsl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="k">goto</span><span class="w"> </span><span class="mi">100</span>
<span class="w">        </span><span class="k">end if</span>

<span class="k">    end subroutine </span><span class="n">conenr</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              conmax
 was developed by Jacob Williams<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>