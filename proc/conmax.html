<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="CONMAX -- General nonlinearly constrained function minimization">
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>conmax &ndash; conmax</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">conmax </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../sourcefile/conmax.f90.html">Source File</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>conmax
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 8.3% of total for procedures.">284 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/conmax.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/conmax.f90.html'>conmax.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/conmax_module.html'>conmax_module</a></li>
            <li class="breadcrumb-item active" aria-current="page">conmax</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/conmax.html#src">conmax</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>private  subroutine conmax(me, ioptn, nparm, numgr, itlim, fun, ifun, pttbl, iptb, Indm, iwork, liwrk, work, lwrk, iter, param, error)  
</h2>
    

    <p>CONMAX consists of two programs for solving the problem</p>
<div class="codehilite"><pre><span></span><code><span class="w">     </span><span class="nv">minimize</span><span class="w"> </span><span class="nv">w</span>

<span class="w">     </span><span class="nv">subject</span><span class="w"> </span><span class="nv">to</span>

<span class="w">     </span><span class="nv">abs</span><span class="ss">(</span><span class="nv">fun</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">confun</span><span class="ss">(</span><span class="nv">i</span>,<span class="mi">1</span><span class="ss">))</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nv">w</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="nv">icntyp</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="o">=</span><span class="mi">2</span>,

<span class="w">     </span><span class="nv">confun</span><span class="ss">(</span><span class="nv">i</span>,<span class="mi">1</span><span class="ss">)</span><span class="w">               </span><span class="o">&lt;=</span><span class="w"> </span><span class="nv">w</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="nv">icntyp</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="o">=</span><span class="mi">1</span>,

<span class="w">     </span><span class="nv">confun</span><span class="ss">(</span><span class="nv">i</span>,<span class="mi">1</span><span class="ss">)</span><span class="w">               </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span>.<span class="mi">0</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">icntyp</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="o">=-</span><span class="mi">1</span><span class="w"> </span><span class="nv">or</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span>,
</code></pre></div>

<p>Where:</p>
<ul>
<li>if <code>icntyp(i)=-1</code> the constraint is linear (i.e. the left side
    consists of a linear combination of the parameters in the vector array
    param plus a constant)</li>
<li>if <code>icntyp(i)=-2</code> the constraint may be nonlinear.</li>
</ul>
<p>Thus we are choosing the parameters to minimize the left sides of
 the type 2 and type 1 (i.e. primary) constraints subject to the
 type -1 and type -2 (i.e. standard) constraints.</p>
<p>If there are no primary constraints the program will attempt to
 find a feasible point (that is, a vector param for which the type -1
 and type -2 constraints are satisfied within a tolerance tolcon
 described below) which is relatively close to the user supplied initial
 approximation, then return.</p>
<h3>Notes</h3>
<ul>
<li>Since <code>iwork</code> and <code>work</code> are changed by the program,
    the user will need to reset these values each time conmax is called.</li>
</ul>

    <h3>Type Bound</h3>
    <p><a href='../type/conmax_solver.html'>conmax_solver</a></p>

    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-me~2"></span>
              class(<a href='../type/conmax_solver.html'>conmax_solver</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>me</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ioptn"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ioptn</strong></td>
            <td>
                <p>THIS IS THE OPTION SWITCH, WHICH SHOULD BE SET TO
0 UNLESS ONE OR MORE OF THE EXTRA OPTIONS DESCRIBED BELOW
IS USED. THE USER HAS SEVERAL EXTRA OPTIONS WHICH ARE ACTIVATED BY SETTING
IOPTN TO A VALUE OTHER THAN 0; MORE THAN ONE AT A TIME CAN BE USED.
IN PARTICULAR:</p>
<ul>
<li>
<p>IF THE ONES DIGIT OF IOPTN IS 0, THEN THE USER SHOULD GIVE FORMULAS
  IN FNSET FOR COMPUTING THE PARTIAL DERIVATIVES WHEN INDFN=1 AS DESCRIBED
  ABOVE.</p>
</li>
<li>
<p>IF THE USER SETS THE ONES DIGIT OF IOPTN TO 1, THEN INDFN WILL ALWAYS
  BE 0 WHEN FNSET IS CALLED, AND THE PROGRAM WILL AUTOMATICALLY
  APPROXIMATE THE PARTIAL DERIVATIVES WHEN REQUIRED USING THE FOLLOWING
  CENTERED DIFFERENCE FORMULA:
  PARTIAL DERIVATIVE WITH RESPECT TO THE JTH VARIABLE (WHERE 1 &lt;= J
  &lt;= NPARM) OF THE FUNCTION WHOSE VALUE IS COMPUTED IN CONFUN(IPT,1)
  (WHERE 1 &lt;= IPT &lt;= NUMGR) IS APPROXIMATELY THE VALUE OF THIS
  FUNCTION WHEN THE JTH COMPONENT OF PARAM IS INCREASED BY DELT, MINUS
  THE VALUE OF THIS FUNCTION WHEN THE JTH COMPONENT OF PARAM IS
  DECREASED BY DELT, ALL DIVIDED BY 2.0<em>DELT, WHERE DELT = SQRT(B</em>*(-ITT)),
  WHERE B IS THE BASE FOR FOR FLOATING POINT NUMBERS AND ITT IS THE NUMBER
  OF BASE B DIGITS IN THE MANTISSA.</p>
</li>
<li>
<p>IF THE TENS DIGIT OF IOPTN IS 0, THE PROGRAM WILL NOT GIVE UP
  UNTIL EITHER AN ITERATION FAILS TO PRODUCE A REDUCTION ABS(ENCHG) OF
  MORE THAN 100.0<em>B</em>*(-ITT) IN THE PRINCIPAL ERROR NORM, OR ITLIM
  ITERATIONS HAVE BEEN USED.</p>
</li>
<li>
<p>IF THE TENS DIGIT OF IOPTN IS 1, THE PROGRAM WILL ALSO GIVE UP IF
  ABS(ENCHG) &lt; ENCSM FOR LIMSM CONSECUTIVE STEPS IN THE MAIN PART OF
  THE PROGRAM (I.E. AFTER TYPE -1 AND TYPE -2 FEASIBILITY HAVE BOTH BEEN
  ACHIEVED).  THIS OPTION MAY BE USEFUL IN SAVING SOME TIME BY
  FORESTALLING A LONG STRING OF ITERATIONS AT THE END OF A RUN WITH ONLY
  A TINY IMPROVEMENT IN EACH ONE.  ENCSM AND LIMSM ARE TRANSMITTED TO
  CONMAX IN WORK(1) AND IWORK(1) RESPECTIVELY.  WORK(1) AND IWORK(1) DO
  NOT NEED TO BE ASSIGNED VALUES IF THE TENS DIGIT OF IOPTN IS 0.</p>
</li>
<li>
<p>IF THE HUNDREDS DIGIT OF IOPTN IS 0 OR 2, THEN THE INTERNAL PARAMETER
  NSTEP WILL BE GIVEN THE DEFAULT VALUE 1.  NSTEP IS THE NUMBER OF
  RUNGE-KUTTA STEPS USED IN EACH RK ITERATION.</p>
</li>
<li>
<p>IF THE HUNDREDS DIGIT OF IOPTN IS 1 OR 3, THEN THE VALUE OF NSTEP USED
  WILL BE THE POSITIVE INTEGER VALUE PLACED IN IWORK(2) BY THE USER IN THE
  DRIVER PROGRAM.  SETTING NSTEP LARGER THAN 1 MAY ALLOW THE PROGRAM TO
  SUCCEED ON DIFFICULT PROBLEMS WHERE THE CONVERGENCE WOULD BE EXTREMELY
  SLOW WITH NSTEP=1, BUT IT WILL GENERALLY CAUSE MORE COMPUTER TIME TO BE
  USED IN EACH RK ITERATION.  IWORK(2) DOES NOT NEED TO BE ASSIGNED A
  VALUE IF THE HUNDREDS DIGIT OF IOPTN IS 0 OR 2.  (NSTEP IS SOMETIMES
  CALLED THE OVERDRIVE PARAMETER.)</p>
</li>
<li>
<p>IF THE HUNDREDS DIGIT OF IOPTN IS 0 OR 1, THEN THE INTERNAL PARAMETER
  TOLCON WILL BE GIVEN THE DEFAULT VALUE SQRT(B**(-ITT)), WHERE B IS THE
  BASE FOR FLOATING POINT NUMBERS AND ITT IS THE NUMBER OF BASE B DIGITS
  IN THE MANTISSA.</p>
</li>
<li>
<p>IF THE HUNDREDS DIGIT OF IOPTN IS 2 OR 3, THEN THE VALUE OF TOLCON USED
  WILL BE THE VALUE PLACED IN WORK(2) BY THE USER IN THE DRIVER PROGRAM.
  THIS VALUE SHOULD ALWAYS BE NONNEGATIVE.  IF THERE ARE NO TYPE -2 OR -1
  CONSTRAINTS THEN THE SETTING OF TOLCON WILL HAVE NO EFFECT, BUT IF
  THERE ARE TYPE -2 OR -1 CONSTRAINTS THEN IN GENERAL SMALLER VALUES OF
  TOLCON MAY GIVE MORE ACCURACY IN THE FINAL ANSWER, BUT MAY SLOW DOWN
  OR PREVENT CONVERGENCE, WHILE LARGER VALUES OF TOLCON MAY HAVE THE
  REVERSE EFFECT.  IN PARTICULAR, IF THE TYPE -2 AND -1 CONSTRAINTS
  CANNOT BE SATISFIED SUMULTANEOUSLY WITH STRICT INEQUALITY (THIS CASE
  COULD OCCUR, FOR EXAMPLE, IF AN EQUALITY CONSTRAINT G = 0.0 WAS
  ENTERED AS THE TWO INEQUALITY CONSTRAINTS G &lt;= 0.0 AND
  -G &lt;= 0.0), THEN SETTING TOLCON=0.0 WILL ALMOST CERTAINLY CAUSE THE
  PROGRAM TO FAIL, SINCE AT EACH ITERATION THE PROGRAM WILL NOT ACCEPT
  PROSPECTIVE NEW VALUES OF THE PARAMETERS UNLESS IT CAN CORRECT THEM
  BACK INTO THE RELAXED FEASIBLE REGION WHERE CONFUN(IPT,1) &lt;= TOLCON
  FOR ALL THE TYPE -2 AND -1 CONSTRAINTS.</p>
</li>
<li>
<p>IF THE THOUSANDS DIGIT OF IOPTN IS 0, THE PROGRAM WILL USE THE RK METHOD
  (WHICH INVOLVES APPLYING FOURTH ORDER RUNGE-KUTTA TO A SYSTEM OF
  DIFFERENTIAL EQUATIONS), THEN IF THIS FAILS IT WILL TRY TO REDUCE
  W WITH AN SLP STEP (I.E. SUCCESSIVE LINEAR PROGRAMMING WITH A TRUST
  REGION), THEN GO BACK TO RK IF THE SLP STEP REDUCES W.</p>
</li>
<li>
<p>IF THE THOUSANDS DIGIT OF IOPTN IS 1, THE PROGRAM WILL USE SLP STEPS ONLY.
  IN GENERAL, IN SOME PROBLEMS SLP WORKS VERY WELL, AND IN THOSE
  PROBLEMS IT WILL USUALLY BE FASTER THAN RK BECAUSE IT REQUIRES FEWER
  GRADIENT EVALUATIONS THAN RK, BUT IN OTHER PROBLEMS THE CONVERGENCE
  OF SLP MAY BE EXCRUCIATINGLY SLOW, AND THE MORE POWERFUL RK METHOD
  MAY BE MUCH FASTER.</p>
</li>
<li>
<p>IF THE THOUSANDS DIGIT OF IOPTN IS 2 THE PROGRAM WILL USE THE RK METHOD
  ONLY, QUITTING WHEN RK CAN NO LONGER PRODUCE AN IMPROVEMENT.  THIS
  MAY GIVE A LITTLE LESS ACCURACY THAN SETTING THE THOUSANDS DIGIT TO 0,
  BUT MAY SAVE SIGNIFICANT COMPUTER TIME IN SOME CASES.</p>
</li>
<li>
<p>IF THE TEN THOUSANDS DIGIT OF IOPTN IS 0, THEN FNSET SHOULD BE WRITTEN AS
  DESCRIBED ABOVE.</p>
</li>
<li>
<p>IF THE USER SETS THE TEN THOUSANDS DIGIT OF IOPTN TO 1, THEN FNSET SHOULD BE
  WRITTEN AS DESCRIBED ABOVE EXCEPT THAT THE COMPUTATIONS SHOULD BE DONE
  FOR ALL IPT=1,..,NUMGR INSTEAD OF FOR A SINGLE GIVEN VALUE OF IPT.
  THIS OPTION MAY SAVE COMPUTER TIME IN PROBLEMS WHERE A LARGE PART OF
  THE COMPUTATION IS THE SAME FOR DIFFERENT VALUES OF IPT, SINCE IT
  AVOIDS UNNECESSARY REPITITION OF THIS COMMON COMPUTATION BY HAVING
  THE LOOP OVER IPT IN FNSET INSTEAD OF OUTSIDE FNSET.
  IF THE TEN THOUSANDS DIGIT OF IOPTN IS 1, EVEN MORE TIME CAN OFTEN BE
  SAVED IF FNSET IS WRITTEN SO THAT ALL CONSTRAINTS ARE COMPUTED IF IPT=0,
  BUT ONLY THE STANDARD (I.E. TYPE -1 OR -2) CONSTRAINTS ARE COMPUTED IF
  IPT=-1.  NOTE THAT IF THE TEN THOUSANDS DIGIT OF IOPTN IS 0, THEN IPT
  WILL BE POSITIVE WHENEVER FNSET IS CALLED, INDICATING THAT ONLY
  CONSTRAINT IPT SHOULD BE COMPUTED.
  THE DRAWBACK OF USING THIS OPTION IS THAT IN GENERAL SOME CONSTRAINT
  VALUES AND DERIVATIVES WILL BE COMPUTED UNNECESSARILY, WHICH COULD COST
  TIME IN SOME PROBLEMS.</p>
</li>
</ul>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nparm"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nparm</strong></td>
            <td>
                <p>THIS IS THE NUMBER OF PARAMETERS IN THE PROBLEM.
(THEY ARE STORED IN <code>PARAM</code> -- SEE BELOW.)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-numgr"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>numgr</strong></td>
            <td>
                <p>THIS IS THE TOTAL NUMBER OF CONSTRAINTS.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-itlim"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>itlim</strong></td>
            <td>
                <p>THIS IS THE LIMIT ON THE NUMBER OF ITERATIONS, I.E.
THE LIMIT ON THE NUMBER OF TIMES THE PROGRAM REDUCES W.  IF
ITLIM IS SET TO 0 THE PROGRAM WILL COMPUTE THE ERRORS FOR
THE INITIAL APPROXIMATION AND STOP WITHOUT CHECKING
FEASIBILITY.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fun"></span>
              real(kind=wp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fun</strong>(Ifun)</td>
            <td>
                <p>(VECTOR ARRAY OF DIMENSION IFUN)  THIS IS
A VECTOR ARRAY IN WHICH DATA OR FUNCTION VALUES IN TYPE 2
CONSTRAINTS (SEE ABOVE) CAN BE STORED.  FUN(I) NEED NOT BE
ASSIGNED A VALUE IF IT IS NOT GOING TO BE USED.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ifun"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ifun</strong></td>
            <td>
                <p>THIS IS THE DIMENSION OF FUN IN THE DRIVER PROGRAM.
IT MUST BE &gt;= THE LARGEST INDEX I FOR WHICH FUN(I) IS USED
UNLESS NO FUN(I) IS USED, IN WHICH CASE IT MUST BE &gt;= 1.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-pttbl"></span>
              real(kind=wp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>pttbl</strong>(Iptb,Indm)</td>
            <td>
                <p>(MATRIX ARRAY OF DIMENSION (IPTB,INDM))
ROW I OF THIS ARRAY NORMALLY CONTAINS A POINT USED IN THE ITH
CONSTRAINT.  THE ENTRIES IN ROW I NEED NOT BE ASSIGNED VALUES IF
SUCH A POINT IS NOT USED IN THE ITH CONSTRAINT.
(EXAMPLE:  IF THE LEFT SIDE OF CONSTRAINT I IS A POLYNOMIAL IN
ONE INDEPENDENT VARIABLE, THEN THE VALUE OF THE INDEPENDENT
VARIABLE SHOULD BE IN PTTBL(I,1), AND THE COEFFICIENTS SHOULD BE
IN PARAM.)
PTTBL CAN ALSO BE USED TO PASS OTHER INFORMATION FROM THE DRIVER
PROGRAM TO SUBROUTINE FNSET.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iptb"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iptb</strong></td>
            <td>
                <p>THIS IS THE FIRST DIMENSION OF PTTBL IN THE DRIVER
PROGRAM.  IT MUST BE &gt;= THE LARGEST SUBSCRIPT I FOR WHICH A
VALUE PTTBL(I,J) IS USED, AND MUST BE &gt;= 1 IF NO SUCH VALUES
ARE USED.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-indm~2"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Indm</strong></td>
            <td>
                <p>THIS IS THE SECOND DIMENSION OF PTTBL IN THE DRIVER
PROGRAM.  IT MUST BE &gt;= THE LARGEST SUBSCRIPT J FOR WHICH A
VALUE PTTBL(I,J) IS USED, AND MUST BE &gt;= 1 IF NO SUCH VALUES
ARE USED.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iwork"></span>
              integer,
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iwork</strong>(Liwrk)</td>
            <td>
                <p>(VECTOR ARRAY OF DIMENSION LIWRK)  THIS IS AN INTEGER
WORK ARRAY.  THE USER NEED NOT PLACE ANY VALUES IN IT, EXCEPT
POSSIBLY CERTAIN OPTIONAL INFORMATION AS DESCRIBED BELOW.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-liwrk"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>liwrk</strong></td>
            <td>
                <p>THIS IS THE DIMENSION OF IWORK IN THE DRIVER PROGRAM.
IT MUST BE AT LEAST 7<em>NUMGR + 7</em>NPARM + 3.  IF NOT, CONMAX WILL
RETURN WITH THIS MINIMUM VALUE MULTIPLIED BY -1 AS A WARNING.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-work"></span>
              real(kind=wp),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>work</strong>(Lwrk)</td>
            <td>
                <p>(VECTOR ARRAY OF DIMENSION LWRK)  THIS IS A FLOATING
POINT WORK ARRAY.  THE USER NEED NOT PLACE ANY VALUES IN IT,
EXCEPT POSSIBLY CERTAIN OPTIONAL INFORMATION AS DESCRIBED BELOW.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lwrk"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>lwrk</strong></td>
            <td>
                <p>THIS IS THE DIMENSION OF WORK IN THE DRIVER PROGRAM.
IT MUST BE AT LEAST 2<em>NPARM</em><em>2 + 4</em>NUMGR<em>NPARM + 11</em>NUMGR +
27*NPARM + 13.  IF NOT, CONMAX WILL RETURN WITH THIS MINIMUM
VALUE MULTIPLIED BY -1 AS A WARNING.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iter"></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iter</strong></td>
            <td>
                <p>THIS IS THE NUMBER OF ITERATIONS PERFORMED BY CONMAX,
INCLUDING THOSE USED IN ATTEMPTING TO GAIN FEASIBILITY,
UNTIL EITHER IT CAN NO LONGER IMPROVE THE SITUATION OR THE
ITERATION LIMIT IS REACHED.  IF ITER=ITLIM IT IS POSSIBLE
THAT THE PROGRAM COULD FURTHER REDUCE W IF RESTARTED
(POSSIBLY WITH THE NEW PARAMETERS).</p>
<ul>
<li>ITER=-1 IS A SIGNAL THAT TYPE -1 FEASIBILITY COULD NOT BE
   ACHIEVED, IN THIS CASE ERROR WILL CONTAIN THE VALUES COMPUTED
   USING THE USER SUPPLIED INITIAL APPROXIMATION.</li>
<li>ITER=-2 IS A SIGNAL THAT TYPE -1 FEASIBILITY WAS ACHIEVED
   BUT TYPE -2 FEASIBILITY COULD NOT BE ACHIEVED,
   IN THIS CASE VALUES IN ERROR CORRESPONDING TO TYPE 1 OR
   TYPE 2 CONSTRAINTS WILL BE ZERO.</li>
</ul>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-param"></span>
              real(kind=wp),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>param</strong>(Nparm)</td>
            <td>
                <p>(VECTOR ARRAY OF DIMENSION AT LEAST NPARM
IN THE DRIVER PROGRAM)  THE USER SHOULD PLACE AN INITIAL GUESS
FOR THE PARAMETERS IN PARAM, AND ON OUTPUT PARAM WILL CONTAIN
THE BEST PARAMETERS CONMAX HAS BEEN ABLE TO FIND.  IF THE
INITIAL PARAM IS NOT FEASIBLE THE PROGRAM WILL FIRST TRY TO
FIND A FEASIBLE PARAM.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-error"></span>
              real(kind=wp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>error</strong>(Numgr+3)</td>
            <td>
                <p>(VECTOR ARRAY OF DIMENSION AT LEAST NUMGR + 3 IN THE
DRIVER PROGRAM)  FOR I=1,...,NUMGR, CONMAX WILL PLACE IN
ERROR(I) THE ERROR IN CONSTRAINT I (DEFINED TO BE THE VALUE
OF THE LEFT SIDE OF CONSTRAINT I, EXCEPT WITHOUT THE ABSOLUTE
VALUE IN TYPE 2 CONSTRAINTS).  FURTHER,</p>
<ul>
<li>
<p>ERROR(NUMGR+1) WILL BE THE (PRINCIPAL) ERROR NORM, THAT IS, THE
   MAXIMUM VALUE OF THE LEFT SIDES OF THE TYPE 2 (INCLUDING THE
   ABSOLUTE VALUE) AND TYPE 1 CONSTRAINTS.</p>
</li>
<li>
<p>ERROR(NUMGR+2) WILL BE THE MAXIMUM VALUE OF THE LEFT SIDES OF THE
   TYPE -1 CONSTRAINTS, OR 0.0 IF THERE ARE NO TYPE -1
   CONSTRAINTS.  EXCEPT FOR ROUNDOFF ERROR AND SMALL TOLERANCES
   IN SOME SUBROUTINES THIS VALUE WILL NORMALLY BE &lt;= 0.0, AND
   IT WILL NOT BE ALLOWED TO BE &gt; TOLCON IN THE MAIN PART OF
   THE PROGRAM.</p>
</li>
<li>
<p>ERROR(NUMGR+3) WILL BE THE MAXIMUM VALUE OF THE LEFT SIDES OF THE
   TYPE -2 CONSTRAINTS, OR 0.0 IF THERE ARE NO TYPE -2
   CONSTRAINTS.  THIS VALUE SHOULD BE &lt;= TOLCON, SINCE THE
   PROGRAM WILL NOT EVEN ATTEMPT TO COMPUTE VALUES FOR THE
   TYPE 2 AND TYPE 1 CONSTRAINTS OTHERWISE (EXCEPT FOR VALUES
   CORRESPONDING TO THE INITIAL PARAMETERS PLACED IN PARAM BY
   THE USER).  THE USER CAN USE THIS FEATURE TO INSERT TYPE -2
   OR -1 CONSTRAINTS TO KEEP THE PARAMETERS AWAY FROM VALUES
   WHERE A TYPE 2 OR TYPE 1 CONSTRAINT IS UNDEFINED.</p>
</li>
</ul>
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~conmax~~CallsGraph Pages: 1 -->
<svg id="procconmaxCallsGraph" width="641pt" height="451pt"
 viewBox="0.00 0.00 641.00 450.81" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~conmax~~CallsGraph" class="graph" transform="scale(0.58 0.58) rotate(0) translate(4 774.55)">
<title>proc~~conmax~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-774.55 1103,-774.55 1103,4 -4,4"/>
<!-- proc~conmax -->
<g id="proc~~conmax~~CallsGraph_node1" class="node">
<title>proc~conmax</title>
<polygon fill="none" stroke="black" points="145,-557.55 0,-557.55 0,-533.55 145,-533.55 145,-557.55"/>
<text text-anchor="middle" x="72.5" y="-543.15" font-family="Helvetica,sans-Serif" font-size="10.50">conmax_solver%conmax</text>
</g>
<!-- proc~derst -->
<g id="proc~~conmax~~CallsGraph_node2" class="node">
<title>proc~derst</title>
<g id="a_proc~~conmax~~CallsGraph_node2"><a xlink:href="../proc/derst.html" xlink:title="conmax_solver%derst">
<polygon fill="#d9534f" stroke="#d9534f" points="826.5,-612.55 696.5,-612.55 696.5,-588.55 826.5,-588.55 826.5,-612.55"/>
<text text-anchor="middle" x="761.5" y="-598.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmax_solver%derst</text>
</a>
</g>
</g>
<!-- proc~conmax&#45;&gt;proc~derst -->
<g id="proc~~conmax~~CallsGraph_edge1" class="edge">
<title>proc~conmax&#45;&gt;proc~derst</title>
<path fill="none" stroke="#000000" d="M145.08,-551.28C276.04,-561.77 552.97,-583.94 686.04,-594.59"/>
<polygon fill="#000000" stroke="#000000" points="685.9,-598.09 696.14,-595.4 686.46,-591.11 685.9,-598.09"/>
</g>
<!-- proc~ercmp1 -->
<g id="proc~~conmax~~CallsGraph_node3" class="node">
<title>proc~ercmp1</title>
<g id="a_proc~~conmax~~CallsGraph_node3"><a xlink:href="../proc/ercmp1.html" xlink:title="conmax_solver%ercmp1">
<polygon fill="#d9534f" stroke="#d9534f" points="1009,-528.55 866,-528.55 866,-504.55 1009,-504.55 1009,-528.55"/>
<text text-anchor="middle" x="937.5" y="-514.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmax_solver%ercmp1</text>
</a>
</g>
</g>
<!-- proc~conmax&#45;&gt;proc~ercmp1 -->
<g id="proc~~conmax~~CallsGraph_edge2" class="edge">
<title>proc~conmax&#45;&gt;proc~ercmp1</title>
<path fill="none" stroke="#000000" d="M90.98,-557.59C140.3,-590.33 285.65,-678.55 420,-678.55 420,-678.55 420,-678.55 591.5,-678.55 698.7,-678.55 743.28,-705.58 830,-642.55 858.94,-621.52 843.22,-598.13 866,-570.55 877.6,-556.51 893.5,-543.93 907.27,-534.45"/>
<polygon fill="#000000" stroke="#000000" points="909.55,-537.14 915.94,-528.69 905.68,-531.31 909.55,-537.14"/>
</g>
<!-- proc~iloc -->
<g id="proc~~conmax~~CallsGraph_node4" class="node">
<title>proc~iloc</title>
<g id="a_proc~~conmax~~CallsGraph_node4"><a xlink:href="../proc/iloc.html" xlink:title="iloc">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1099,-412.55 1045,-412.55 1045,-388.55 1099,-388.55 1099,-412.55"/>
<text text-anchor="middle" x="1072" y="-398.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iloc</text>
</a>
</g>
</g>
<!-- proc~conmax&#45;&gt;proc~iloc -->
<g id="proc~~conmax~~CallsGraph_edge3" class="edge">
<title>proc~conmax&#45;&gt;proc~iloc</title>
<path fill="none" stroke="#000000" d="M73.77,-533.27C75.48,-481.6 88.1,-278.62 181,-151.55 253.52,-52.35 297.12,-12.55 420,-12.55 420,-12.55 420,-12.55 762.5,-12.55 873.03,-12.55 929.3,31.04 1009,-45.55 1057.07,-91.75 1068.07,-307.09 1070.41,-377.91"/>
<polygon fill="#000000" stroke="#000000" points="1066.93,-378.45 1070.73,-388.34 1073.92,-378.24 1066.93,-378.45"/>
</g>
<!-- proc~rkcon -->
<g id="proc~~conmax~~CallsGraph_node5" class="node">
<title>proc~rkcon</title>
<g id="a_proc~~conmax~~CallsGraph_node5"><a xlink:href="../proc/rkcon.html" xlink:title="conmax_solver%rkcon">
<polygon fill="#d9534f" stroke="#d9534f" points="316,-480.55 183,-480.55 183,-456.55 316,-456.55 316,-480.55"/>
<text text-anchor="middle" x="249.5" y="-466.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmax_solver%rkcon</text>
</a>
</g>
</g>
<!-- proc~conmax&#45;&gt;proc~rkcon -->
<g id="proc~~conmax~~CallsGraph_edge4" class="edge">
<title>proc~conmax&#45;&gt;proc~rkcon</title>
<path fill="none" stroke="#000000" d="M100.84,-533.52C130.68,-520.39 178.6,-499.31 211.72,-484.74"/>
<polygon fill="#000000" stroke="#000000" points="213.32,-487.86 221.06,-480.62 210.5,-481.45 213.32,-487.86"/>
</g>
<!-- proc~slpcon -->
<g id="proc~~conmax~~CallsGraph_node6" class="node">
<title>proc~slpcon</title>
<g id="a_proc~~conmax~~CallsGraph_node6"><a xlink:href="../proc/slpcon.html" xlink:title="conmax_solver%slpcon">
<polygon fill="#d9534f" stroke="#d9534f" points="318,-184.55 181,-184.55 181,-160.55 318,-160.55 318,-184.55"/>
<text text-anchor="middle" x="249.5" y="-170.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmax_solver%slpcon</text>
</a>
</g>
</g>
<!-- proc~conmax&#45;&gt;proc~slpcon -->
<g id="proc~~conmax~~CallsGraph_edge5" class="edge">
<title>proc~conmax&#45;&gt;proc~slpcon</title>
<path fill="none" stroke="#000000" d="M79.32,-533.14C104.71,-479.03 205.88,-263.38 238.39,-194.1"/>
<polygon fill="#000000" stroke="#000000" points="241.75,-195.17 242.83,-184.63 235.42,-192.2 241.75,-195.17"/>
</g>
<!-- proc~wolfe -->
<g id="proc~~conmax~~CallsGraph_node7" class="node">
<title>proc~wolfe</title>
<g id="a_proc~~conmax~~CallsGraph_node7"><a xlink:href="../proc/wolfe.html" xlink:title="wolfe">
<polygon fill="#d9534f" stroke="#d9534f" points="788.5,-730.55 734.5,-730.55 734.5,-706.55 788.5,-706.55 788.5,-730.55"/>
<text text-anchor="middle" x="761.5" y="-716.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wolfe</text>
</a>
</g>
</g>
<!-- proc~conmax&#45;&gt;proc~wolfe -->
<g id="proc~~conmax~~CallsGraph_edge6" class="edge">
<title>proc~conmax&#45;&gt;proc~wolfe</title>
<path fill="none" stroke="#000000" d="M78.14,-557.94C89.98,-587.56 124.43,-662.23 181,-692.55 364.29,-790.81 628.97,-747.46 724.45,-727.03"/>
<polygon fill="#000000" stroke="#000000" points="725.44,-730.39 734.46,-724.84 723.94,-723.56 725.44,-730.39"/>
</g>
<!-- fnset -->
<g id="proc~~conmax~~CallsGraph_node8" class="node">
<title>fnset</title>
<polygon fill="#777777" stroke="#777777" points="1099,-569.55 1045,-569.55 1045,-545.55 1099,-545.55 1099,-569.55"/>
<text text-anchor="middle" x="1072" y="-555.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fnset</text>
</g>
<!-- proc~derst&#45;&gt;fnset -->
<g id="proc~~conmax~~CallsGraph_edge7" class="edge">
<title>proc~derst&#45;&gt;fnset</title>
<path fill="none" stroke="#000000" d="M826.76,-596.65C876.75,-592.92 947.68,-586.11 1009,-574.55 1017.59,-572.93 1026.73,-570.71 1035.28,-568.41"/>
<polygon fill="#000000" stroke="#000000" points="1036.28,-571.76 1044.97,-565.7 1034.4,-565.02 1036.28,-571.76"/>
</g>
<!-- proc~ercmp1&#45;&gt;proc~iloc -->
<g id="proc~~conmax~~CallsGraph_edge9" class="edge">
<title>proc~ercmp1&#45;&gt;proc~iloc</title>
<path fill="none" stroke="#000000" d="M983.91,-504.49C992.76,-500.89 1001.58,-496.31 1009,-490.55 1032.69,-472.15 1050.77,-442.14 1061.13,-421.89"/>
<polygon fill="#000000" stroke="#000000" points="1064.32,-423.34 1065.59,-412.82 1058.04,-420.25 1064.32,-423.34"/>
</g>
<!-- proc~ercmp1&#45;&gt;fnset -->
<g id="proc~~conmax~~CallsGraph_edge8" class="edge">
<title>proc~ercmp1&#45;&gt;fnset</title>
<path fill="none" stroke="#000000" d="M977.54,-528.63C995.66,-534.24 1017.07,-540.86 1034.82,-546.36"/>
<polygon fill="#000000" stroke="#000000" points="1034.21,-549.83 1044.8,-549.44 1036.28,-543.14 1034.21,-549.83"/>
</g>
<!-- proc~rkcon&#45;&gt;proc~derst -->
<g id="proc~~conmax~~CallsGraph_edge11" class="edge">
<title>proc~rkcon&#45;&gt;proc~derst</title>
<path fill="none" stroke="#000000" d="M303.36,-480.58C319.59,-484.2 337.51,-488.11 354,-491.55 488.31,-519.55 526.82,-507.24 657,-550.55 682.66,-559.09 710.16,-572.6 730.36,-583.43"/>
<polygon fill="#000000" stroke="#000000" points="728.92,-586.63 739.37,-588.34 732.27,-580.48 728.92,-586.63"/>
</g>
<!-- proc~rkcon&#45;&gt;proc~ercmp1 -->
<g id="proc~~conmax~~CallsGraph_edge12" class="edge">
<title>proc~rkcon&#45;&gt;proc~ercmp1</title>
<path fill="none" stroke="#000000" d="M274.36,-480.73C295.09,-491.04 326.09,-505.81 354,-516.55 501.21,-573.19 537.05,-597.95 693,-621.55 753.2,-630.66 775.94,-649.56 830,-621.55 854.63,-608.79 846.77,-590.55 866,-570.55 878.89,-557.15 895.28,-544.39 909.01,-534.65"/>
<polygon fill="#000000" stroke="#000000" points="911.36,-537.27 917.59,-528.7 907.37,-531.52 911.36,-537.27"/>
</g>
<!-- proc~rkcon&#45;&gt;proc~iloc -->
<g id="proc~~conmax~~CallsGraph_edge13" class="edge">
<title>proc~rkcon&#45;&gt;proc~iloc</title>
<path fill="none" stroke="#000000" d="M255.77,-456.47C278.58,-406.06 374.37,-212.38 524,-153.55 624.3,-114.11 925.26,-87.7 1009,-155.55 1043.84,-183.78 1062.57,-323.14 1068.71,-378.16"/>
<polygon fill="#000000" stroke="#000000" points="1065.24,-378.7 1069.8,-388.26 1072.2,-377.94 1065.24,-378.7"/>
</g>
<!-- proc~rkcon&#45;&gt;proc~wolfe -->
<g id="proc~~conmax~~CallsGraph_edge18" class="edge">
<title>proc~rkcon&#45;&gt;proc~wolfe</title>
<path fill="none" stroke="#000000" d="M259.23,-480.61C275.66,-502.58 313.18,-549.53 354,-578.55 473.68,-663.65 649.5,-700.64 724.48,-713.2"/>
<polygon fill="#000000" stroke="#000000" points="723.94,-716.66 734.38,-714.81 725.07,-709.75 723.94,-716.66"/>
</g>
<!-- proc~corrct -->
<g id="proc~~conmax~~CallsGraph_node11" class="node">
<title>proc~corrct</title>
<g id="a_proc~~conmax~~CallsGraph_node11"><a xlink:href="../proc/corrct.html" xlink:title="conmax_solver%corrct">
<polygon fill="#d9534f" stroke="#d9534f" points="657,-454.55 524,-454.55 524,-430.55 657,-430.55 657,-454.55"/>
<text text-anchor="middle" x="590.5" y="-440.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmax_solver%corrct</text>
</a>
</g>
</g>
<!-- proc~rkcon&#45;&gt;proc~corrct -->
<g id="proc~~conmax~~CallsGraph_edge10" class="edge">
<title>proc~rkcon&#45;&gt;proc~corrct</title>
<path fill="none" stroke="#000000" d="M260.42,-456.51C277.26,-437.13 313.58,-399.76 354,-385.55 410.19,-365.8 430.38,-370.48 488,-385.55 516.82,-393.09 546.11,-410.85 565.77,-424.56"/>
<polygon fill="#000000" stroke="#000000" points="563.92,-427.54 574.09,-430.52 568,-421.85 563.92,-427.54"/>
</g>
<!-- proc~pmtst -->
<g id="proc~~conmax~~CallsGraph_node13" class="node">
<title>proc~pmtst</title>
<g id="a_proc~~conmax~~CallsGraph_node13"><a xlink:href="../proc/pmtst.html" xlink:title="conmax_solver%pmtst">
<polygon fill="#d9534f" stroke="#d9534f" points="657,-498.55 524,-498.55 524,-474.55 657,-474.55 657,-498.55"/>
<text text-anchor="middle" x="590.5" y="-484.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmax_solver%pmtst</text>
</a>
</g>
</g>
<!-- proc~rkcon&#45;&gt;proc~pmtst -->
<g id="proc~~conmax~~CallsGraph_edge14" class="edge">
<title>proc~rkcon&#45;&gt;proc~pmtst</title>
<path fill="none" stroke="#000000" d="M316.26,-472.04C372.87,-475.05 454.56,-479.39 513.86,-482.53"/>
<polygon fill="#000000" stroke="#000000" points="513.75,-486.03 523.92,-483.07 514.12,-479.04 513.75,-486.03"/>
</g>
<!-- proc~rkpar -->
<g id="proc~~conmax~~CallsGraph_node15" class="node">
<title>proc~rkpar</title>
<g id="a_proc~~conmax~~CallsGraph_node15"><a xlink:href="../proc/rkpar.html" xlink:title="conmax_solver%rkpar">
<polygon fill="#d9534f" stroke="#d9534f" points="486.5,-460.55 355.5,-460.55 355.5,-436.55 486.5,-436.55 486.5,-460.55"/>
<text text-anchor="middle" x="421" y="-446.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmax_solver%rkpar</text>
</a>
</g>
</g>
<!-- proc~rkcon&#45;&gt;proc~rkpar -->
<g id="proc~~conmax~~CallsGraph_edge15" class="edge">
<title>proc~rkcon&#45;&gt;proc~rkpar</title>
<path fill="none" stroke="#000000" d="M316.03,-460.82C325.64,-459.68 335.6,-458.51 345.38,-457.36"/>
<polygon fill="#000000" stroke="#000000" points="345.96,-460.81 355.48,-456.16 345.14,-453.86 345.96,-460.81"/>
</g>
<!-- proc~rksact -->
<g id="proc~~conmax~~CallsGraph_node16" class="node">
<title>proc~rksact</title>
<g id="a_proc~~conmax~~CallsGraph_node16"><a xlink:href="../proc/rksact.html" xlink:title="rksact">
<polygon fill="#d9534f" stroke="#d9534f" points="448,-418.55 394,-418.55 394,-394.55 448,-394.55 448,-418.55"/>
<text text-anchor="middle" x="421" y="-404.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rksact</text>
</a>
</g>
</g>
<!-- proc~rkcon&#45;&gt;proc~rksact -->
<g id="proc~~conmax~~CallsGraph_edge16" class="edge">
<title>proc~rkcon&#45;&gt;proc~rksact</title>
<path fill="none" stroke="#000000" d="M279.3,-456.52C299.95,-448.05 328.51,-436.64 354,-427.55 363.67,-424.1 374.22,-420.62 384,-417.51"/>
<polygon fill="#000000" stroke="#000000" points="385.35,-420.75 393.84,-414.42 383.25,-414.08 385.35,-420.75"/>
</g>
<!-- proc~searsl -->
<g id="proc~~conmax~~CallsGraph_node17" class="node">
<title>proc~searsl</title>
<g id="a_proc~~conmax~~CallsGraph_node17"><a xlink:href="../proc/searsl.html" xlink:title="conmax_solver%searsl">
<polygon fill="#d9534f" stroke="#d9534f" points="488,-335.55 354,-335.55 354,-311.55 488,-311.55 488,-335.55"/>
<text text-anchor="middle" x="421" y="-321.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmax_solver%searsl</text>
</a>
</g>
</g>
<!-- proc~rkcon&#45;&gt;proc~searsl -->
<g id="proc~~conmax~~CallsGraph_edge17" class="edge">
<title>proc~rkcon&#45;&gt;proc~searsl</title>
<path fill="none" stroke="#000000" d="M258.56,-456.49C274.43,-433.55 311.85,-383.16 354,-352.55 360.55,-347.79 368,-343.59 375.49,-339.96"/>
<polygon fill="#000000" stroke="#000000" points="377.26,-343 384.92,-335.68 374.36,-336.63 377.26,-343"/>
</g>
<!-- proc~slpcon&#45;&gt;proc~ercmp1 -->
<g id="proc~~conmax~~CallsGraph_edge20" class="edge">
<title>proc~slpcon&#45;&gt;proc~ercmp1</title>
<path fill="none" stroke="#000000" d="M286.14,-184.66C305.97,-191.12 331.18,-198.89 354,-204.55 406.24,-217.52 787.32,-261.75 830,-294.55 896.54,-345.68 923.66,-448.94 932.68,-494.31"/>
<polygon fill="#000000" stroke="#000000" points="929.27,-495.11 934.56,-504.29 936.15,-493.82 929.27,-495.11"/>
</g>
<!-- proc~slpcon&#45;&gt;proc~iloc -->
<g id="proc~~conmax~~CallsGraph_edge21" class="edge">
<title>proc~slpcon&#45;&gt;proc~iloc</title>
<path fill="none" stroke="#000000" d="M258.38,-160.28C273.68,-137.67 309.79,-89.92 354,-69.55 449.37,-25.61 484.49,-50.55 589.5,-50.55 589.5,-50.55 589.5,-50.55 762.5,-50.55 875.47,-50.55 930.5,-31.31 1009,-112.55 1046.05,-150.9 1063.88,-317.85 1069.22,-378.46"/>
<polygon fill="#000000" stroke="#000000" points="1065.73,-378.82 1070.07,-388.49 1072.71,-378.23 1065.73,-378.82"/>
</g>
<!-- proc~bndset -->
<g id="proc~~conmax~~CallsGraph_node9" class="node">
<title>proc~bndset</title>
<g id="a_proc~~conmax~~CallsGraph_node9"><a xlink:href="../proc/bndset.html" xlink:title="bndset">
<polygon fill="#d9534f" stroke="#d9534f" points="448,-144.55 394,-144.55 394,-120.55 448,-120.55 448,-144.55"/>
<text text-anchor="middle" x="421" y="-130.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bndset</text>
</a>
</g>
</g>
<!-- proc~slpcon&#45;&gt;proc~bndset -->
<g id="proc~~conmax~~CallsGraph_edge19" class="edge">
<title>proc~slpcon&#45;&gt;proc~bndset</title>
<path fill="none" stroke="#000000" d="M301.36,-160.55C327.98,-154.27 359.94,-146.72 383.98,-141.05"/>
<polygon fill="#000000" stroke="#000000" points="384.83,-144.45 393.76,-138.74 383.22,-137.63 384.83,-144.45"/>
</g>
<!-- proc~slpcon&#45;&gt;proc~searsl -->
<g id="proc~~conmax~~CallsGraph_edge22" class="edge">
<title>proc~slpcon&#45;&gt;proc~searsl</title>
<path fill="none" stroke="#000000" d="M264.08,-184.65C293.47,-210.83 363.12,-272.88 398.53,-304.43"/>
<polygon fill="#000000" stroke="#000000" points="396.56,-307.35 406.35,-311.39 401.21,-302.13 396.56,-307.35"/>
</g>
<!-- proc~setu1 -->
<g id="proc~~conmax~~CallsGraph_node18" class="node">
<title>proc~setu1</title>
<g id="a_proc~~conmax~~CallsGraph_node18"><a xlink:href="../proc/setu1.html" xlink:title="conmax_solver%setu1">
<polygon fill="#d9534f" stroke="#d9534f" points="656.5,-220.55 524.5,-220.55 524.5,-196.55 656.5,-196.55 656.5,-220.55"/>
<text text-anchor="middle" x="590.5" y="-206.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmax_solver%setu1</text>
</a>
</g>
</g>
<!-- proc~slpcon&#45;&gt;proc~setu1 -->
<g id="proc~~conmax~~CallsGraph_edge23" class="edge">
<title>proc~slpcon&#45;&gt;proc~setu1</title>
<path fill="none" stroke="#000000" d="M318.29,-179.75C375,-185.77 455.82,-194.36 514.47,-200.58"/>
<polygon fill="#000000" stroke="#000000" points="514.11,-204.06 524.42,-201.64 514.85,-197.1 514.11,-204.06"/>
</g>
<!-- proc~slnpro -->
<g id="proc~~conmax~~CallsGraph_node19" class="node">
<title>proc~slnpro</title>
<g id="a_proc~~conmax~~CallsGraph_node19"><a xlink:href="../proc/slnpro.html" xlink:title="slnpro">
<polygon fill="#d9534f" stroke="#d9534f" points="448,-102.55 394,-102.55 394,-78.55 448,-78.55 448,-102.55"/>
<text text-anchor="middle" x="421" y="-88.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">slnpro</text>
</a>
</g>
</g>
<!-- proc~slpcon&#45;&gt;proc~slnpro -->
<g id="proc~~conmax~~CallsGraph_edge24" class="edge">
<title>proc~slpcon&#45;&gt;proc~slnpro</title>
<path fill="none" stroke="#000000" d="M268.16,-160.47C288.26,-147.13 322.39,-125.68 354,-111.55 363.55,-107.28 374.23,-103.49 384.17,-100.34"/>
<polygon fill="#000000" stroke="#000000" points="385.25,-103.67 393.8,-97.42 383.21,-96.98 385.25,-103.67"/>
</g>
<!-- proc~wolfe&#45;&gt;proc~iloc -->
<g id="proc~~conmax~~CallsGraph_edge27" class="edge">
<title>proc~wolfe&#45;&gt;proc~iloc</title>
<path fill="none" stroke="#000000" d="M788.76,-711.36C801.81,-707.08 817.42,-700.85 830,-692.55 849.15,-679.91 847.84,-669.57 866,-655.55 923.83,-610.93 962.01,-630.47 1009,-574.55 1047.14,-529.16 1062.53,-458.58 1068.13,-422.87"/>
<polygon fill="#000000" stroke="#000000" points="1071.6,-423.37 1069.57,-412.97 1064.67,-422.36 1071.6,-423.37"/>
</g>
<!-- proc~conenr -->
<g id="proc~~conmax~~CallsGraph_node10" class="node">
<title>proc~conenr</title>
<g id="a_proc~~conmax~~CallsGraph_node10"><a xlink:href="../proc/conenr.html" xlink:title="conenr">
<polygon fill="#d9534f" stroke="#d9534f" points="964.5,-730.55 910.5,-730.55 910.5,-706.55 964.5,-706.55 964.5,-730.55"/>
<text text-anchor="middle" x="937.5" y="-716.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conenr</text>
</a>
</g>
</g>
<!-- proc~wolfe&#45;&gt;proc~conenr -->
<g id="proc~~conmax~~CallsGraph_edge25" class="edge">
<title>proc~wolfe&#45;&gt;proc~conenr</title>
<path fill="none" stroke="#000000" d="M788.55,-718.55C818.15,-718.55 866.66,-718.55 900.02,-718.55"/>
<polygon fill="#000000" stroke="#000000" points="900.27,-722.05 910.27,-718.55 900.27,-715.05 900.27,-722.05"/>
</g>
<!-- proc~dotprd -->
<g id="proc~~conmax~~CallsGraph_node12" class="node">
<title>proc~dotprd</title>
<g id="a_proc~~conmax~~CallsGraph_node12"><a xlink:href="../proc/dotprd.html" xlink:title="dotprd">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1099,-770.55 1045,-770.55 1045,-746.55 1099,-746.55 1099,-770.55"/>
<text text-anchor="middle" x="1072" y="-756.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dotprd</text>
</a>
</g>
</g>
<!-- proc~wolfe&#45;&gt;proc~dotprd -->
<g id="proc~~conmax~~CallsGraph_edge26" class="edge">
<title>proc~wolfe&#45;&gt;proc~dotprd</title>
<path fill="none" stroke="#000000" d="M788.74,-724.69C809.58,-729.37 839.52,-735.65 866,-739.55 924.72,-748.2 993.51,-753.62 1034.6,-756.37"/>
<polygon fill="#000000" stroke="#000000" points="1034.47,-759.87 1044.68,-757.02 1034.93,-752.88 1034.47,-759.87"/>
</g>
<!-- proc~refwl -->
<g id="proc~~conmax~~CallsGraph_node14" class="node">
<title>proc~refwl</title>
<g id="a_proc~~conmax~~CallsGraph_node14"><a xlink:href="../proc/refwl.html" xlink:title="refwl">
<polygon fill="#d9534f" stroke="#d9534f" points="964.5,-688.55 910.5,-688.55 910.5,-664.55 964.5,-664.55 964.5,-688.55"/>
<text text-anchor="middle" x="937.5" y="-674.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">refwl</text>
</a>
</g>
</g>
<!-- proc~wolfe&#45;&gt;proc~refwl -->
<g id="proc~~conmax~~CallsGraph_edge28" class="edge">
<title>proc~wolfe&#45;&gt;proc~refwl</title>
<path fill="none" stroke="#000000" d="M788.55,-712.26C818.28,-705.09 867.08,-693.31 900.45,-685.25"/>
<polygon fill="#000000" stroke="#000000" points="901.37,-688.63 910.27,-682.88 899.73,-681.83 901.37,-688.63"/>
</g>
<!-- proc~conenr&#45;&gt;proc~iloc -->
<g id="proc~~conmax~~CallsGraph_edge31" class="edge">
<title>proc~conenr&#45;&gt;proc~iloc</title>
<path fill="none" stroke="#000000" d="M964.76,-717.18C979.76,-715 997.76,-709.77 1009,-697.55 1013.74,-692.4 1053.39,-490.85 1066.68,-422.76"/>
<polygon fill="#000000" stroke="#000000" points="1070.16,-423.17 1068.64,-412.69 1063.29,-421.83 1070.16,-423.17"/>
</g>
<!-- proc~conenr&#45;&gt;proc~dotprd -->
<g id="proc~~conmax~~CallsGraph_edge29" class="edge">
<title>proc~conenr&#45;&gt;proc~dotprd</title>
<path fill="none" stroke="#000000" d="M964.68,-726.45C984.82,-732.53 1012.88,-741.01 1035.12,-747.72"/>
<polygon fill="#000000" stroke="#000000" points="1034.29,-751.13 1044.88,-750.66 1036.31,-744.42 1034.29,-751.13"/>
</g>
<!-- proc~house -->
<g id="proc~~conmax~~CallsGraph_node20" class="node">
<title>proc~house</title>
<g id="a_proc~~conmax~~CallsGraph_node20"><a xlink:href="../proc/house.html" xlink:title="house">
<polygon fill="#d9534f" stroke="#d9534f" points="1099,-728.55 1045,-728.55 1045,-704.55 1099,-704.55 1099,-728.55"/>
<text text-anchor="middle" x="1072" y="-714.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">house</text>
</a>
</g>
</g>
<!-- proc~conenr&#45;&gt;proc~house -->
<g id="proc~~conmax~~CallsGraph_edge30" class="edge">
<title>proc~conenr&#45;&gt;proc~house</title>
<path fill="none" stroke="#000000" d="M964.68,-718.16C984.73,-717.85 1012.63,-717.43 1034.82,-717.1"/>
<polygon fill="#000000" stroke="#000000" points="1034.93,-720.6 1044.88,-716.95 1034.82,-713.6 1034.93,-720.6"/>
</g>
<!-- proc~corrct&#45;&gt;proc~derst -->
<g id="proc~~conmax~~CallsGraph_edge32" class="edge">
<title>proc~corrct&#45;&gt;proc~derst</title>
<path fill="none" stroke="#000000" d="M639.67,-454.59C645.93,-457.5 651.92,-461.1 657,-465.55 683.61,-488.87 671.85,-508.19 693,-536.55 705.67,-553.54 723.09,-569.93 737.06,-581.87"/>
<polygon fill="#000000" stroke="#000000" points="734.9,-584.63 744.82,-588.36 739.39,-579.26 734.9,-584.63"/>
</g>
<!-- proc~corrct&#45;&gt;proc~ercmp1 -->
<g id="proc~~conmax~~CallsGraph_edge33" class="edge">
<title>proc~corrct&#45;&gt;proc~ercmp1</title>
<path fill="none" stroke="#000000" d="M635.15,-454.6C642.74,-457.6 650.32,-461.22 657,-465.55 676.52,-478.2 671.88,-493.79 693,-503.55 743.5,-526.89 806.31,-529.69 855.49,-526.89"/>
<polygon fill="#000000" stroke="#000000" points="856.02,-530.37 865.77,-526.22 855.56,-523.38 856.02,-530.37"/>
</g>
<!-- proc~corrct&#45;&gt;proc~iloc -->
<g id="proc~~conmax~~CallsGraph_edge34" class="edge">
<title>proc~corrct&#45;&gt;proc~iloc</title>
<path fill="none" stroke="#000000" d="M636.92,-430.5C654.34,-426.34 674.47,-422.1 693,-419.55 817.51,-402.45 966.97,-400.29 1034.6,-400.3"/>
<polygon fill="#000000" stroke="#000000" points="1034.73,-403.8 1044.73,-400.32 1034.74,-396.8 1034.73,-403.8"/>
</g>
<!-- proc~corrct&#45;&gt;proc~wolfe -->
<g id="proc~~conmax~~CallsGraph_edge38" class="edge">
<title>proc~corrct&#45;&gt;proc~wolfe</title>
<path fill="none" stroke="#000000" d="M643,-454.71C648.23,-457.59 653.06,-461.15 657,-465.55 704.45,-518.58 664.16,-556.5 693,-621.55 705.84,-650.5 727.73,-679.81 743.1,-698.51"/>
<polygon fill="#000000" stroke="#000000" points="740.54,-700.9 749.64,-706.32 745.9,-696.41 740.54,-700.9"/>
</g>
<!-- proc~muller -->
<g id="proc~~conmax~~CallsGraph_node21" class="node">
<title>proc~muller</title>
<g id="a_proc~~conmax~~CallsGraph_node21"><a xlink:href="../proc/muller.html" xlink:title="conmax_solver%muller">
<polygon fill="#d9534f" stroke="#d9534f" points="830,-452.55 693,-452.55 693,-428.55 830,-428.55 830,-452.55"/>
<text text-anchor="middle" x="761.5" y="-438.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmax_solver%muller</text>
</a>
</g>
</g>
<!-- proc~corrct&#45;&gt;proc~muller -->
<g id="proc~~conmax~~CallsGraph_edge35" class="edge">
<title>proc~corrct&#45;&gt;proc~muller</title>
<path fill="none" stroke="#000000" d="M657.32,-441.77C665.63,-441.67 674.18,-441.57 682.65,-441.47"/>
<polygon fill="#000000" stroke="#000000" points="682.95,-444.97 692.91,-441.35 682.87,-437.97 682.95,-444.97"/>
</g>
<!-- proc~rchmod -->
<g id="proc~~conmax~~CallsGraph_node22" class="node">
<title>proc~rchmod</title>
<g id="a_proc~~conmax~~CallsGraph_node22"><a xlink:href="../proc/rchmod.html" xlink:title="rchmod">
<polygon fill="#d9534f" stroke="#d9534f" points="788.5,-372.55 734.5,-372.55 734.5,-348.55 788.5,-348.55 788.5,-372.55"/>
<text text-anchor="middle" x="761.5" y="-358.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rchmod</text>
</a>
</g>
</g>
<!-- proc~corrct&#45;&gt;proc~rchmod -->
<g id="proc~~conmax~~CallsGraph_edge36" class="edge">
<title>proc~corrct&#45;&gt;proc~rchmod</title>
<path fill="none" stroke="#000000" d="M618.37,-430.42C630.38,-424.74 644.6,-417.67 657,-410.55 673.68,-400.98 675.92,-395.39 693,-386.55 702.97,-381.39 714.21,-376.66 724.62,-372.69"/>
<polygon fill="#000000" stroke="#000000" points="726.1,-375.87 734.27,-369.13 723.68,-369.31 726.1,-375.87"/>
</g>
<!-- proc~searcr -->
<g id="proc~~conmax~~CallsGraph_node23" class="node">
<title>proc~searcr</title>
<g id="a_proc~~conmax~~CallsGraph_node23"><a xlink:href="../proc/searcr.html" xlink:title="conmax_solver%searcr">
<polygon fill="#d9534f" stroke="#d9534f" points="829.5,-494.55 693.5,-494.55 693.5,-470.55 829.5,-470.55 829.5,-494.55"/>
<text text-anchor="middle" x="761.5" y="-480.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmax_solver%searcr</text>
</a>
</g>
</g>
<!-- proc~corrct&#45;&gt;proc~searcr -->
<g id="proc~~conmax~~CallsGraph_edge37" class="edge">
<title>proc~corrct&#45;&gt;proc~searcr</title>
<path fill="none" stroke="#000000" d="M642.21,-454.55C660.25,-458.82 680.77,-463.68 699.58,-468.13"/>
<polygon fill="#000000" stroke="#000000" points="699,-471.59 709.54,-470.49 700.61,-464.78 699,-471.59"/>
</g>
<!-- proc~pmtst&#45;&gt;proc~derst -->
<g id="proc~~conmax~~CallsGraph_edge39" class="edge">
<title>proc~pmtst&#45;&gt;proc~derst</title>
<path fill="none" stroke="#000000" d="M634.03,-498.63C642.23,-502.23 650.33,-506.8 657,-512.55 681.14,-533.35 668.76,-553.87 693,-574.55 697.24,-578.17 702.04,-581.31 707.07,-584.04"/>
<polygon fill="#000000" stroke="#000000" points="705.8,-587.31 716.32,-588.51 708.84,-581.01 705.8,-587.31"/>
</g>
<!-- proc~pmtst&#45;&gt;proc~iloc -->
<g id="proc~~conmax~~CallsGraph_edge40" class="edge">
<title>proc~pmtst&#45;&gt;proc~iloc</title>
<path fill="none" stroke="#000000" d="M623.38,-498.57C634.14,-502.8 646.17,-507.7 657,-512.55 673.33,-519.86 675.68,-526.09 693,-530.55 761.02,-548.07 949.98,-575.63 1009,-537.55 1048.45,-512.11 1063.07,-454.82 1068.28,-422.98"/>
<polygon fill="#000000" stroke="#000000" points="1071.77,-423.27 1069.75,-412.87 1064.84,-422.26 1071.77,-423.27"/>
</g>
<!-- proc~rkpar&#45;&gt;proc~iloc -->
<g id="proc~~conmax~~CallsGraph_edge42" class="edge">
<title>proc~rkpar&#45;&gt;proc~iloc</title>
<path fill="none" stroke="#000000" d="M462,-436.51C470.63,-433.72 479.66,-430.66 488,-427.55 580.91,-392.92 595.88,-359.52 693,-339.55 817.8,-313.9 967.6,-360.85 1035.02,-386.07"/>
<polygon fill="#000000" stroke="#000000" points="1034.15,-389.48 1044.74,-389.77 1036.64,-382.94 1034.15,-389.48"/>
</g>
<!-- proc~rkpar&#45;&gt;proc~wolfe -->
<g id="proc~~conmax~~CallsGraph_edge44" class="edge">
<title>proc~rkpar&#45;&gt;proc~wolfe</title>
<path fill="none" stroke="#000000" d="M437.42,-460.85C491.52,-504 672.8,-648.6 737.4,-700.12"/>
<polygon fill="#000000" stroke="#000000" points="735.37,-702.98 745.37,-706.48 739.74,-697.51 735.37,-702.98"/>
</g>
<!-- proc~rkpar&#45;&gt;proc~corrct -->
<g id="proc~~conmax~~CallsGraph_edge41" class="edge">
<title>proc~rkpar&#45;&gt;proc~corrct</title>
<path fill="none" stroke="#000000" d="M486.76,-446.23C495.59,-445.91 504.72,-445.59 513.72,-445.27"/>
<polygon fill="#000000" stroke="#000000" points="513.94,-448.76 523.81,-444.9 513.69,-441.76 513.94,-448.76"/>
</g>
<!-- proc~rkpar&#45;&gt;proc~pmtst -->
<g id="proc~~conmax~~CallsGraph_edge43" class="edge">
<title>proc~rkpar&#45;&gt;proc~pmtst</title>
<path fill="none" stroke="#000000" d="M475,-460.57C491.42,-464.3 509.68,-468.44 526.7,-472.3"/>
<polygon fill="#000000" stroke="#000000" points="526.03,-475.74 536.56,-474.54 527.58,-468.91 526.03,-475.74"/>
</g>
<!-- proc~searsl&#45;&gt;proc~ercmp1 -->
<g id="proc~~conmax~~CallsGraph_edge46" class="edge">
<title>proc~searsl&#45;&gt;proc~ercmp1</title>
<path fill="none" stroke="#000000" d="M471.05,-311.5C552.12,-294.45 716.36,-272.33 830,-339.55 888.81,-374.34 919.07,-455.39 930.71,-494.57"/>
<polygon fill="#000000" stroke="#000000" points="927.35,-495.56 933.44,-504.22 934.08,-493.65 927.35,-495.56"/>
</g>
<!-- proc~searsl&#45;&gt;proc~iloc -->
<g id="proc~~conmax~~CallsGraph_edge47" class="edge">
<title>proc~searsl&#45;&gt;proc~iloc</title>
<path fill="none" stroke="#000000" d="M430.28,-311.26C452.08,-279.09 510.34,-194.38 524,-187.55 620.45,-139.33 924.24,-136.89 1009,-203.55 1063.34,-246.29 1071,-336.41 1071.47,-378.29"/>
<polygon fill="#000000" stroke="#000000" points="1067.96,-378.51 1071.44,-388.52 1074.96,-378.52 1067.96,-378.51"/>
</g>
<!-- proc~searsl&#45;&gt;proc~corrct -->
<g id="proc~~conmax~~CallsGraph_edge45" class="edge">
<title>proc~searsl&#45;&gt;proc~corrct</title>
<path fill="none" stroke="#000000" d="M454.92,-335.64C465.83,-340.25 477.78,-346 488,-352.55 520.04,-373.07 552.06,-403.54 571.33,-423.22"/>
<polygon fill="#000000" stroke="#000000" points="568.84,-425.68 578.3,-430.44 573.87,-420.81 568.84,-425.68"/>
</g>
<!-- proc~searsl&#45;&gt;proc~rchmod -->
<g id="proc~~conmax~~CallsGraph_edge48" class="edge">
<title>proc~searsl&#45;&gt;proc~rchmod</title>
<path fill="none" stroke="#000000" d="M488.07,-330.77C558.56,-338.48 667.67,-350.4 724.03,-356.56"/>
<polygon fill="#000000" stroke="#000000" points="723.93,-360.07 734.25,-357.68 724.69,-353.12 723.93,-360.07"/>
</g>
<!-- proc~setu1&#45;&gt;proc~derst -->
<g id="proc~~conmax~~CallsGraph_edge49" class="edge">
<title>proc~setu1&#45;&gt;proc~derst</title>
<path fill="none" stroke="#000000" d="M595.15,-220.59C609.95,-269.11 665.91,-450.18 693,-503.55 707.41,-531.95 729.17,-561.57 744.06,-580.49"/>
<polygon fill="#000000" stroke="#000000" points="741.39,-582.76 750.36,-588.39 746.86,-578.39 741.39,-582.76"/>
</g>
<!-- proc~setu1&#45;&gt;proc~iloc -->
<g id="proc~~conmax~~CallsGraph_edge50" class="edge">
<title>proc~setu1&#45;&gt;proc~iloc</title>
<path fill="none" stroke="#000000" d="M656.84,-199.2C746.28,-190.17 907.3,-187.91 1009,-268.55 1044.16,-296.43 1060.35,-348.98 1066.99,-378.67"/>
<polygon fill="#000000" stroke="#000000" points="1063.57,-379.4 1069.02,-388.49 1070.42,-377.99 1063.57,-379.4"/>
</g>
<!-- proc~sjelim -->
<g id="proc~~conmax~~CallsGraph_node24" class="node">
<title>proc~sjelim</title>
<g id="a_proc~~conmax~~CallsGraph_node24"><a xlink:href="../proc/sjelim.html" xlink:title="sjelim">
<polygon fill="#d9534f" stroke="#d9534f" points="617.5,-102.55 563.5,-102.55 563.5,-78.55 617.5,-78.55 617.5,-102.55"/>
<text text-anchor="middle" x="590.5" y="-88.15" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sjelim</text>
</a>
</g>
</g>
<!-- proc~slnpro&#45;&gt;proc~sjelim -->
<g id="proc~~conmax~~CallsGraph_edge51" class="edge">
<title>proc~slnpro&#45;&gt;proc~sjelim</title>
<path fill="none" stroke="#000000" d="M448.17,-90.55C476.36,-90.55 521.42,-90.55 553.06,-90.55"/>
<polygon fill="#000000" stroke="#000000" points="553.24,-94.05 563.24,-90.55 553.24,-87.05 553.24,-94.05"/>
</g>
<!-- proc~muller&#45;&gt;proc~ercmp1 -->
<g id="proc~~conmax~~CallsGraph_edge52" class="edge">
<title>proc~muller&#45;&gt;proc~ercmp1</title>
<path fill="none" stroke="#000000" d="M805.39,-452.65C813.65,-455.33 822.16,-458.34 830,-461.55 856.83,-472.56 886.02,-487.88 907.04,-499.56"/>
<polygon fill="#000000" stroke="#000000" points="905.37,-502.63 915.8,-504.48 908.79,-496.53 905.37,-502.63"/>
</g>
<!-- proc~muller&#45;&gt;proc~iloc -->
<g id="proc~~conmax~~CallsGraph_edge53" class="edge">
<title>proc~muller&#45;&gt;proc~iloc</title>
<path fill="none" stroke="#000000" d="M830.01,-435.57C879.7,-431.39 948.82,-424.48 1009,-414.55 1017.44,-413.16 1026.45,-411.33 1034.91,-409.45"/>
<polygon fill="#000000" stroke="#000000" points="1035.92,-412.81 1044.89,-407.16 1034.36,-405.98 1035.92,-412.81"/>
</g>
<!-- proc~searcr&#45;&gt;proc~ercmp1 -->
<g id="proc~~conmax~~CallsGraph_edge54" class="edge">
<title>proc~searcr&#45;&gt;proc~ercmp1</title>
<path fill="none" stroke="#000000" d="M824.34,-494.63C837.41,-497.19 851.32,-499.91 864.73,-502.53"/>
<polygon fill="#000000" stroke="#000000" points="864.38,-506.02 874.86,-504.51 865.72,-499.15 864.38,-506.02"/>
</g>
<!-- proc~searcr&#45;&gt;proc~iloc -->
<g id="proc~~conmax~~CallsGraph_edge55" class="edge">
<title>proc~searcr&#45;&gt;proc~iloc</title>
<path fill="none" stroke="#000000" d="M829.61,-476.84C880.18,-470.98 950.56,-459.5 1009,-437.55 1021.83,-432.73 1035.02,-425.27 1045.91,-418.32"/>
<polygon fill="#000000" stroke="#000000" points="1048.06,-421.09 1054.47,-412.66 1044.19,-415.26 1048.06,-421.09"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprocconmaxCallsGraph = svgPanZoom('#procconmaxCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">    </span><span class="k">subroutine </span><span class="n">conmax</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="w"> </span><span class="n">Ioptn</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">,</span><span class="w"> </span><span class="n">Itlim</span><span class="p">,</span><span class="w"> </span><span class="n">Fun</span><span class="p">,</span><span class="w"> </span><span class="n">Ifun</span><span class="p">,</span><span class="w"> </span><span class="n">Pttbl</span><span class="p">,</span><span class="w"> </span><span class="n">Iptb</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">Indm</span><span class="p">,</span><span class="w"> </span><span class="n">Iwork</span><span class="p">,</span><span class="w"> </span><span class="n">Liwrk</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">,</span><span class="w"> </span><span class="n">Lwrk</span><span class="p">,</span><span class="w"> </span><span class="n">Iter</span><span class="p">,</span><span class="w"> </span><span class="n">Param</span><span class="p">,</span><span class="w"> </span><span class="n">Error</span><span class="p">)</span>

<span class="w">        </span><span class="k">implicit none</span>

<span class="k">        class</span><span class="p">(</span><span class="n">conmax_solver</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">me</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">ifun</span><span class="w">   </span><span class="c">!! THIS IS THE DIMENSION OF FUN IN THE DRIVER PROGRAM.</span>
<span class="w">                                      </span><span class="c">!! IT MUST BE &gt;= THE LARGEST INDEX I FOR WHICH FUN(I) IS USED</span>
<span class="w">                                      </span><span class="c">!! UNLESS NO FUN(I) IS USED, IN WHICH CASE IT MUST BE &gt;= 1.</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">Indm</span><span class="w">   </span><span class="c">!! THIS IS THE SECOND DIMENSION OF PTTBL IN THE DRIVER</span>
<span class="w">                                      </span><span class="c">!! PROGRAM.  IT MUST BE &gt;= THE LARGEST SUBSCRIPT J FOR WHICH A</span>
<span class="w">                                      </span><span class="c">!! VALUE PTTBL(I,J) IS USED, AND MUST BE &gt;= 1 IF NO SUCH VALUES</span>
<span class="w">                                      </span><span class="c">!! ARE USED.</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">ioptn</span><span class="w">    </span><span class="c">!! THIS IS THE OPTION SWITCH, WHICH SHOULD BE SET TO</span>
<span class="w">                                        </span><span class="c">!! 0 UNLESS ONE OR MORE OF THE EXTRA OPTIONS DESCRIBED BELOW</span>
<span class="w">                                        </span><span class="c">!! IS USED. THE USER HAS SEVERAL EXTRA OPTIONS WHICH ARE ACTIVATED BY SETTING</span>
<span class="w">                                        </span><span class="c">!! IOPTN TO A VALUE OTHER THAN 0; MORE THAN ONE AT A TIME CAN BE USED.</span>
<span class="w">                                        </span><span class="c">!! IN PARTICULAR:</span>
<span class="w">                                        </span><span class="c">!!</span>
<span class="w">                                        </span><span class="c">!! * IF THE ONES DIGIT OF IOPTN IS 0, THEN THE USER SHOULD GIVE FORMULAS</span>
<span class="w">                                        </span><span class="c">!!   IN FNSET FOR COMPUTING THE PARTIAL DERIVATIVES WHEN INDFN=1 AS DESCRIBED</span>
<span class="w">                                        </span><span class="c">!!   ABOVE.</span>
<span class="w">                                        </span><span class="c">!!</span>
<span class="w">                                        </span><span class="c">!! * IF THE USER SETS THE ONES DIGIT OF IOPTN TO 1, THEN INDFN WILL ALWAYS</span>
<span class="w">                                        </span><span class="c">!!   BE 0 WHEN FNSET IS CALLED, AND THE PROGRAM WILL AUTOMATICALLY</span>
<span class="w">                                        </span><span class="c">!!   APPROXIMATE THE PARTIAL DERIVATIVES WHEN REQUIRED USING THE FOLLOWING</span>
<span class="w">                                        </span><span class="c">!!   CENTERED DIFFERENCE FORMULA:</span>
<span class="w">                                        </span><span class="c">!!   PARTIAL DERIVATIVE WITH RESPECT TO THE JTH VARIABLE (WHERE 1 &lt;= J</span>
<span class="w">                                        </span><span class="c">!!   &lt;= NPARM) OF THE FUNCTION WHOSE VALUE IS COMPUTED IN CONFUN(IPT,1)</span>
<span class="w">                                        </span><span class="c">!!   (WHERE 1 &lt;= IPT &lt;= NUMGR) IS APPROXIMATELY THE VALUE OF THIS</span>
<span class="w">                                        </span><span class="c">!!   FUNCTION WHEN THE JTH COMPONENT OF PARAM IS INCREASED BY DELT, MINUS</span>
<span class="w">                                        </span><span class="c">!!   THE VALUE OF THIS FUNCTION WHEN THE JTH COMPONENT OF PARAM IS</span>
<span class="w">                                        </span><span class="c">!!   DECREASED BY DELT, ALL DIVIDED BY 2.0*DELT, WHERE DELT = SQRT(B**(-ITT)),</span>
<span class="w">                                        </span><span class="c">!!   WHERE B IS THE BASE FOR FOR FLOATING POINT NUMBERS AND ITT IS THE NUMBER</span>
<span class="w">                                        </span><span class="c">!!   OF BASE B DIGITS IN THE MANTISSA.</span>
<span class="w">                                        </span><span class="c">!!</span>
<span class="w">                                        </span><span class="c">!! * IF THE TENS DIGIT OF IOPTN IS 0, THE PROGRAM WILL NOT GIVE UP</span>
<span class="w">                                        </span><span class="c">!!   UNTIL EITHER AN ITERATION FAILS TO PRODUCE A REDUCTION ABS(ENCHG) OF</span>
<span class="w">                                        </span><span class="c">!!   MORE THAN 100.0*B**(-ITT) IN THE PRINCIPAL ERROR NORM, OR ITLIM</span>
<span class="w">                                        </span><span class="c">!!   ITERATIONS HAVE BEEN USED.</span>
<span class="w">                                        </span><span class="c">!!</span>
<span class="w">                                        </span><span class="c">!! * IF THE TENS DIGIT OF IOPTN IS 1, THE PROGRAM WILL ALSO GIVE UP IF</span>
<span class="w">                                        </span><span class="c">!!   ABS(ENCHG) &lt; ENCSM FOR LIMSM CONSECUTIVE STEPS IN THE MAIN PART OF</span>
<span class="w">                                        </span><span class="c">!!   THE PROGRAM (I.E. AFTER TYPE -1 AND TYPE -2 FEASIBILITY HAVE BOTH BEEN</span>
<span class="w">                                        </span><span class="c">!!   ACHIEVED).  THIS OPTION MAY BE USEFUL IN SAVING SOME TIME BY</span>
<span class="w">                                        </span><span class="c">!!   FORESTALLING A LONG STRING OF ITERATIONS AT THE END OF A RUN WITH ONLY</span>
<span class="w">                                        </span><span class="c">!!   A TINY IMPROVEMENT IN EACH ONE.  ENCSM AND LIMSM ARE TRANSMITTED TO</span>
<span class="w">                                        </span><span class="c">!!   CONMAX IN WORK(1) AND IWORK(1) RESPECTIVELY.  WORK(1) AND IWORK(1) DO</span>
<span class="w">                                        </span><span class="c">!!   NOT NEED TO BE ASSIGNED VALUES IF THE TENS DIGIT OF IOPTN IS 0.</span>
<span class="w">                                        </span><span class="c">!!</span>
<span class="w">                                        </span><span class="c">!! * IF THE HUNDREDS DIGIT OF IOPTN IS 0 OR 2, THEN THE INTERNAL PARAMETER</span>
<span class="w">                                        </span><span class="c">!!   NSTEP WILL BE GIVEN THE DEFAULT VALUE 1.  NSTEP IS THE NUMBER OF</span>
<span class="w">                                        </span><span class="c">!!   RUNGE-KUTTA STEPS USED IN EACH RK ITERATION.</span>
<span class="w">                                        </span><span class="c">!!</span>
<span class="w">                                        </span><span class="c">!! * IF THE HUNDREDS DIGIT OF IOPTN IS 1 OR 3, THEN THE VALUE OF NSTEP USED</span>
<span class="w">                                        </span><span class="c">!!   WILL BE THE POSITIVE INTEGER VALUE PLACED IN IWORK(2) BY THE USER IN THE</span>
<span class="w">                                        </span><span class="c">!!   DRIVER PROGRAM.  SETTING NSTEP LARGER THAN 1 MAY ALLOW THE PROGRAM TO</span>
<span class="w">                                        </span><span class="c">!!   SUCCEED ON DIFFICULT PROBLEMS WHERE THE CONVERGENCE WOULD BE EXTREMELY</span>
<span class="w">                                        </span><span class="c">!!   SLOW WITH NSTEP=1, BUT IT WILL GENERALLY CAUSE MORE COMPUTER TIME TO BE</span>
<span class="w">                                        </span><span class="c">!!   USED IN EACH RK ITERATION.  IWORK(2) DOES NOT NEED TO BE ASSIGNED A</span>
<span class="w">                                        </span><span class="c">!!   VALUE IF THE HUNDREDS DIGIT OF IOPTN IS 0 OR 2.  (NSTEP IS SOMETIMES</span>
<span class="w">                                        </span><span class="c">!!   CALLED THE OVERDRIVE PARAMETER.)</span>
<span class="w">                                        </span><span class="c">!!</span>
<span class="w">                                        </span><span class="c">!! * IF THE HUNDREDS DIGIT OF IOPTN IS 0 OR 1, THEN THE INTERNAL PARAMETER</span>
<span class="w">                                        </span><span class="c">!!   TOLCON WILL BE GIVEN THE DEFAULT VALUE SQRT(B**(-ITT)), WHERE B IS THE</span>
<span class="w">                                        </span><span class="c">!!   BASE FOR FLOATING POINT NUMBERS AND ITT IS THE NUMBER OF BASE B DIGITS</span>
<span class="w">                                        </span><span class="c">!!   IN THE MANTISSA.</span>
<span class="w">                                        </span><span class="c">!!</span>
<span class="w">                                        </span><span class="c">!! * IF THE HUNDREDS DIGIT OF IOPTN IS 2 OR 3, THEN THE VALUE OF TOLCON USED</span>
<span class="w">                                        </span><span class="c">!!   WILL BE THE VALUE PLACED IN WORK(2) BY THE USER IN THE DRIVER PROGRAM.</span>
<span class="w">                                        </span><span class="c">!!   THIS VALUE SHOULD ALWAYS BE NONNEGATIVE.  IF THERE ARE NO TYPE -2 OR -1</span>
<span class="w">                                        </span><span class="c">!!   CONSTRAINTS THEN THE SETTING OF TOLCON WILL HAVE NO EFFECT, BUT IF</span>
<span class="w">                                        </span><span class="c">!!   THERE ARE TYPE -2 OR -1 CONSTRAINTS THEN IN GENERAL SMALLER VALUES OF</span>
<span class="w">                                        </span><span class="c">!!   TOLCON MAY GIVE MORE ACCURACY IN THE FINAL ANSWER, BUT MAY SLOW DOWN</span>
<span class="w">                                        </span><span class="c">!!   OR PREVENT CONVERGENCE, WHILE LARGER VALUES OF TOLCON MAY HAVE THE</span>
<span class="w">                                        </span><span class="c">!!   REVERSE EFFECT.  IN PARTICULAR, IF THE TYPE -2 AND -1 CONSTRAINTS</span>
<span class="w">                                        </span><span class="c">!!   CANNOT BE SATISFIED SUMULTANEOUSLY WITH STRICT INEQUALITY (THIS CASE</span>
<span class="w">                                        </span><span class="c">!!   COULD OCCUR, FOR EXAMPLE, IF AN EQUALITY CONSTRAINT G = 0.0 WAS</span>
<span class="w">                                        </span><span class="c">!!   ENTERED AS THE TWO INEQUALITY CONSTRAINTS G &lt;= 0.0 AND</span>
<span class="w">                                        </span><span class="c">!!   -G &lt;= 0.0), THEN SETTING TOLCON=0.0 WILL ALMOST CERTAINLY CAUSE THE</span>
<span class="w">                                        </span><span class="c">!!   PROGRAM TO FAIL, SINCE AT EACH ITERATION THE PROGRAM WILL NOT ACCEPT</span>
<span class="w">                                        </span><span class="c">!!   PROSPECTIVE NEW VALUES OF THE PARAMETERS UNLESS IT CAN CORRECT THEM</span>
<span class="w">                                        </span><span class="c">!!   BACK INTO THE RELAXED FEASIBLE REGION WHERE CONFUN(IPT,1) &lt;= TOLCON</span>
<span class="w">                                        </span><span class="c">!!   FOR ALL THE TYPE -2 AND -1 CONSTRAINTS.</span>
<span class="w">                                        </span><span class="c">!!</span>
<span class="w">                                        </span><span class="c">!! * IF THE THOUSANDS DIGIT OF IOPTN IS 0, THE PROGRAM WILL USE THE RK METHOD</span>
<span class="w">                                        </span><span class="c">!!   (WHICH INVOLVES APPLYING FOURTH ORDER RUNGE-KUTTA TO A SYSTEM OF</span>
<span class="w">                                        </span><span class="c">!!   DIFFERENTIAL EQUATIONS), THEN IF THIS FAILS IT WILL TRY TO REDUCE</span>
<span class="w">                                        </span><span class="c">!!   W WITH AN SLP STEP (I.E. SUCCESSIVE LINEAR PROGRAMMING WITH A TRUST</span>
<span class="w">                                        </span><span class="c">!!   REGION), THEN GO BACK TO RK IF THE SLP STEP REDUCES W.</span>
<span class="w">                                        </span><span class="c">!!</span>
<span class="w">                                        </span><span class="c">!! * IF THE THOUSANDS DIGIT OF IOPTN IS 1, THE PROGRAM WILL USE SLP STEPS ONLY.</span>
<span class="w">                                        </span><span class="c">!!   IN GENERAL, IN SOME PROBLEMS SLP WORKS VERY WELL, AND IN THOSE</span>
<span class="w">                                        </span><span class="c">!!   PROBLEMS IT WILL USUALLY BE FASTER THAN RK BECAUSE IT REQUIRES FEWER</span>
<span class="w">                                        </span><span class="c">!!   GRADIENT EVALUATIONS THAN RK, BUT IN OTHER PROBLEMS THE CONVERGENCE</span>
<span class="w">                                        </span><span class="c">!!   OF SLP MAY BE EXCRUCIATINGLY SLOW, AND THE MORE POWERFUL RK METHOD</span>
<span class="w">                                        </span><span class="c">!!   MAY BE MUCH FASTER.</span>
<span class="w">                                        </span><span class="c">!!</span>
<span class="w">                                        </span><span class="c">!! * IF THE THOUSANDS DIGIT OF IOPTN IS 2 THE PROGRAM WILL USE THE RK METHOD</span>
<span class="w">                                        </span><span class="c">!!   ONLY, QUITTING WHEN RK CAN NO LONGER PRODUCE AN IMPROVEMENT.  THIS</span>
<span class="w">                                        </span><span class="c">!!   MAY GIVE A LITTLE LESS ACCURACY THAN SETTING THE THOUSANDS DIGIT TO 0,</span>
<span class="w">                                        </span><span class="c">!!   BUT MAY SAVE SIGNIFICANT COMPUTER TIME IN SOME CASES.</span>
<span class="w">                                        </span><span class="c">!!</span>
<span class="w">                                        </span><span class="c">!! * IF THE TEN THOUSANDS DIGIT OF IOPTN IS 0, THEN FNSET SHOULD BE WRITTEN AS</span>
<span class="w">                                        </span><span class="c">!!   DESCRIBED ABOVE.</span>
<span class="w">                                        </span><span class="c">!!</span>
<span class="w">                                        </span><span class="c">!! * IF THE USER SETS THE TEN THOUSANDS DIGIT OF IOPTN TO 1, THEN FNSET SHOULD BE</span>
<span class="w">                                        </span><span class="c">!!   WRITTEN AS DESCRIBED ABOVE EXCEPT THAT THE COMPUTATIONS SHOULD BE DONE</span>
<span class="w">                                        </span><span class="c">!!   FOR ALL IPT=1,..,NUMGR INSTEAD OF FOR A SINGLE GIVEN VALUE OF IPT.</span>
<span class="w">                                        </span><span class="c">!!   THIS OPTION MAY SAVE COMPUTER TIME IN PROBLEMS WHERE A LARGE PART OF</span>
<span class="w">                                        </span><span class="c">!!   THE COMPUTATION IS THE SAME FOR DIFFERENT VALUES OF IPT, SINCE IT</span>
<span class="w">                                        </span><span class="c">!!   AVOIDS UNNECESSARY REPITITION OF THIS COMMON COMPUTATION BY HAVING</span>
<span class="w">                                        </span><span class="c">!!   THE LOOP OVER IPT IN FNSET INSTEAD OF OUTSIDE FNSET.</span>
<span class="w">                                        </span><span class="c">!!   IF THE TEN THOUSANDS DIGIT OF IOPTN IS 1, EVEN MORE TIME CAN OFTEN BE</span>
<span class="w">                                        </span><span class="c">!!   SAVED IF FNSET IS WRITTEN SO THAT ALL CONSTRAINTS ARE COMPUTED IF IPT=0,</span>
<span class="w">                                        </span><span class="c">!!   BUT ONLY THE STANDARD (I.E. TYPE -1 OR -2) CONSTRAINTS ARE COMPUTED IF</span>
<span class="w">                                        </span><span class="c">!!   IPT=-1.  NOTE THAT IF THE TEN THOUSANDS DIGIT OF IOPTN IS 0, THEN IPT</span>
<span class="w">                                        </span><span class="c">!!   WILL BE POSITIVE WHENEVER FNSET IS CALLED, INDICATING THAT ONLY</span>
<span class="w">                                        </span><span class="c">!!   CONSTRAINT IPT SHOULD BE COMPUTED.</span>
<span class="w">                                        </span><span class="c">!!   THE DRAWBACK OF USING THIS OPTION IS THAT IN GENERAL SOME CONSTRAINT</span>
<span class="w">                                        </span><span class="c">!!   VALUES AND DERIVATIVES WILL BE COMPUTED UNNECESSARILY, WHICH COULD COST</span>
<span class="w">                                        </span><span class="c">!!   TIME IN SOME PROBLEMS.</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">iptb</span><span class="w">   </span><span class="c">!! THIS IS THE FIRST DIMENSION OF PTTBL IN THE DRIVER</span>
<span class="w">                                      </span><span class="c">!! PROGRAM.  IT MUST BE &gt;= THE LARGEST SUBSCRIPT I FOR WHICH A</span>
<span class="w">                                      </span><span class="c">!! VALUE PTTBL(I,J) IS USED, AND MUST BE &gt;= 1 IF NO SUCH VALUES</span>
<span class="w">                                      </span><span class="c">!! ARE USED.</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">itlim</span><span class="w">  </span><span class="c">!! THIS IS THE LIMIT ON THE NUMBER OF ITERATIONS, I.E.</span>
<span class="w">                                      </span><span class="c">!! THE LIMIT ON THE NUMBER OF TIMES THE PROGRAM REDUCES W.  IF</span>
<span class="w">                                      </span><span class="c">!! ITLIM IS SET TO 0 THE PROGRAM WILL COMPUTE THE ERRORS FOR</span>
<span class="w">                                      </span><span class="c">!! THE INITIAL APPROXIMATION AND STOP WITHOUT CHECKING</span>
<span class="w">                                      </span><span class="c">!! FEASIBILITY.</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">liwrk</span><span class="w">  </span><span class="c">!! THIS IS THE DIMENSION OF IWORK IN THE DRIVER PROGRAM.</span>
<span class="w">                                      </span><span class="c">!! IT MUST BE AT LEAST 7*NUMGR + 7*NPARM + 3.  IF NOT, CONMAX WILL</span>
<span class="w">                                      </span><span class="c">!! RETURN WITH THIS MINIMUM VALUE MULTIPLIED BY -1 AS A WARNING.</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">lwrk</span><span class="w">   </span><span class="c">!! THIS IS THE DIMENSION OF WORK IN THE DRIVER PROGRAM.</span>
<span class="w">                                      </span><span class="c">!! IT MUST BE AT LEAST 2*NPARM**2 + 4*NUMGR*NPARM + 11*NUMGR +</span>
<span class="w">                                      </span><span class="c">!! 27*NPARM + 13.  IF NOT, CONMAX WILL RETURN WITH THIS MINIMUM</span>
<span class="w">                                      </span><span class="c">!! VALUE MULTIPLIED BY -1 AS A WARNING.</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">nparm</span><span class="w">  </span><span class="c">!! THIS IS THE NUMBER OF PARAMETERS IN THE PROBLEM.</span>
<span class="w">                                      </span><span class="c">!! (THEY ARE STORED IN `PARAM` -- SEE BELOW.)</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">numgr</span><span class="w">  </span><span class="c">!! THIS IS THE TOTAL NUMBER OF CONSTRAINTS.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">Ifun</span><span class="p">)</span><span class="w">    </span><span class="c">!! (VECTOR ARRAY OF DIMENSION IFUN)  THIS IS</span>
<span class="w">                                            </span><span class="c">!! A VECTOR ARRAY IN WHICH DATA OR FUNCTION VALUES IN TYPE 2</span>
<span class="w">                                            </span><span class="c">!! CONSTRAINTS (SEE ABOVE) CAN BE STORED.  FUN(I) NEED NOT BE</span>
<span class="w">                                            </span><span class="c">!! ASSIGNED A VALUE IF IT IS NOT GOING TO BE USED.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">pttbl</span><span class="p">(</span><span class="n">Iptb</span><span class="p">,</span><span class="w"> </span><span class="n">Indm</span><span class="p">)</span><span class="w">  </span><span class="c">!! (MATRIX ARRAY OF DIMENSION (IPTB,INDM))</span>
<span class="w">                                                 </span><span class="c">!! ROW I OF THIS ARRAY NORMALLY CONTAINS A POINT USED IN THE ITH</span>
<span class="w">                                                 </span><span class="c">!! CONSTRAINT.  THE ENTRIES IN ROW I NEED NOT BE ASSIGNED VALUES IF</span>
<span class="w">                                                 </span><span class="c">!! SUCH A POINT IS NOT USED IN THE ITH CONSTRAINT.</span>
<span class="w">                                                 </span><span class="c">!! (EXAMPLE:  IF THE LEFT SIDE OF CONSTRAINT I IS A POLYNOMIAL IN</span>
<span class="w">                                                 </span><span class="c">!! ONE INDEPENDENT VARIABLE, THEN THE VALUE OF THE INDEPENDENT</span>
<span class="w">                                                 </span><span class="c">!! VARIABLE SHOULD BE IN PTTBL(I,1), AND THE COEFFICIENTS SHOULD BE</span>
<span class="w">                                                 </span><span class="c">!! IN PARAM.)</span>
<span class="w">                                                 </span><span class="c">!! PTTBL CAN ALSO BE USED TO PASS OTHER INFORMATION FROM THE DRIVER</span>
<span class="w">                                                 </span><span class="c">!! PROGRAM TO SUBROUTINE FNSET.</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="n">Liwrk</span><span class="p">)</span><span class="w">     </span><span class="c">!! (VECTOR ARRAY OF DIMENSION LIWRK)  THIS IS AN INTEGER</span>
<span class="w">                                                </span><span class="c">!! WORK ARRAY.  THE USER NEED NOT PLACE ANY VALUES IN IT, EXCEPT</span>
<span class="w">                                                </span><span class="c">!! POSSIBLY CERTAIN OPTIONAL INFORMATION AS DESCRIBED BELOW.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="n">Lwrk</span><span class="p">)</span><span class="w">   </span><span class="c">!! (VECTOR ARRAY OF DIMENSION LWRK)  THIS IS A FLOATING</span>
<span class="w">                                            </span><span class="c">!! POINT WORK ARRAY.  THE USER NEED NOT PLACE ANY VALUES IN IT,</span>
<span class="w">                                            </span><span class="c">!! EXCEPT POSSIBLY CERTAIN OPTIONAL INFORMATION AS DESCRIBED BELOW.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">param</span><span class="p">(</span><span class="n">Nparm</span><span class="p">)</span><span class="w"> </span><span class="c">!! (VECTOR ARRAY OF DIMENSION AT LEAST NPARM</span>
<span class="w">                                            </span><span class="c">!! IN THE DRIVER PROGRAM)  THE USER SHOULD PLACE AN INITIAL GUESS</span>
<span class="w">                                            </span><span class="c">!! FOR THE PARAMETERS IN PARAM, AND ON OUTPUT PARAM WILL CONTAIN</span>
<span class="w">                                            </span><span class="c">!! THE BEST PARAMETERS CONMAX HAS BEEN ABLE TO FIND.  IF THE</span>
<span class="w">                                            </span><span class="c">!! INITIAL PARAM IS NOT FEASIBLE THE PROGRAM WILL FIRST TRY TO</span>
<span class="w">                                            </span><span class="c">!! FIND A FEASIBLE PARAM.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">error</span><span class="p">(</span><span class="n">Numgr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">   </span><span class="c">!! (VECTOR ARRAY OF DIMENSION AT LEAST NUMGR + 3 IN THE</span>
<span class="w">                                                </span><span class="c">!! DRIVER PROGRAM)  FOR I=1,...,NUMGR, CONMAX WILL PLACE IN</span>
<span class="w">                                                </span><span class="c">!! ERROR(I) THE ERROR IN CONSTRAINT I (DEFINED TO BE THE VALUE</span>
<span class="w">                                                </span><span class="c">!! OF THE LEFT SIDE OF CONSTRAINT I, EXCEPT WITHOUT THE ABSOLUTE</span>
<span class="w">                                                </span><span class="c">!! VALUE IN TYPE 2 CONSTRAINTS).  FURTHER,</span>
<span class="w">                                                </span><span class="c">!!</span>
<span class="w">                                                </span><span class="c">!!  * ERROR(NUMGR+1) WILL BE THE (PRINCIPAL) ERROR NORM, THAT IS, THE</span>
<span class="w">                                                </span><span class="c">!!    MAXIMUM VALUE OF THE LEFT SIDES OF THE TYPE 2 (INCLUDING THE</span>
<span class="w">                                                </span><span class="c">!!    ABSOLUTE VALUE) AND TYPE 1 CONSTRAINTS.</span>
<span class="w">                                                </span><span class="c">!!</span>
<span class="w">                                                </span><span class="c">!!  * ERROR(NUMGR+2) WILL BE THE MAXIMUM VALUE OF THE LEFT SIDES OF THE</span>
<span class="w">                                                </span><span class="c">!!    TYPE -1 CONSTRAINTS, OR 0.0 IF THERE ARE NO TYPE -1</span>
<span class="w">                                                </span><span class="c">!!    CONSTRAINTS.  EXCEPT FOR ROUNDOFF ERROR AND SMALL TOLERANCES</span>
<span class="w">                                                </span><span class="c">!!    IN SOME SUBROUTINES THIS VALUE WILL NORMALLY BE &lt;= 0.0, AND</span>
<span class="w">                                                </span><span class="c">!!    IT WILL NOT BE ALLOWED TO BE &gt; TOLCON IN THE MAIN PART OF</span>
<span class="w">                                                </span><span class="c">!!    THE PROGRAM.</span>
<span class="w">                                                </span><span class="c">!!</span>
<span class="w">                                                </span><span class="c">!!  * ERROR(NUMGR+3) WILL BE THE MAXIMUM VALUE OF THE LEFT SIDES OF THE</span>
<span class="w">                                                </span><span class="c">!!    TYPE -2 CONSTRAINTS, OR 0.0 IF THERE ARE NO TYPE -2</span>
<span class="w">                                                </span><span class="c">!!    CONSTRAINTS.  THIS VALUE SHOULD BE &lt;= TOLCON, SINCE THE</span>
<span class="w">                                                </span><span class="c">!!    PROGRAM WILL NOT EVEN ATTEMPT TO COMPUTE VALUES FOR THE</span>
<span class="w">                                                </span><span class="c">!!    TYPE 2 AND TYPE 1 CONSTRAINTS OTHERWISE (EXCEPT FOR VALUES</span>
<span class="w">                                                </span><span class="c">!!    CORRESPONDING TO THE INITIAL PARAMETERS PLACED IN PARAM BY</span>
<span class="w">                                                </span><span class="c">!!    THE USER).  THE USER CAN USE THIS FEATURE TO INSERT TYPE -2</span>
<span class="w">                                                </span><span class="c">!!    OR -1 CONSTRAINTS TO KEEP THE PARAMETERS AWAY FROM VALUES</span>
<span class="w">                                                </span><span class="c">!!    WHERE A TYPE 2 OR TYPE 1 CONSTRAINT IS UNDEFINED.</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="c">!! THIS IS THE NUMBER OF ITERATIONS PERFORMED BY CONMAX,</span>
<span class="w">                                    </span><span class="c">!! INCLUDING THOSE USED IN ATTEMPTING TO GAIN FEASIBILITY,</span>
<span class="w">                                    </span><span class="c">!! UNTIL EITHER IT CAN NO LONGER IMPROVE THE SITUATION OR THE</span>
<span class="w">                                    </span><span class="c">!! ITERATION LIMIT IS REACHED.  IF ITER=ITLIM IT IS POSSIBLE</span>
<span class="w">                                    </span><span class="c">!! THAT THE PROGRAM COULD FURTHER REDUCE W IF RESTARTED</span>
<span class="w">                                    </span><span class="c">!! (POSSIBLY WITH THE NEW PARAMETERS).</span>
<span class="w">                                    </span><span class="c">!!</span>
<span class="w">                                    </span><span class="c">!!  * ITER=-1 IS A SIGNAL THAT TYPE -1 FEASIBILITY COULD NOT BE</span>
<span class="w">                                    </span><span class="c">!!    ACHIEVED, IN THIS CASE ERROR WILL CONTAIN THE VALUES COMPUTED</span>
<span class="w">                                    </span><span class="c">!!    USING THE USER SUPPLIED INITIAL APPROXIMATION.</span>
<span class="w">                                    </span><span class="c">!!  * ITER=-2 IS A SIGNAL THAT TYPE -1 FEASIBILITY WAS ACHIEVED</span>
<span class="w">                                    </span><span class="c">!!    BUT TYPE -2 FEASIBILITY COULD NOT BE ACHIEVED,</span>
<span class="w">                                    </span><span class="c">!!    IN THIS CASE VALUES IN ERROR CORRESPONDING TO TYPE 1 OR</span>
<span class="w">                                    </span><span class="c">!!    TYPE 2 CONSTRAINTS WILL BE ZERO.</span>

<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">enc1</span><span class="p">,</span><span class="w"> </span><span class="n">enchg</span><span class="p">,</span><span class="w"> </span><span class="n">encsm</span><span class="p">,</span><span class="w"> </span><span class="n">enor2</span><span class="p">,</span><span class="w"> </span><span class="n">enor3</span><span class="p">,</span><span class="w"> </span><span class="n">enorm</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">prjslp</span><span class="p">,</span><span class="w"> </span><span class="n">projct</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">rchdnk</span><span class="p">,</span><span class="w"> </span><span class="n">rchdwn</span><span class="p">,</span><span class="w"> </span><span class="n">rchin</span><span class="p">,</span><span class="w"> </span><span class="n">s</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tolcon</span><span class="p">,</span><span class="w"> </span><span class="n">tollin</span><span class="p">,</span><span class="w"> </span><span class="n">wdist</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">i1</span><span class="p">,</span><span class="w"> </span><span class="n">ii</span><span class="p">,</span><span class="w"> </span><span class="n">ilc02</span><span class="p">,</span><span class="w"> </span><span class="n">ilc06</span><span class="p">,</span><span class="w"> </span><span class="n">ilc08</span><span class="p">,</span><span class="w"> </span><span class="n">ilc11</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">ilc12</span><span class="p">,</span><span class="w"> </span><span class="n">ilc13</span><span class="p">,</span><span class="w"> </span><span class="n">ilc14</span><span class="p">,</span><span class="w"> </span><span class="n">ilc15</span><span class="p">,</span><span class="w"> </span><span class="n">ilc17</span><span class="p">,</span><span class="w"> </span><span class="n">ilc20</span><span class="p">,</span><span class="w"> </span><span class="n">ilc21</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">ilc22</span><span class="p">,</span><span class="w"> </span><span class="n">ilc24</span><span class="p">,</span><span class="w"> </span><span class="n">ilc25</span><span class="p">,</span><span class="w"> </span><span class="n">ilc26</span><span class="p">,</span><span class="w"> </span><span class="n">ilc27</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ilc29</span><span class="p">,</span><span class="w"> </span><span class="n">ilc30</span><span class="p">,</span><span class="w"> </span><span class="n">ilc31</span><span class="p">,</span><span class="w"> </span><span class="n">ilc33</span><span class="p">,</span><span class="w"> </span><span class="n">ilc35</span><span class="p">,</span><span class="w"> </span><span class="n">ilc40</span><span class="p">,</span><span class="w"> </span><span class="n">ilc42</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">ilc44</span><span class="p">,</span><span class="w"> </span><span class="n">ilc46</span><span class="p">,</span><span class="w"> </span><span class="n">iophun</span><span class="p">,</span><span class="w"> </span><span class="n">iopten</span><span class="p">,</span><span class="w"> </span><span class="n">ioptho</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">ioptth</span><span class="p">,</span><span class="w"> </span><span class="n">iphse</span><span class="p">,</span><span class="w"> </span><span class="n">ipmax</span><span class="p">,</span><span class="w"> </span><span class="n">ipt</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">irk</span><span class="p">,</span><span class="w"> </span><span class="n">ismax</span><span class="p">,</span><span class="w"> </span><span class="n">isucc</span><span class="p">,</span><span class="w"> </span><span class="n">itersl</span><span class="p">,</span><span class="w"> </span><span class="n">itlim1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">ityp1</span><span class="p">,</span><span class="w"> </span><span class="n">ityp1k</span><span class="p">,</span><span class="w"> </span><span class="n">ityp2</span><span class="p">,</span><span class="w"> </span><span class="n">ityp2k</span><span class="p">,</span><span class="w"> </span><span class="n">itypm1</span><span class="p">,</span><span class="w"> </span><span class="n">itypm2</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j1</span><span class="p">,</span><span class="w"> </span><span class="n">j2</span><span class="p">,</span><span class="w"> </span><span class="n">jflag</span><span class="p">,</span><span class="w"> </span><span class="n">jiwrk</span><span class="p">,</span><span class="w"> </span><span class="n">jj</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">jwrk</span><span class="p">,</span><span class="w"> </span><span class="n">kntsm</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">l1</span><span class="p">,</span><span class="w"> </span><span class="n">l2</span><span class="p">,</span><span class="w"> </span><span class="n">limsm</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">mact1</span><span class="p">,</span><span class="w"> </span><span class="n">ncor</span><span class="p">,</span><span class="w"> </span><span class="n">nmaj</span><span class="p">,</span><span class="w"> </span><span class="n">nmin</span><span class="p">,</span><span class="w"> </span><span class="n">npar1</span><span class="p">,</span><span class="w"> </span><span class="n">nstep</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">numlim</span>

<span class="w">        </span><span class="c">! check to see if the dimensions liwrk and lwrk are large enough.</span>
<span class="w">        </span><span class="n">jiwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="o">*</span><span class="n">Numgr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">7</span><span class="o">*</span><span class="n">Nparm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span>
<span class="w">        </span><span class="n">jwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">Nparm</span><span class="o">**</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="n">Numgr</span><span class="o">*</span><span class="n">Nparm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">11</span><span class="o">*</span><span class="n">Numgr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">27</span><span class="o">*</span><span class="n">Nparm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">13</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Liwrk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">jiwrk</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">Lwrk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">jwrk</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">            </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">999</span><span class="w">  </span><span class="c">! error flag</span>
<span class="w">            </span><span class="k">return</span>

<span class="k">        else</span>

<span class="w">            </span><span class="c">! INITIALIZE SOME OTHER PARAMETERS.</span>
<span class="w">            </span><span class="n">npar1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Nparm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="n">isucc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">Iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">itersl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">itlim1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Itlim</span>
<span class="w">            </span><span class="n">enchg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">            </span><span class="n">ilc02</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc06</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc17</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc24</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc25</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc26</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc27</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">27</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc29</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">29</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc30</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc31</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc33</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc35</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc40</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc42</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc44</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">44</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>
<span class="w">            </span><span class="n">ilc46</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iloc</span><span class="p">(</span><span class="mi">46</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">)</span>

<span class="w">            </span><span class="c">! IF THE TENS DIGIT OF IOPTN IS 1, SET KNTSM TO 0 AND GET ENCSM</span>
<span class="w">            </span><span class="c">! FROM WORK(1) AND LIMSM FROM IWORK(1).</span>
<span class="w">            </span><span class="n">iopten</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Ioptn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">Ioptn</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iopten</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">kntsm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                </span><span class="n">encsm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                </span><span class="n">limsm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="w">            </span><span class="c">! IF THE HUNDREDS DIGIT OF IOPTN IS 1 OR 3, SET NSTEP = IWORK(2),</span>
<span class="w">            </span><span class="c">! AND OTHERWISE SET NSTEP TO ITS DEFAULT VALUE OF 1.</span>
<span class="w">            </span><span class="n">iophun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Ioptn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">Ioptn</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iophun</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="p">(</span><span class="n">iophun</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">nstep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">else</span>
<span class="k">                </span><span class="n">nstep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="w">            </span><span class="c">! IF THE HUNDREDS DIGIT OF IOPTN IS 2 OR 3, SET TOLCON = WORK(2),</span>
<span class="w">            </span><span class="c">! AND OTHERWISE SET TOLCON TO ITS DEFAULT VALUE OF SQRT(SPCMN).</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iophun</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">tolcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="n">spcmn</span><span class="p">)</span>
<span class="w">            </span><span class="k">else</span>
<span class="k">                </span><span class="n">tolcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="w">            </span><span class="c">! IN THIS VERSION OF CONMAX WE SET THE LINEAR CONSTRAINT TOLERANCE</span>
<span class="w">            </span><span class="c">! EQUAL TO THE NONLINEAR CONSTRAINT TOLERANCE.</span>
<span class="w">            </span><span class="n">tollin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tolcon</span>

<span class="w">            </span><span class="c">! SET IRK=1 IF THE THOUSANDS DIGIT OF IOPTN IS 0 AND OTHERWISE SET IRK=0.</span>
<span class="w">            </span><span class="n">ioptho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Ioptn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">Ioptn</span><span class="o">/</span><span class="mi">10000</span><span class="p">)</span><span class="o">*</span><span class="mi">10000</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ioptho</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">irk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">else</span>
<span class="k">                </span><span class="n">irk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="k">end if</span>

<span class="w">            </span><span class="c">! COMPUTE THE TEN THOUSANDS DIGIT OF IOPTN FOR LATER USE.</span>
<span class="w">            </span><span class="n">ioptth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Ioptn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">Ioptn</span><span class="o">/</span><span class="mi">100000</span><span class="p">)</span><span class="o">*</span><span class="mi">100000</span><span class="p">)</span><span class="o">/</span><span class="mi">10000</span>

<span class="w">            </span><span class="c">! SET IPHSE=-1 TO INDICATE WE HAVE NOT CHECKED TYPE -1 FEASIBILITY YET.</span>
<span class="w">            </span><span class="n">iphse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">            </span><span class="c">! SET RCHDWN = THE NUMBER OF LENGTHS OF PROJCT IN RKSACT (OR NUMBER OF</span>
<span class="w">            </span><span class="c">! LENGTHS OF BNDLGT IN SETU1) WE WILL GO BELOW ERROR(NUMGR+1) TO DECLARE</span>
<span class="w">            </span><span class="c">! A PRIMARY CONSTRAINT TO BE ACTIVE.</span>
<span class="w">            </span><span class="n">rchdwn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">two</span>
<span class="w">            </span><span class="n">rchdnk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rchdwn</span>
<span class="w">            </span><span class="c">! SET RCHIN = THE NUMBER OF LENGTHS OF PROJCT (OR BNDLGT) WE WILL GO</span>
<span class="w">            </span><span class="c">! BELOW 0.0 TO DECLARE A TYPE -2 CONSTRAINT TO BE ACTIVE.</span>
<span class="w">            </span><span class="n">rchin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">two</span>
<span class="w">            </span><span class="c">! SET A NORMAL VALUE FOR NUMLIM FOR USE IN SLPCON.</span>
<span class="w">            </span><span class="n">numlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">11</span>
<span class="w">        </span><span class="k">end if</span>
<span class="w">        </span><span class="c">! END OF PRELIMINARY SECTION.  THE STATEMENTS ABOVE THIS POINT WILL NOT</span>
<span class="w">        </span><span class="c">! BE EXECUTED AGAIN IN THIS CALL TO CONMAX.</span>

<span class="w">        </span><span class="c">! CALL ERCMP1 WITH ICNUSE=0 TO COMPUTE THE ERRORS, ERROR NORMS, AND ICNTYP.</span>
<span class="w">        </span><span class="c">! WE TAKE IPHSE AS 0 SO ALL CONSTRAINTS WILL BE COMPUTED BY FNSET IN CASE</span>
<span class="w">        </span><span class="c">! THE TEN THOUSANDS DIGIT OF IOPTN IS 1.</span>
<span class="w">        </span><span class="c">! THIS IS ONE OF ONLY TWO PLACES IN THE PROGRAM WHERE WE CALL ERCMP1 WITH</span>
<span class="w">        </span><span class="c">! ICNUSE=0, THE OTHER BEING STATEMENT 1415 BELOW..</span>
<span class="mi">100</span><span class="w">     </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">ercmp1</span><span class="p">(</span><span class="n">Ioptn</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">,</span><span class="w"> </span><span class="n">Fun</span><span class="p">,</span><span class="w"> </span><span class="n">Ifun</span><span class="p">,</span><span class="w"> </span><span class="n">Pttbl</span><span class="p">,</span><span class="w"> </span><span class="n">Iptb</span><span class="p">,</span><span class="w"> </span><span class="n">Indm</span><span class="p">,</span><span class="w"> </span><span class="n">Param</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                       </span><span class="n">Iwork</span><span class="p">,</span><span class="w"> </span><span class="n">Liwrk</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc08</span><span class="p">),</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="n">ilc17</span><span class="p">),</span><span class="w"> </span><span class="n">ipmax</span><span class="p">,</span><span class="w"> </span><span class="n">ismax</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                       </span><span class="n">Error</span><span class="p">)</span>
<span class="w">        </span><span class="c">! IF ITLIM=0 WE RETURN.</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Itlim</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            return</span>
<span class="k">        else</span>
<span class="w">            </span><span class="c">! COMPUTE ITYP2, ITYP1, ITYPM1, AND ITYPM2 AS THE NUMBER OF CONSTRAINTS  OF</span>
<span class="w">            </span><span class="c">! TYPE 2 (I.E. PRIMARY, ABS(FUN(I)-CONFUN(I,1)) &lt;= W) OR 1 (I.E. PRIMARY,</span>
<span class="w">            </span><span class="c">! CONFUN(I,1) &lt;= W) OR -1 (I.E. STANDARD LINEAR, CONFUN(I,1) &lt;= 0.0)</span>
<span class="w">            </span><span class="c">! OR -2 (I.E. STANDARD NONLINEAR) RESPECTIVELY.</span>
<span class="w">            </span><span class="n">ityp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">ityp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">itypm1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">itypm2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="c">! NOTE THAT ARRAYS NOT IN THE CALLING SEQUENCE FOR CONMAX ARE ACCESSED</span>
<span class="w">            </span><span class="c">! THROUGH THEIR LOCATION IN IWORK OR WORK.  CONMAX IS THE ONLY</span>
<span class="w">            </span><span class="c">! SUBROUTINE IN WHICH THIS IS NECESSARY.</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span>
<span class="w">                </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilc17</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span>
<span class="w">                </span><span class="c">! HERE IWORK(II)=ICNTYP(I).</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Iwork</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="n">Iwork</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">itypm2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itypm2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="k">else</span>
<span class="k">                        </span><span class="n">itypm1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itypm1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                else if</span><span class="w"> </span><span class="p">(</span><span class="n">Iwork</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="n">Iwork</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">ityp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ityp1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="k">else</span>
<span class="k">                        </span><span class="n">ityp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ityp2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                end if</span>
<span class="k">            end do</span>
<span class="k">        end if</span>

<span class="w">        </span><span class="c">! COMPUTE THE ERROR NORMS.  ENORM IS THE PRINCIPAL ERROR NORM.</span>
<span class="mi">200</span><span class="w">     </span><span class="n">enorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Error</span><span class="p">(</span><span class="n">Numgr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="n">enor2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Error</span><span class="p">(</span><span class="n">Numgr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">        </span><span class="n">enor3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Error</span><span class="p">(</span><span class="n">Numgr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>

<span class="w">        </span><span class="c">! WRITE ITER, ISUCC, IRK, ENCHG, AND THE ERROR NORMS.</span>
<span class="w">        </span><span class="c">!1050 WRITE(NWRIT,1100) ITER,ISUCC,IRK,ENCHG,ENORM,ENOR2,ENOR3</span>
<span class="w">        </span><span class="c">!     WRITE(9,1100) ITER,ISUCC,IRK,ENCHG,ENORM,ENOR2,ENOR3</span>
<span class="w">        </span><span class="c">!1100 FORMAT(/8H ITER IS,I5,10H  ISUCC IS,I4,8H  IRK IS,I4,</span>
<span class="w">        </span><span class="c">!    *10H  ENCHG IS,E24.14/9H ENORM IS,E24.14,10H  ENOR2 IS,E24.14/</span>
<span class="w">        </span><span class="c">!    *9H ENOR3 IS,E24.14)</span>

<span class="w">        </span><span class="c">! THE NEXT SECTION DETERMINES WHETHER WE WILL TERMINATE DUE TO ITERATION</span>
<span class="w">        </span><span class="c">! COUNT, AND IF SO FOR OUTPUT PURPOSES IT MODIFIES ITER (OR TWO OF THE</span>
<span class="w">        </span><span class="c">! ERROR NORMS IF THE FAILURE IS DUE TO INABILITY TO GAIN TYPE -2</span>
<span class="w">        </span><span class="c">! FEASIBILITY).</span>

<span class="w">        </span><span class="c">! IF IOPTEN=1 AND WE HAVE DONE AT LEAST ONE ITERATION IN THE MAIN PART</span>
<span class="w">        </span><span class="c">! OF CONMAX, WE WILL GIVE UP IF ABS(ENCHG) HAS BEEN LESS THAN ENCSM FOR</span>
<span class="w">        </span><span class="c">! LIMSM CONSECUTIVE MAIN ITERATIONS (INCLUDING THIS ONE).</span>
<span class="mi">300</span><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iopten</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">iphse</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">Iter</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="n">enchg</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">encsm</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">kntsm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kntsm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">kntsm</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">limsm</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                            </span><span class="c">! FOR OUTPUT PURPOSES REPLACE ITER BY ITER + ITLIM - ITLIM1, THE TRUE</span>
<span class="w">                            </span><span class="c">! NUMBER OF ITERATIONS COUNTING INITIALIZATION.  ITLIM - ITLIM1 WILL BE</span>
<span class="w">                            </span><span class="c">! THE NUMBER OF ITERATIONS NEEDED TO GAIN TYPE -2 FEASIBILITY.  WORK</span>
<span class="w">                            </span><span class="c">! DONE TO GAIN TYPE -1 FEASIBILITY IS NOT COUNTED AS AN ITERATION.</span>
<span class="w">                            </span><span class="n">Iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iter</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Itlim</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">itlim1</span>
<span class="w">                            </span><span class="k">return</span>
<span class="k">                        end if</span>
<span class="k">                    else</span>
<span class="k">                        </span><span class="n">kntsm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                end if</span>
<span class="k">            end if</span>
<span class="k">        end if</span>

<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">Iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">itlim1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="w">            </span><span class="c">! HERE ITER &lt; ITLIM1.  IF IPHSE = 0 OR -2 HERE WE GO INTO THE</span>
<span class="w">            </span><span class="c">! ITERATIVE PHASE OF CONMAX.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iphse</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">900</span>

<span class="w">            </span><span class="c">! HERE IPHSE=-1 AND WE CHECK TYPE -1 FEASIBILITY, TRY TO REGAIN IT IF</span>
<span class="w">            </span><span class="c">! WE DONT HAVE IT, CHECK TYPE -2 FEASIBILITY, AND SET UP FOR TYPE -2</span>
<span class="w">            </span><span class="c">! FEASIBILITY ITERATIONS IF WE DONT HAVE IT.  THE STATEMENTS FROM HERE</span>
<span class="w">            </span><span class="c">! DOWN TO THE TRIPLE BLANK LINE WILL BE EXECUTED AT MOST ONCE.</span>

<span class="w">            </span><span class="c">! NOTE THAT ENOR2=0.0 IF THERE ARE NO TYPE -1 CONSTRAINTS.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">enor2</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">tollin</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="w">                </span><span class="c">! HERE WE HAD TYPE -1 FEASIBILITY INITIALLY.</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">enor3</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">tolcon</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">700</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="mi">800</span>
<span class="w">            </span><span class="k">else</span>

<span class="w">                </span><span class="c">! HERE WE DO NOT HAVE TYPE -1 FEASIBILITY SO WE TRY TO GET IT.</span>
<span class="w">                </span><span class="c">! WE WILL NEED TO TELL DERST TO COMPUTE THE VALUES OF THE LEFT SIDES</span>
<span class="w">                </span><span class="c">! OF THE TYPE -1 CONSTRAINTS WITH THE VARIABLES EQUAL TO ZERO (I.E.</span>
<span class="w">                </span><span class="c">! THE CONSTANT TERMS IN THE CONSTRAINTS), SO WE SET PARWRK TO THE</span>
<span class="w">                </span><span class="c">! ZERO VECTOR TO CARRY THE MESSAGE.</span>
<span class="w">                </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span>
<span class="w">                    </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilc27</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span>
<span class="w">                    </span><span class="c">! HERE WORK(JJ) = PARWRK(J).</span>
<span class="w">                    </span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                </span><span class="k">end do</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">ioptth</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="c">! HERE IOPTTH=1 AND WE CALL DERST WITH IPT=-1 TO PUT ALL THE STANDARD</span>
<span class="w">                    </span><span class="c">! CONSTRAINT AND DERIVATIVE VALUES IN CONFUN.</span>
<span class="w">                    </span><span class="c">! WE SET IPT=-1 TO TELL DERST IT NEED ONLY COMPUTE STANDARD CONSTRAINTS.</span>
<span class="w">                    </span><span class="n">ipt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                    </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">derst</span><span class="p">(</span><span class="n">Ioptn</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">,</span><span class="w"> </span><span class="n">Pttbl</span><span class="p">,</span><span class="w"> </span><span class="n">Iptb</span><span class="p">,</span><span class="w"> </span><span class="n">Indm</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc27</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                  </span><span class="n">ipt</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc24</span><span class="p">),</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc35</span><span class="p">),</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="n">ilc22</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                  </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc08</span><span class="p">))</span>
<span class="w">                </span><span class="k">end if</span>

<span class="k">                </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span>
<span class="w">                    </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilc17</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span>
<span class="w">                    </span><span class="c">! HERE WE CONSIDER ONLY TYPE -1 CONSTRAINTS.  THERE MUST BE AT LEAST</span>
<span class="w">                    </span><span class="c">! ONE OF THESE, SINCE OTHERWISE WE WOULD NOT BE HERE ATTEMPTING TO</span>
<span class="w">                    </span><span class="c">! GAIN TYPE -1 FEASIBILITY.</span>
<span class="w">                    </span><span class="c">! HERE IWORK(II)=ICNTYP(I).</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Iwork</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ioptth</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                            </span><span class="c">! HERE IOPTTH=0 AND WE HAVE NOT YET CALLED DERST TO PUT CONSTRAINT I</span>
<span class="w">                            </span><span class="c">! AND ITS DERIVATIVES IN CONFUN, SO WE DO IT NOW.</span>
<span class="w">                            </span><span class="n">ipt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">                            </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">derst</span><span class="p">(</span><span class="n">Ioptn</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">,</span><span class="w"> </span><span class="n">Pttbl</span><span class="p">,</span><span class="w"> </span><span class="n">Iptb</span><span class="p">,</span><span class="w"> </span><span class="n">Indm</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                          </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc27</span><span class="p">),</span><span class="w"> </span><span class="n">ipt</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc24</span><span class="p">),</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc35</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                          </span><span class="n">Iwork</span><span class="p">(</span><span class="n">ilc22</span><span class="p">),</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc08</span><span class="p">))</span>
<span class="w">                        </span><span class="k">end if</span>
<span class="w">                        </span><span class="c">! COPY THE DERIVATIVES INTO PMAT FOR USE BY WOLFE.</span>
<span class="w">                        </span><span class="k">do </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span>
<span class="w">                            </span><span class="n">l1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilc29</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">npar1</span>
<span class="w">                            </span><span class="n">l2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilc08</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">l</span><span class="o">*</span><span class="n">Numgr</span>
<span class="w">                            </span><span class="c">! HERE WORK(L1)=PMAT(L,M) AND WORK(L2)=CONFUN(I,L+1).</span>
<span class="w">                            </span><span class="n">Work</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
<span class="w">                        </span><span class="k">end do</span>

<span class="w">                        </span><span class="c">! NOW THE ITH CONSTRAINT (WHICH IS ALSO THE MTH TYPE -1 CONSTRAINT) HAS</span>
<span class="w">                        </span><span class="c">! THE FORM PMAT(1,M)*Z1+...+PMAT(NPARM,M)*ZNPARM + CONFUN(I,1)  &lt;=</span>
<span class="w">                        </span><span class="c">! 0.0.  WE MAKE THE CHANGE OF VARIABLES ZZ = Z - PARAM TO TRANSLATE THE</span>
<span class="w">                        </span><span class="c">! ORIGIN TO PARAM.  THE ITH CONSTRAINT WILL THEN HAVE THE FORM</span>
<span class="w">                        </span><span class="c">! PMAT(1,M)*ZZ1+...+PMAT(NPARM,M)*ZZNPARM + (CONFUN(I,1) + PMAT(1,M)*</span>
<span class="w">                        </span><span class="c">! PARAM(1)+...+PMAT(NPARM,M)*PARAM(NPARM)) &lt;= 0.0.  AFTER WOLFE FINDS</span>
<span class="w">                        </span><span class="c">! THE CLOSEST POINT TO THE ORIGIN IN THE POLYHEDRON DEFINED BY THE NEW</span>
<span class="w">                        </span><span class="c">! CONSTRAINTS, WE WILL ADD PARAM TO TRANSLATE BACK TO THE POINT WE WANT.</span>
<span class="w">                        </span><span class="n">l1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilc29</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">npar1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">npar1</span>
<span class="w">                        </span><span class="n">l2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilc08</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span>
<span class="w">                        </span><span class="c">! HERE WORK(L1)=PMAT(NPAR1,1) AND WORK(L2)=CONFUN(I,1).</span>
<span class="w">                        </span><span class="n">Work</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
<span class="w">                        </span><span class="k">do </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span>
<span class="w">                            </span><span class="n">l2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilc29</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">npar1</span>
<span class="w">                            </span><span class="c">! HERE WORK(L1)=PMAT(NPAR1,1) AND WORK(L2)=PMAT(L,M).</span>
<span class="w">                            </span><span class="n">Work</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span><span class="o">*</span><span class="n">Param</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="w">                        </span><span class="k">end do</span>
<span class="k">                    end if</span>
<span class="k">                end do</span>
<span class="w">                </span><span class="c">! CALL WOLFE WITH ISTRT=0 TO COMPUTE THE SOLUTION IN THE ZZ COORDINATE</span>
<span class="w">                </span><span class="c">! SYSTEM FROM SCRATCH.</span>
<span class="w">                </span><span class="k">call </span><span class="n">wolfe</span><span class="p">(</span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc29</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">ncor</span><span class="p">,</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="n">ilc15</span><span class="p">),</span><span class="w"> </span><span class="n">Iwork</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">Liwrk</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">,</span><span class="w"> </span><span class="n">Lwrk</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc33</span><span class="p">),</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc06</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc31</span><span class="p">),</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc30</span><span class="p">),</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc40</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc42</span><span class="p">),</span><span class="w"> </span><span class="n">wdist</span><span class="p">,</span><span class="w"> </span><span class="n">nmaj</span><span class="p">,</span><span class="w"> </span><span class="n">nmin</span><span class="p">,</span><span class="w"> </span><span class="n">jflag</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jflag</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">600</span>

<span class="w">                </span><span class="c">! HERE JFLAG &lt;= 0 AND WE PUT PARAM+WPT IN PARWRK TO CHECK WHETHER</span>
<span class="w">                </span><span class="c">! THE TYPE -1 CONSTRAINTS ARE NOW FEASIBLE WITHIN TOLLIN.</span>
<span class="w">                </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span>
<span class="w">                    </span><span class="n">j1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilc27</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span>
<span class="w">                    </span><span class="n">j2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilc42</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span>
<span class="w">                    </span><span class="c">! HERE WORK(J1)=PARWRK(J) AND WORK(J2)=WPT(J).</span>
<span class="w">                    </span><span class="n">Work</span><span class="p">(</span><span class="n">j1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Param</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">j2</span><span class="p">)</span>
<span class="w">                </span><span class="k">end do</span>
<span class="w">                </span><span class="c">! FOR USE IN ERCMP1 WE SET JCNTYP(I)=-1 IF ICNTYP(I)=-1 AND SET</span>
<span class="w">                </span><span class="c">! JCNTYP(I)=0 OTHERWISE.</span>
<span class="w">                </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span>
<span class="w">                    </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilc17</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span>
<span class="w">                    </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilc21</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span>
<span class="w">                    </span><span class="c">! HERE IWORK(II)=ICNTYP(I) AND IWORK(JJ)=JCNTYP(I).</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Iwork</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">Iwork</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                    </span><span class="k">else</span>
<span class="k">                        </span><span class="n">Iwork</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                end do</span>
<span class="w">                </span><span class="c">! CALL ERCMP1 WITH ICNUSE=1.</span>
<span class="w">                </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">ercmp1</span><span class="p">(</span><span class="n">Ioptn</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">,</span><span class="w"> </span><span class="n">Fun</span><span class="p">,</span><span class="w"> </span><span class="n">Ifun</span><span class="p">,</span><span class="w"> </span><span class="n">Pttbl</span><span class="p">,</span><span class="w"> </span><span class="n">Iptb</span><span class="p">,</span><span class="w"> </span><span class="n">Indm</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                               </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc27</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iphse</span><span class="p">,</span><span class="w"> </span><span class="n">Iwork</span><span class="p">,</span><span class="w"> </span><span class="n">Liwrk</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc08</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                               </span><span class="n">Iwork</span><span class="p">(</span><span class="n">ilc21</span><span class="p">),</span><span class="w"> </span><span class="n">ipmax</span><span class="p">,</span><span class="w"> </span><span class="n">ismax</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc11</span><span class="p">))</span>
<span class="w">                </span><span class="n">i1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilc11</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">Numgr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">                </span><span class="c">! HERE WORK(I1)=ERR1(NUMGR+2).</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Work</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">tollin</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">600</span>

<span class="w">                </span><span class="c">! HERE WE HAVE ACHIEVED TYPE -1 FEASIBILITY.  WE REPLACE PARAM WITH</span>
<span class="w">                </span><span class="c">! PARWRK.</span>
<span class="w">                </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span>
<span class="w">                    </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilc27</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span>
<span class="w">                    </span><span class="c">! HERE WORK(JJ)=PARWRK(J).</span>
<span class="w">                    </span><span class="n">Param</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span>
<span class="w">                </span><span class="k">end do</span>
<span class="k">                </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilc11</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Numgr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span>
<span class="w">                </span><span class="c">! HERE WORK(II)=ERR1(NUMGR+2).</span>
<span class="w">                </span><span class="c">!     WRITE(NWRIT,1397)WORK(II),(PARAM(J),J=1,NPARM)</span>
<span class="w">                </span><span class="c">!1397 FORMAT(48H TYPE -1 FEASIBILITY ACHIEVED.  ERR1(NUMGR+2) IS,</span>
<span class="w">                </span><span class="c">!    *E15.5,10H  PARAM IS/(4E20.12))</span>

<span class="w">                </span><span class="c">! IF THERE ARE TYPE -2 CONSTRAINTS, SET JCNTYP AS ICNTYP WITH ALL BUT -2</span>
<span class="w">                </span><span class="c">! VALUES ZEROED OUT AND CALL ERCMP1 WITH ICNUSE=1 TO CHECK TYPE -2</span>
<span class="w">                </span><span class="c">! FEASIBILITY.  WE CANNOT SIMPLY CHECK THE OLD ENOR3 HERE SINCE PARAM HAS</span>
<span class="w">                </span><span class="c">! BEEN CHANGED.  IF THERE ARE NO TYPE -2 CONSTRAINTS WE WILL AUTOMATICALLY</span>
<span class="w">                </span><span class="c">! HAVE TYPE -2 FEASIBILITY.</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">itypm2</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="c">! HERE WE HAVE BOTH TYPE -1 AND TYPE -2 FEASIBILITY, BUT PARAM WAS</span>
<span class="w">                    </span><span class="c">! CHANGED IN GETTING TYPE -1 FEASIBILITY, SO WE CALL ERCMP1</span>
<span class="w">                    </span><span class="c">! WITH ICNUSE=0 (ICNUSE=1 WOULD WORK ALSO SINCE ICNTYP HAS NOT BEEN</span>
<span class="w">                    </span><span class="c">! CHANGED HERE) TO GET THE NEW ERROR VECTOR.</span>
<span class="w">                    </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">ercmp1</span><span class="p">(</span><span class="n">Ioptn</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">,</span><span class="w"> </span><span class="n">Fun</span><span class="p">,</span><span class="w"> </span><span class="n">Ifun</span><span class="p">,</span><span class="w"> </span><span class="n">Pttbl</span><span class="p">,</span><span class="w"> </span><span class="n">Iptb</span><span class="p">,</span><span class="w"> </span><span class="n">Indm</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                   </span><span class="n">Param</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">iphse</span><span class="p">,</span><span class="w"> </span><span class="n">Iwork</span><span class="p">,</span><span class="w"> </span><span class="n">Liwrk</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc08</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                   </span><span class="n">Iwork</span><span class="p">(</span><span class="n">ilc17</span><span class="p">),</span><span class="w"> </span><span class="n">ipmax</span><span class="p">,</span><span class="w"> </span><span class="n">ismax</span><span class="p">,</span><span class="w"> </span><span class="n">Error</span><span class="p">)</span>
<span class="w">                    </span><span class="k">goto</span><span class="w"> </span><span class="mi">800</span>
<span class="w">                </span><span class="k">else</span>
<span class="k">                    do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span>
<span class="w">                        </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilc17</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span>
<span class="w">                        </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilc21</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span>
<span class="w">                        </span><span class="c">! HERE IWORK(II)=ICNTYP(I) AND IWORK(JJ)=JCNTYP(I).</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Iwork</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            </span><span class="n">Iwork</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span>
<span class="w">                        </span><span class="k">else</span>
<span class="k">                            </span><span class="n">Iwork</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                        </span><span class="k">end if</span>
<span class="k">                    end do</span>
<span class="k">                    call </span><span class="n">me</span><span class="p">%</span><span class="n">ercmp1</span><span class="p">(</span><span class="n">Ioptn</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">,</span><span class="w"> </span><span class="n">Fun</span><span class="p">,</span><span class="w"> </span><span class="n">Ifun</span><span class="p">,</span><span class="w"> </span><span class="n">Pttbl</span><span class="p">,</span><span class="w"> </span><span class="n">Iptb</span><span class="p">,</span><span class="w"> </span><span class="n">Indm</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                   </span><span class="n">Param</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iphse</span><span class="p">,</span><span class="w"> </span><span class="n">Iwork</span><span class="p">,</span><span class="w"> </span><span class="n">Liwrk</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc08</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                   </span><span class="n">Iwork</span><span class="p">(</span><span class="n">ilc21</span><span class="p">),</span><span class="w"> </span><span class="n">ipmax</span><span class="p">,</span><span class="w"> </span><span class="n">ismax</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc11</span><span class="p">))</span>
<span class="w">                    </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilc11</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Numgr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span>
<span class="w">                    </span><span class="c">! HERE WORK(II)=ERR1(NUMGR+3).</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Work</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">tolcon</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">700</span>
<span class="w">                    </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">ercmp1</span><span class="p">(</span><span class="n">Ioptn</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">,</span><span class="w"> </span><span class="n">Fun</span><span class="p">,</span><span class="w"> </span><span class="n">Ifun</span><span class="p">,</span><span class="w"> </span><span class="n">Pttbl</span><span class="p">,</span><span class="w"> </span><span class="n">Iptb</span><span class="p">,</span><span class="w"> </span><span class="n">Indm</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                   </span><span class="n">Param</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">iphse</span><span class="p">,</span><span class="w"> </span><span class="n">Iwork</span><span class="p">,</span><span class="w"> </span><span class="n">Liwrk</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc08</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                   </span><span class="n">Iwork</span><span class="p">(</span><span class="n">ilc17</span><span class="p">),</span><span class="w"> </span><span class="n">ipmax</span><span class="p">,</span><span class="w"> </span><span class="n">ismax</span><span class="p">,</span><span class="w"> </span><span class="n">Error</span><span class="p">)</span>
<span class="w">                    </span><span class="k">goto</span><span class="w"> </span><span class="mi">800</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end if</span>

<span class="w">            </span><span class="c">! HERE ITER = ITLIM1, SO WE RETURN.</span>
<span class="w">        </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">iphse</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">Iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iter</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Itlim</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">itlim1</span>
<span class="w">            </span><span class="k">return</span>
<span class="k">        end if</span>

<span class="w">        </span><span class="c">! HERE WE HAVE FAILED TO ACHIEVE TYPE -2 FEASIBILITY AND WE SET ITER=-2</span>
<span class="w">        </span><span class="c">! AS A WARNING, PUT ERROR(NUMGR+1) IN ITS PROPER LOCATION, SET</span>
<span class="w">        </span><span class="c">! ERROR(NUMGR+1) = 0.0 SINCE THE PRIMARY CONSTRAINTS WERE NOT COMPUTED,</span>
<span class="w">        </span><span class="c">! AND RETURN.  NOTE THAT WE CANNOT HAVE IPHSE=-1 HERE SINCE THAT WOULD</span>
<span class="w">        </span><span class="c">! IMPLY ITER=0, THUS ITLIM=ITLIM1=0, IN WHICH CASE WE WOULD HAVE</span>
<span class="w">        </span><span class="c">! TERMINATED EARLIER.</span>
<span class="mi">400</span><span class="w">     </span><span class="n">Iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span>
<span class="w">        </span><span class="n">Error</span><span class="p">(</span><span class="n">Numgr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Error</span><span class="p">(</span><span class="n">Numgr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="n">Error</span><span class="p">(</span><span class="n">Numgr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">        </span><span class="c">! write(nwrit,&#39;(A)&#39;) &#39;***WARNING  NONLINEAR STANDARD FEASIBILITY NOT ACHIEVED***&#39;</span>
<span class="w">        </span><span class="k">return</span>

<span class="w">        </span><span class="c">! HERE WE HAVE FAILED TO ACHIEVE TYPE -1 FEASIBILITY.  WE SET ITER=-1</span>
<span class="w">        </span><span class="c">! AS A WARNING AND RETURN.</span>
<span class="mi">600</span><span class="w">     </span><span class="n">Iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">        </span><span class="c">! WRITE(NWRIT,&#39;(A)&#39;) &#39;***WARNING  LINEAR STANDARD FEASIBILITY NOT ACHIEVED***&#39;</span>
<span class="w">        </span><span class="k">return</span>

<span class="w">        </span><span class="c">! HERE WE HAVE TYPE -1 FEASIBILITY BUT NOT TYPE -2 FEASIBILITY.  WE SET</span>
<span class="w">        </span><span class="c">! UP FOR THE TYPE -2 FEASIBILITY ITERATIONS, IN WHICH TYPE 1 AND TYPE</span>
<span class="w">        </span><span class="c">! 2 CONSTRAINTS ARE IGNORED AND TYPE -2 CONSTRAINTS ARE TREATED AS</span>
<span class="w">        </span><span class="c">! TYPE 1 CONSTRAINTS, EXCEPT WE WILL SWITCH OVER TO NORMAL ITERATIONS</span>
<span class="w">        </span><span class="c">! ONCE WE CAN FORCE W &lt;= TOLCON.  THUS WE SET THE INDICATOR IPHSE TO</span>
<span class="w">        </span><span class="c">! -2, RESET ICNTYP(I) TO 1 IF IT WAS -2, LEAVE IT AT -1 IF IT WAS -1,</span>
<span class="w">        </span><span class="c">! AND SET IT TO 0 OTHERWISE, RESET ITYP2, ITYP1, AND ITYPM2, AND CALL</span>
<span class="w">        </span><span class="c">! ERCMP1 WITH ICNUSE=1 TO PUT THE PROPER VALUES IN ERROR.</span>
<span class="mi">700</span><span class="w">     </span><span class="n">iphse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span>
<span class="w">        </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span>
<span class="w">            </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilc17</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span>
<span class="w">            </span><span class="c">! HERE IWORK(II)=ICNTYP(I).</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Iwork</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">Iwork</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">Iwork</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">Iwork</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">        end do</span>
<span class="w">        </span><span class="c">! SAVE ITYP2 AND ITYP1.</span>
<span class="w">        </span><span class="n">ityp2k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ityp2</span>
<span class="w">        </span><span class="n">ityp1k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ityp1</span>
<span class="w">        </span><span class="n">ityp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">ityp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itypm2</span>
<span class="w">        </span><span class="n">itypm2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">ercmp1</span><span class="p">(</span><span class="n">Ioptn</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">,</span><span class="w"> </span><span class="n">Fun</span><span class="p">,</span><span class="w"> </span><span class="n">Ifun</span><span class="p">,</span><span class="w"> </span><span class="n">Pttbl</span><span class="p">,</span><span class="w"> </span><span class="n">Iptb</span><span class="p">,</span><span class="w"> </span><span class="n">Indm</span><span class="p">,</span><span class="w"> </span><span class="n">Param</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                       </span><span class="n">iphse</span><span class="p">,</span><span class="w"> </span><span class="n">Iwork</span><span class="p">,</span><span class="w"> </span><span class="n">Liwrk</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc08</span><span class="p">),</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="n">ilc17</span><span class="p">),</span><span class="w"> </span><span class="n">ipmax</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                       </span><span class="n">ismax</span><span class="p">,</span><span class="w"> </span><span class="n">Error</span><span class="p">)</span>
<span class="w">        </span><span class="k">goto</span><span class="w"> </span><span class="mi">900</span>

<span class="w">        </span><span class="c">! HERE WE HAVE BOTH TYPE -1 AND TYPE -2 FEASIBILITY, AND WE</span>
<span class="w">        </span><span class="c">! SET IPHSE=0 AND GO INTO THE MAIN PART OF CONMAX (UNLESS THERE WERE</span>
<span class="w">        </span><span class="c">! NO TYPE 1 OR TYPE 2 CONSTRAINTS, IN WHICH CASE WE RETURN).</span>
<span class="mi">800</span><span class="w">     </span><span class="n">iphse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ityp1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ityp2</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span>

<span class="w">        </span><span class="c">! END OF INITIAL FEASIBILITY CHECKING, TYPE -1 FEASIBILITY WORK, AND</span>
<span class="w">        </span><span class="c">! TYPE -2 SETUP.  THE BLOCK OF STATEMENTS FROM HERE UP TO THE</span>
<span class="w">        </span><span class="c">! PRECEDING DOUBLE BLANK LINE WILL NOT BE EXECUTED AGAIN.</span>

<span class="mi">900</span><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">irk</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! HERE IRK IS 0 OR -1 AND WE DO AN SLP STEP.  IF SLPCON CANNOT REDUCE THE</span>
<span class="w">            </span><span class="c">! PRINCIPAL ERROR NORM ENORM = ERROR(NUMGR+1) BY MORE THAN 100.0*B**(-ITT)</span>
<span class="w">            </span><span class="c">! THEN IT WILL LEAVE PARAM AND ERROR UNCHANGED.</span>
<span class="w">            </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">slpcon</span><span class="p">(</span><span class="n">Ioptn</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">,</span><span class="w"> </span><span class="n">Fun</span><span class="p">,</span><span class="w"> </span><span class="n">Ifun</span><span class="p">,</span><span class="w"> </span><span class="n">Pttbl</span><span class="p">,</span><span class="w"> </span><span class="n">Iptb</span><span class="p">,</span><span class="w"> </span><span class="n">Indm</span><span class="p">,</span><span class="w"> </span><span class="n">tolcon</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">rchin</span><span class="p">,</span><span class="w"> </span><span class="n">irk</span><span class="p">,</span><span class="w"> </span><span class="n">itypm1</span><span class="p">,</span><span class="w"> </span><span class="n">itypm2</span><span class="p">,</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="n">ilc17</span><span class="p">),</span><span class="w"> </span><span class="n">rchdwn</span><span class="p">,</span><span class="w"> </span><span class="n">numlim</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">itersl</span><span class="p">,</span><span class="w"> </span><span class="n">prjslp</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc12</span><span class="p">),</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="n">ilc20</span><span class="p">),</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc44</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">mact1</span><span class="p">,</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="n">ilc14</span><span class="p">),</span><span class="w"> </span><span class="n">Iwork</span><span class="p">(</span><span class="n">ilc21</span><span class="p">),</span><span class="w"> </span><span class="n">iphse</span><span class="p">,</span><span class="w"> </span><span class="n">enchg</span><span class="p">,</span><span class="w"> </span><span class="n">Iwork</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">Liwrk</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">,</span><span class="w"> </span><span class="n">Lwrk</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc26</span><span class="p">),</span><span class="w"> </span><span class="n">isucc</span><span class="p">,</span><span class="w"> </span><span class="n">Param</span><span class="p">,</span><span class="w"> </span><span class="n">Error</span><span class="p">)</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span><span class="c">! HERE IRK IS 1 OR 2 AND WE DO AN RK STEP.  IF RKCON CANNOT REDUCE THE</span>
<span class="w">            </span><span class="c">! PRINCIPAL ERROR NORM ENORM = ERROR(NUMGR+1) BY MORE THAN 100.0*B**(-ITT)</span>
<span class="w">            </span><span class="c">! THEN IT WILL LEAVE PARAM AND ERROR UNCHANGED.</span>
<span class="w">            </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">rkcon</span><span class="p">(</span><span class="n">Ioptn</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">,</span><span class="w"> </span><span class="n">Fun</span><span class="p">,</span><span class="w"> </span><span class="n">Ifun</span><span class="p">,</span><span class="w"> </span><span class="n">Pttbl</span><span class="p">,</span><span class="w"> </span><span class="n">Iptb</span><span class="p">,</span><span class="w"> </span><span class="n">Indm</span><span class="p">,</span><span class="w"> </span><span class="n">tolcon</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                          </span><span class="n">rchin</span><span class="p">,</span><span class="w"> </span><span class="n">Iter</span><span class="p">,</span><span class="w"> </span><span class="n">irk</span><span class="p">,</span><span class="w"> </span><span class="n">ityp2</span><span class="p">,</span><span class="w"> </span><span class="n">ityp1</span><span class="p">,</span><span class="w"> </span><span class="n">itypm1</span><span class="p">,</span><span class="w"> </span><span class="n">itypm2</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                          </span><span class="n">Iwork</span><span class="p">(</span><span class="n">ilc17</span><span class="p">),</span><span class="w"> </span><span class="n">projct</span><span class="p">,</span><span class="w"> </span><span class="n">rchdwn</span><span class="p">,</span><span class="w"> </span><span class="n">nstep</span><span class="p">,</span><span class="w"> </span><span class="n">iphse</span><span class="p">,</span><span class="w"> </span><span class="n">enchg</span><span class="p">,</span><span class="w"> </span><span class="n">enc1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                          </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc29</span><span class="p">),</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc12</span><span class="p">),</span><span class="w"> </span><span class="n">Iwork</span><span class="p">,</span><span class="w"> </span><span class="n">Liwrk</span><span class="p">,</span><span class="w"> </span><span class="n">Work</span><span class="p">,</span><span class="w"> </span><span class="n">Lwrk</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                          </span><span class="n">Iwork</span><span class="p">(</span><span class="n">ilc13</span><span class="p">),</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc02</span><span class="p">),</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc25</span><span class="p">),</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc26</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                          </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc46</span><span class="p">),</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc11</span><span class="p">),</span><span class="w"> </span><span class="n">Work</span><span class="p">(</span><span class="n">ilc08</span><span class="p">),</span><span class="w"> </span><span class="n">isucc</span><span class="p">,</span><span class="w"> </span><span class="n">Param</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                          </span><span class="n">Error</span><span class="p">)</span>
<span class="w">        </span><span class="k">end if</span>

<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">isucc</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! HERE THE RK OR SLP STEP REDUCED ERROR(NUMGR+1) BY MORE THAN</span>
<span class="w">            </span><span class="c">! 100.0*B**(-ITT), AND WE INCREMENT ITER.</span>
<span class="w">            </span><span class="n">Iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iter</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>

<span class="w">            </span><span class="c">! IF EITHER IPHSE=0, OR IPHSE=-2 AND ERROR(NUMGR+1) &gt; TOLCON, WE GO</span>
<span class="w">            </span><span class="c">! ON AS USUAL TO SET UP ANOTHER STEP WITH THE SAME IPHSE.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iphse</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">Error</span><span class="p">(</span><span class="n">Numgr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">tolcon</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="c">! HERE IPHSE=-2 AND ERROR(NUMGR+1) &lt;= TOLCON, SO WE HAVE JUST ACHIEVED</span>
<span class="w">                    </span><span class="c">! TYPE -2 FEASIBILITY.  WE WILL SET IPHSE=0, AND IF THERE ARE ANY</span>
<span class="w">                    </span><span class="c">! PRIMARY CONSTRAINTS WE WILL RESET ITER, ITERSL, AND ITLIM1 (SINCE</span>
<span class="w">                    </span><span class="c">! ITER=0 AND ITERSL=0 HAVE MEANINGS TO RKCON AND SLPCON RESPECTIVELY),</span>
<span class="w">                    </span><span class="c">! RESET RCHIN AND RCHDWN, AND GO BACK TO THE FIRST ERCMP1 CALL TO</span>
<span class="w">                    </span><span class="c">! RESTORE ERROR AND ICNTYP (ITYP1, ITYP2, ITYPM1, AND ITYPM2 WILL ALSO</span>
<span class="w">                    </span><span class="c">! BE RESTORED).</span>
<span class="w">                    </span><span class="n">iphse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ityp1k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ityp2k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span>
<span class="k">                    </span><span class="n">itlim1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Itlim</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Iter</span>
<span class="w">                    </span><span class="n">Iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                    </span><span class="n">itersl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                    </span><span class="n">rchin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rchdwn</span>
<span class="w">                    </span><span class="n">rchdwn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rchdnk</span>
<span class="w">                    </span><span class="k">goto</span><span class="w"> </span><span class="mi">100</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end if</span>

<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">irk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="c">! HERE WE HAD AN SLP SUCCESS AND WE ARE GOING TO TRY RK AGAIN, SO WE SET</span>
<span class="w">                </span><span class="c">! IRK=2 TO WARN RKCON THAT THE SUCCESS CAME FROM SLP.</span>
<span class="w">                </span><span class="n">irk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">            </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">irk</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="c">! HERE IRK IS 1 OR 2, SO WE JUST HAD AN RK SUCCESS.  WE RESET IRK AND</span>
<span class="w">                </span><span class="c">! ITERSL.</span>
<span class="w">                </span><span class="n">irk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                </span><span class="n">itersl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="mi">200</span>
<span class="w">            </span><span class="k">end if</span>
<span class="w">            </span><span class="c">! HERE WE HAD AN SLP SUCCESS AND WE INCREMENT ITERSL = THE NUMBER OF SLP</span>
<span class="w">            </span><span class="c">! SUCCESSES SINCE THE LAST SUCCESSFUL RK STEP (IF ANY).  ITERSL IS NEEDED</span>
<span class="w">            </span><span class="c">! IN SUBROUTINE BNDSET (CALLED BY SLPCON).</span>
<span class="w">            </span><span class="n">itersl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itersl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">goto</span><span class="w"> </span><span class="mi">200</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span><span class="c">! HERE RKCON OR SLPCON FAILED TO SIGNIFICANTLY REDUCE THE PRINCIPAL ERROR</span>
<span class="w">            </span><span class="c">! NORM.  IF WE JUST TRIED SLP WE QUIT, AND IF WE JUST TRIED RK WE ATTEMPT</span>
<span class="w">            </span><span class="c">! AN SLP STEP UNLESS IOPTHO = 2, IN WHICH CASE WE QUIT.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">irk</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">ioptho</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">irk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                    </span><span class="k">goto</span><span class="w"> </span><span class="mi">300</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end if</span>

<span class="w">            </span><span class="c">! IF IPHSE=-2 HERE WE WILL SET ITER=-2 AS A WARNING AND CHANGE</span>
<span class="w">            </span><span class="c">! ERROR(NUMGR+1) AND ERROR(NUMGR+3) BEFORE RETURNING.  OTHERWISE WE WILL</span>
<span class="w">            </span><span class="c">! HAVE IPHSE=0 AND WE WILL ADJUST ITER BEFORE RETURNING.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iphse</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">400</span>
<span class="w">            </span><span class="n">Iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iter</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Itlim</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">itlim1</span>
<span class="w">        </span><span class="k">end if</span>

<span class="k">    end subroutine </span><span class="n">conmax</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              conmax
 was developed by Jacob Williams<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>