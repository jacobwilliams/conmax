<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="CONMAX -- General nonlinearly constrained function minimization">
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>slnpro &ndash; conmax</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">conmax </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../sourcefile/conmax.f90.html">Source File</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>slnpro
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title="11.9% of total for procedures.">407 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/conmax.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/conmax.f90.html'>conmax.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/conmax_module.html'>conmax_module</a></li>
            <li class="breadcrumb-item active" aria-current="page">slnpro</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/slnpro.html#src">slnpro</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine slnpro(v, m, n, Iyrct, y, Ixrct, Iycct, Nparm, Numgr, x, Indic)  
</h2>
    

    <p>This subroutine solves the linear programming problem</p>
<div class="codehilite"><pre><span></span><code><span class="w">     </span><span class="n">maximize</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-...-</span><span class="n">v</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">     </span><span class="n">where</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="o">...</span><span class="p">,</span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">free</span><span class="w"> </span><span class="n">variables</span><span class="p">,</span><span class="w"> </span><span class="n">subject</span><span class="w"> </span><span class="n">to</span>
<span class="w">     </span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+...+</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="o">..</span><span class="p">,</span><span class="n">m</span><span class="p">,</span>
<span class="w">     </span><span class="n">where</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">n</span><span class="o">.</span>
</code></pre></div>

<p>(information concerning tolerances and basic variables
   is also transmitted using m, n, and iyrct.)</p>
<p>given integers m and n (with m &gt;= n) and a matrix v,
  this subroutine solves the linear programming problem</p>
<div class="codehilite"><pre><span></span><code>     maximize z=-v(m+1,1)x(1)-...-v(m+1,n)x(n)+v(m+1,n+1)
</code></pre></div>

<p>subject to the constraints</p>
<div class="codehilite"><pre><span></span><code>     v(i,1)x(1)+...+v(i,n)x(n) &lt;= v(i,n+1), i=1,...,m
</code></pre></div>

<p>using essentially the method in the book by avdeyeva and
  zukhovitskiy.  y(i)=-v(i,1)x(1)-...-v(i,n)x(n)+v(i,n+1),
  i=1,...,m are slack variables.  the method has 4 phases.</p>
<p>first, xs are exchanged for ys to get a problem
  involving only nonnegative variables, the ys being
  selected in the order determined by iyrct and a pivoting
  strategy.  at the beginning of this routine we must have
  iyrct(1) nonpositive, or iyrct must contain some
  permutation of the integers 1,...,m (see below).
  second, the slack constants of the dual problem are made
  (significantly) nonnegative.
  third, the cost coefficients of the dual problem are made
  (significantly) nonnegative.
  finally, the solution vector is computed.</p>
<p>the variable indic will be given value:</p>
<ul>
<li>0, if a solution was found normally</li>
<li>1, if there was trouble in phase 1</li>
<li>2, if there was trouble in phase 2 (either round off
    error, or the original problem was inconsistent or
    unbounded)</li>
<li>3, if there was trouble in phase 3 (either round off
    error, or the original constraints were inconsistent)</li>
<li>4, if limjor modified jordan eliminations were used in
    phases 2 and 3</li>
<li>-1, if a solution was found but in order to overcome
    trouble in phase 2 or 3 it was necessary to temporarily
    relax the restriction on division by numbers with small
    absolute value.  thus there is an increased chance of
    serious roundoff error in the results.</li>
<li>-2, if a solution was found normally, except that
    the parameters rea and rea1 were increased by a signal
    from the calling program (namely, m=-m).  the increased
    tolerances may have allowed more error than usual.</li>
<li>-3, if in order to complete phase 1 it was necessary to
    temporarily relax the restriction on division by numbers
    with small absolute value.  thus there is an increased
    chance of serious roundoff error in the results.</li>
<li>-4, if a solution was found normally, except that rea and rea1
    were decreased by a signal from the calling program (namely
    n=-n) in order to try for more accuracy.  this increases the
    chances of serious roundoff error in the results.</li>
</ul>
<p>note that indic=-3 will overwrite (and thus conceal) indic=-2
    or indic=-4, and indic=-1 will overwrite indic=-2, -3, or -4</p>
<h3>Reference</h3>
<ul>
<li>Avdeyeva, L. I. and Zukhovitskiy, S. I.,
    "Linear and convex programming",
    Saunders, Philadelphia, 1966.</li>
</ul>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-v~3"></span>
              real(kind=wp)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>v</strong>(Numgr+2*Nparm+1,Nparm+2)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-m~4"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>m</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iyrct~3"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Iyrct</strong>(Numgr+2*Nparm)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-y"></span>
              real(kind=wp)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>y</strong>(Numgr+2*Nparm)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ixrct"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ixrct</strong>(Numgr+2*Nparm)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iycct"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Iycct</strong>(Nparm+1)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nparm~7"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Nparm</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-numgr~6"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Numgr</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~3"></span>
              real(kind=wp)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>x</strong>(Nparm+1)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-indic"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Indic</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~slnpro~~CallsGraph Pages: 1 -->
<svg id="procslnproCallsGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~slnpro~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~slnpro~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~slnpro -->
<g id="proc~~slnpro~~CallsGraph_node1" class="node">
<title>proc~slnpro</title>
<polygon fill="none" stroke="black" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">slnpro</text>
</g>
<!-- proc~sjelim -->
<g id="proc~~slnpro~~CallsGraph_node2" class="node">
<title>proc~sjelim</title>
<g id="a_proc~~slnpro~~CallsGraph_node2"><a xlink:href="../proc/sjelim.html" xlink:title="sjelim">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-24 90,-24 90,0 144,0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sjelim</text>
</a>
</g>
</g>
<!-- proc~slnpro&#45;&gt;proc~sjelim -->
<g id="proc~~slnpro~~CallsGraph_edge1" class="edge">
<title>proc~slnpro&#45;&gt;proc~sjelim</title>
<path fill="none" stroke="#000000" d="M54.4,-12C62.39,-12 71.31,-12 79.82,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.92,-15.5 89.92,-12 79.92,-8.5 79.92,-15.5"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Called by</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~slnpro~~CalledByGraph Pages: 1 -->
<svg id="procslnproCalledByGraph" width="416pt" height="32pt"
 viewBox="0.00 0.00 416.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~slnpro~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~slnpro~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 412,-28 412,4 -4,4"/>
<!-- proc~slnpro -->
<g id="proc~~slnpro~~CalledByGraph_node1" class="node">
<title>proc~slnpro</title>
<polygon fill="none" stroke="black" points="408,-24 354,-24 354,0 408,0 408,-24"/>
<text text-anchor="middle" x="381" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">slnpro</text>
</g>
<!-- proc~slpcon -->
<g id="proc~~slnpro~~CalledByGraph_node2" class="node">
<title>proc~slpcon</title>
<g id="a_proc~~slnpro~~CalledByGraph_node2"><a xlink:href="../proc/slpcon.html" xlink:title="conmax_solver%slpcon">
<polygon fill="#d9534f" stroke="#d9534f" points="318,-24 181,-24 181,0 318,0 318,-24"/>
<text text-anchor="middle" x="249.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmax_solver%slpcon</text>
</a>
</g>
</g>
<!-- proc~slpcon&#45;&gt;proc~slnpro -->
<g id="proc~~slnpro~~CalledByGraph_edge1" class="edge">
<title>proc~slpcon&#45;&gt;proc~slnpro</title>
<path fill="none" stroke="#000000" d="M318.28,-12C327.05,-12 335.74,-12 343.71,-12"/>
<polygon fill="#000000" stroke="#000000" points="343.73,-15.5 353.73,-12 343.73,-8.5 343.73,-15.5"/>
</g>
<!-- proc~conmax -->
<g id="proc~~slnpro~~CalledByGraph_node3" class="node">
<title>proc~conmax</title>
<g id="a_proc~~slnpro~~CalledByGraph_node3"><a xlink:href="../proc/conmax.html" xlink:title="conmax_solver%conmax">
<polygon fill="#d9534f" stroke="#d9534f" points="145,-24 0,-24 0,0 145,0 145,-24"/>
<text text-anchor="middle" x="72.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmax_solver%conmax</text>
</a>
</g>
</g>
<!-- proc~conmax&#45;&gt;proc~slpcon -->
<g id="proc~~slnpro~~CalledByGraph_edge2" class="edge">
<title>proc~conmax&#45;&gt;proc~slpcon</title>
<path fill="none" stroke="#000000" d="M145.18,-12C153.57,-12 162.16,-12 170.63,-12"/>
<polygon fill="#000000" stroke="#000000" points="170.87,-15.5 180.87,-12 170.87,-8.5 170.87,-15.5"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">    </span><span class="k">subroutine </span><span class="n">slnpro</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">Iyrct</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">Ixrct</span><span class="p">,</span><span class="w"> </span><span class="n">Iycct</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">Indic</span><span class="p">)</span>

<span class="w">        </span><span class="k">implicit none</span>

<span class="k">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Nparm</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Numgr</span>
<span class="w">        </span><span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span>
<span class="w">        </span><span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">Indic</span>
<span class="w">        </span><span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">Iyrct</span><span class="p">(</span><span class="n">Numgr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">Nparm</span><span class="p">)</span>
<span class="w">        </span><span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">Ixrct</span><span class="p">(</span><span class="n">Numgr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">Nparm</span><span class="p">)</span>
<span class="w">        </span><span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">Iycct</span><span class="p">(</span><span class="n">Nparm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">Nparm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">Numgr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">Nparm</span><span class="p">)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">Numgr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">Nparm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>

<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">absv</span><span class="p">,</span><span class="w"> </span><span class="nb">amax</span><span class="p">,</span><span class="w"> </span><span class="nb">amin</span><span class="p">,</span><span class="w"> </span><span class="n">ampr2</span><span class="p">,</span><span class="w"> </span><span class="n">amprv</span><span class="p">,</span><span class="w"> </span><span class="n">bmpr2</span><span class="p">,</span><span class="w"> </span><span class="n">bmprv</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">dist</span><span class="p">,</span><span class="w"> </span><span class="n">dist1</span><span class="p">,</span><span class="w"> </span><span class="n">rea</span><span class="p">,</span><span class="w"> </span><span class="n">rea1</span><span class="p">,</span><span class="w"> </span><span class="n">rea2</span><span class="p">,</span><span class="w"> </span><span class="n">rea3</span><span class="p">,</span><span class="w"> </span><span class="n">reakp</span><span class="p">,</span><span class="w"> </span><span class="n">rowq</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">rtcol</span><span class="p">,</span><span class="w"> </span><span class="n">temp</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">i1</span><span class="p">,</span><span class="w"> </span><span class="n">i10</span><span class="p">,</span><span class="w"> </span><span class="n">i2</span><span class="p">,</span><span class="w"> </span><span class="n">i20</span><span class="p">,</span><span class="w"> </span><span class="n">iback</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">ifail</span><span class="p">,</span><span class="w"> </span><span class="n">ii</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">inamp</span><span class="p">,</span><span class="w"> </span><span class="n">indst</span><span class="p">,</span><span class="w"> </span><span class="n">irlax</span><span class="p">,</span><span class="w"> </span><span class="n">irow</span><span class="p">,</span><span class="w"> </span><span class="n">itemp</span><span class="p">,</span><span class="w"> </span><span class="n">ixrj</span><span class="p">,</span><span class="w"> </span><span class="n">iycj</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">iyri</span><span class="p">,</span><span class="w"> </span><span class="n">iytmp</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">jj</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">keep</span><span class="p">,</span><span class="w"> </span><span class="n">keep1</span><span class="p">,</span><span class="w"> </span><span class="n">kkk</span><span class="p">,</span><span class="w"> </span><span class="n">kpmp1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                   </span><span class="n">kpmp2</span><span class="p">,</span><span class="w"> </span><span class="n">ktjor</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">limjor</span><span class="p">,</span><span class="w"> </span><span class="n">ll</span><span class="p">,</span><span class="w"> </span><span class="n">lrknt</span><span class="p">,</span><span class="w"> </span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">mxrkn</span><span class="p">,</span><span class="w"> </span><span class="n">np1</span>

<span class="w">        </span><span class="c">! SET MACHINE DEPENDENT PARAMETERS FOR SUBROUTINE SLNPRO.</span>
<span class="w">        </span><span class="c">! SET SPCMN=B**(-ITT), WHERE B IS THE BASE AND ITT IS THE NUMBER</span>
<span class="w">        </span><span class="c">! OF BASE B DIGITS IN THE MANTISSA.  SPCMN IS THE MINIMUM</span>
<span class="w">        </span><span class="c">! RELATIVE SPACING ABS((X1-X2)/X2) BETWEEN TWO SUCCESSIVE</span>
<span class="w">        </span><span class="c">! FLOATING POINT NUMBERS, SO IT IS THE SPACING BETWEEN TWO</span>
<span class="w">        </span><span class="c">! SUCCESSIVE FLOATING POINT NUMBERS IN THE CLOSED INTERVAL</span>
<span class="w">        </span><span class="c">! (0.1,1.0).  WE ALSO HAVE SPCMN=10.0**(-ITT*(LOG10)(B))=</span>
<span class="w">        </span><span class="c">! 10.0**(-TNMAN), WHERE TNMAN IS THE BASE 10 EQUIVALENT OF</span>
<span class="w">        </span><span class="c">! THE LENGTH OF THE MANTISSA.</span>

<span class="w">        </span><span class="c">! SET REA (ROUND OFF ERROR ADJUSTMENT) =</span>
<span class="w">        </span><span class="c">! MAX(10.0**(-8),100.0*SPCMN).  THUS REA=10.0**(-EXREA),</span>
<span class="w">        </span><span class="c">! WHERE EXREA=MIN(8,TNMAN-2).</span>
<span class="w">        </span><span class="c">! DIVISION BY NUMBERS &lt;= REA IN ABSOLUTE VALUE WILL NOT BE</span>
<span class="w">        </span><span class="c">! PERMITTED.</span>
<span class="w">        </span><span class="n">rea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ten</span><span class="o">*</span><span class="n">ten</span><span class="o">*</span><span class="n">spcmn</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rea</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ten</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">))</span><span class="w"> </span><span class="n">rea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ten</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span>
<span class="w">        </span><span class="c">! SET REA1=10.0*SPCMN.  THUS REA1=10.0**(-(TNMAN-1)).</span>
<span class="w">        </span><span class="c">! NUMBERS IN ROW M+1 OR COLUMN N+1 WHICH ARE &lt;= REA1 IN</span>
<span class="w">        </span><span class="c">! ABSOLUTE VALUE WILL BE TREATED AS ZEROES.  SLNPRO ASSUMES</span>
<span class="w">        </span><span class="c">! THAT 0.0 &lt; REA1 &lt;= REA.</span>
<span class="w">        </span><span class="n">rea1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ten</span><span class="o">*</span><span class="n">spcmn</span>
<span class="w">        </span><span class="c">! END OF INITIAL SETTING OF MACHINE DEPENDENT PARAMETERS FOR</span>
<span class="w">        </span><span class="c">! SLNPRO.  THESE PARAMETERS MAY BE ADJUSTED BY A COMMAND FROM</span>
<span class="w">        </span><span class="c">! THE CALLING PROGRAM.</span>

<span class="w">        </span><span class="n">Indic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">limjor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">300</span>
<span class="w">        </span><span class="c">! M BEING NEGATIVE IS A SIGNAL TO INCREASE REA AND REA1,</span>
<span class="w">        </span><span class="c">! THUS TREATING MORE NUMBERS WITH SMALL ABSOLUTE VALUES AS</span>
<span class="w">        </span><span class="c">! ZEROES.  THIS MAY GIVE THIS ROUTINE A BETTER CHANCE TO</span>
<span class="w">        </span><span class="c">! SUCCEED, BUT MAY ALSO CAUSE LARGER ERRORS.</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! RESET M.</span>
<span class="w">            </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">m</span>
<span class="w">            </span><span class="n">rea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="n">rea</span><span class="p">)</span>
<span class="w">            </span><span class="n">rea1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="n">rea1</span><span class="p">)</span>
<span class="w">            </span><span class="n">Indic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span>
<span class="w">        </span><span class="k">end if</span>
<span class="w">        </span><span class="c">! N BEING NEGATIVE IS A SIGNAL TO DECREASE REA AND REA1 TO TRY</span>
<span class="w">        </span><span class="c">! FOR MORE ACCURACY.  AMONG OTHER THINGS, THIS MAKES IT MORE</span>
<span class="w">        </span><span class="c">! LIKELY THAT THE PREVIOUS VERTEX WILL BE RETAINED IN PHASE 1</span>
<span class="w">        </span><span class="c">! BELOW, BUT IT ALSO COULD INCREASE ROUND OFF ERROR.</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! RESET N.</span>
<span class="w">            </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">n</span>
<span class="w">            </span><span class="n">rea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rea1</span>
<span class="w">            </span><span class="n">rea1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rea1</span><span class="o">/</span><span class="p">(</span><span class="n">ten</span><span class="o">*</span><span class="n">ten</span><span class="p">)</span>
<span class="w">            </span><span class="n">Indic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span>
<span class="w">        </span><span class="k">end if</span>
<span class="w">        </span><span class="c">! PRESERVE REA IN CASE IT MUST BE TEMPORARILY RELAXED.</span>
<span class="w">        </span><span class="c">! IRLAX=0 INDICATES REA IS NOT RELAXED AT THIS STAGE.</span>
<span class="w">        </span><span class="n">reakp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rea</span>
<span class="w">        </span><span class="n">irlax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="c">! IN COLUMN N+1, NUMBERS &lt;= REA2 IN ABSOLUTE VALUE WILL BE</span>
<span class="w">        </span><span class="c">! TREATED AS ZEROES.</span>
<span class="w">        </span><span class="n">rea2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rea1</span>
<span class="w">        </span><span class="n">np1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="n">mp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="n">ktjor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">iback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="c">! SET V(MP1,NP1)=0.0 SO THE DESCRIPTIONS IN AND FOLLOWING THE</span>
<span class="w">        </span><span class="c">! PROLOGUE WILL AGREE.</span>
<span class="w">        </span><span class="n">v</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">np1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">        </span><span class="c">! THE ONLY REASON FOR THE FOLLOWING THREE STATEMENTS IS TO</span>
<span class="w">        </span><span class="c">! AVOID THE ERROR MESSAGE ON SOME MACHINES THAT THESE</span>
<span class="w">        </span><span class="c">! VARIABLES HAVE NOT BEEN ASSIGNED A VALUE.  THEY WILL BE</span>
<span class="w">        </span><span class="c">! REASSIGNED A VALUE BEFORE THE PROGRAM REACHES A SPOT WHERE</span>
<span class="w">        </span><span class="c">! THEY WILL ACTUALLY BE USED.</span>
<span class="w">        </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">        </span><span class="n">amprv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">        </span><span class="n">ampr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">        </span><span class="c">! SET IXRCT.  IXRCT(I)=0 MEANS SOME Y IS IN ROW I, WHILE</span>
<span class="w">        </span><span class="c">! IXRCT(I)=K/=0 MEANS X(K) IS IN ROW I.</span>
<span class="w">        </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span>
<span class="w">            </span><span class="n">Ixrct</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="k">end do</span>

<span class="w">        </span><span class="c">! EXCHANGE THE XS AT THE TOP OF THE TABLE FOR YS.</span>
<span class="w">        </span><span class="c">! IF IYRCT(1) IS NONPOSITIVE, WE SET IYRCT AND CHOOSE THE</span>
<span class="w">        </span><span class="c">! LARGEST POSSIBLE RESOLVENTS FOR THE EXCHANGES.  IF</span>
<span class="w">        </span><span class="c">! IYRCT(1) IS POSITIVE, IYRCT WILL HAVE BEEN PREVIOUSLY SET</span>
<span class="w">        </span><span class="c">! AND WE TRY TO EXCHANGE IN ROWS IYRCT(1),...,IYRCT(N),</span>
<span class="w">        </span><span class="c">! STILL EMPLOYING A PIVOTING STRATEGY, BUT IF WE CANNOT, WE</span>
<span class="w">        </span><span class="c">! EXCHANGE IN ROWS IYRCT(N+1),...,IYRCT(M).</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Iyrct</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">i10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="n">i20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span>
<span class="w">            </span><span class="c">! IF WE HAVE NO INFORMATION FROM A PREVIOUS VERTEX, WE GIVE</span>
<span class="w">            </span><span class="c">! UP A LITTLE ACCURACY IN COLUMN N+1 TO HAVE A BETTER CHANCE</span>
<span class="w">            </span><span class="c">! OF SUCCESS.</span>
<span class="w">            </span><span class="n">rea2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rea</span>
<span class="w">            </span><span class="c">! THIS ROUTINE HAS A BACKTRACKING OPTION WHICH SOMETIMES</span>
<span class="w">            </span><span class="c">! INCREASES ACCURACY BUT SOMETIMES LEADS TO FAILURE DUE TO</span>
<span class="w">            </span><span class="c">! CYCLING.  IT IS SUGGESTED THAT THIS OPTION BE EMPLOYED IF</span>
<span class="w">            </span><span class="c">! INFORMATION ABOUT A STARTING VERTEX IS AVAILABLE, AND</span>
<span class="w">            </span><span class="c">! OTHERWISE BE DISABLED BY SETTING IBACK=1.</span>
<span class="w">            </span><span class="n">iback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span>
<span class="w">                </span><span class="n">Iyrct</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">        else</span>
<span class="k">            </span><span class="n">i10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="n">i20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="c">! SET THE LOWER BOUND ON THE ABSOLUTE VALUE OF A RESOLVENT IN</span>
<span class="w">        </span><span class="c">! PHASE 1.  ALSO SET IFAIL=0 TO INDICATE THE RESOLVENT SEARCH</span>
<span class="w">        </span><span class="c">! IN THIS COLUMN HAS NOT FAILED.</span>
<span class="w">        </span><span class="n">rea3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rea</span>
<span class="w">        </span><span class="n">ifail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">100</span><span class="w">     </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! REARRANGE THE ROWS OF V SO THAT X(1),...,X(N) COME FIRST</span>
<span class="w">            </span><span class="c">! IN THAT ORDER.  REDEFINE IYRCT SO THAT AFTER THE</span>
<span class="w">            </span><span class="c">! REARRANGEMENT IS DONE, IYRCT(I)=K WILL MEAN Y(K) IS IN</span>
<span class="w">            </span><span class="c">! ROW I (FOR I GREATER THAN N).</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span>
<span class="w">                </span><span class="n">Iyrct</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">            </span><span class="n">irow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="k">goto</span><span class="w"> </span><span class="mi">400</span>
<span class="w">        </span><span class="k">end if</span>
<span class="w">        </span><span class="c">! SET I1, I2 ACCORDING TO THE STRATEGY WE ARE USING.</span>
<span class="mi">200</span><span class="w">     </span><span class="n">i1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i10</span>
<span class="w">        </span><span class="n">i2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i20</span>
<span class="w">        </span><span class="nb">amax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">        </span><span class="c">! SEARCH FOR A RESOLVENT IN ROWS IYRCT(I1),...,IYRCT(I2).</span>
<span class="mi">300</span><span class="w">     </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i1</span><span class="p">,</span><span class="w"> </span><span class="n">i2</span>
<span class="w">            </span><span class="n">iytmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iyrct</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Ixrct</span><span class="p">(</span><span class="n">iytmp</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">absv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">iytmp</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">))</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">absv</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nb">amax</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">iyri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iytmp</span>
<span class="w">                    </span><span class="nb">amax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">absv</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">        end do</span>
<span class="w">        </span><span class="c">! CHECK TO SEE IF THE PROSPECTIVE RESOLVENT IS LARGE ENOUGH</span>
<span class="w">        </span><span class="c">! IN ABSOLUTE VALUE.</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">amax</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">rea3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! EXCHANGE X(J) FOR Y(IYRI).</span>
<span class="w">            </span><span class="k">call </span><span class="n">sjelim</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">np1</span><span class="p">,</span><span class="w"> </span><span class="n">iyri</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="w">            </span><span class="n">Ixrct</span><span class="p">(</span><span class="n">iyri</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span>
<span class="w">            </span><span class="n">Iycct</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iyri</span>
<span class="w">            </span><span class="c">! IYCCT(J)=IYRI MEANS Y(IYRI) IS IN COLUMN J.</span>
<span class="w">            </span><span class="c">! RESET REA3 AND IFAIL SINCE WE SUCCESSFULLY FOUND A RESOLVENT IN</span>
<span class="w">            </span><span class="c">! THIS COLUMN, AND THE RESOLVENT SEARCH IN THE NEXT COLUMN HAS</span>
<span class="w">            </span><span class="c">! NOT FAILED.</span>
<span class="w">            </span><span class="n">rea3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rea</span>
<span class="w">            </span><span class="n">ifail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="k">goto</span><span class="w"> </span><span class="mi">100</span>
<span class="w">            </span><span class="c">! WE HAVE NOT FOUND A SUITABLE RESOLVENT IN ROWS IYRCT(I1),</span>
<span class="w">            </span><span class="c">! ...IYRCT(I2).  IF I2 &lt; M WE SEARCH THE REST OF COLUMN J.</span>
<span class="w">        </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">i2</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">i1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="n">i2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span>
<span class="w">            </span><span class="k">goto</span><span class="w"> </span><span class="mi">300</span>
<span class="w">            </span><span class="c">! HERE WE FAILED TO FIND A RESOLVENT IN COLUMN J WITH ABSOLUTE</span>
<span class="w">            </span><span class="c">! VALUE &gt; REA3.  IF IFAIL=0 WE SET INDIC=-3 AND TRY AGAIN</span>
<span class="w">            </span><span class="c">! WITH REA3 REDUCED.  IF THIS HAS ALREADY BEEN TRIED WE SET</span>
<span class="w">            </span><span class="c">! INDIC=1 AND RETURN.</span>
<span class="w">        </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">ifail</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">ifail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="n">Indic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span>
<span class="w">            </span><span class="n">rea3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rea1</span>
<span class="w">            </span><span class="k">goto</span><span class="w"> </span><span class="mi">200</span>
<span class="w">        </span><span class="k">else</span>
<span class="k">            </span><span class="n">Indic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">return</span>
<span class="k">        end if</span>
<span class="mi">400</span><span class="w">     </span><span class="n">irow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">irow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">irow</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">Ixrct</span><span class="p">(</span><span class="n">irow</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">400</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Ixrct</span><span class="p">(</span><span class="n">irow</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">irow</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">400</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span><span class="c">! NOW IXRCT IS NO LONGER NEEDED, SO STORE THE PRESENT IYCCT</span>
<span class="w">            </span><span class="c">! IN IT.</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                </span><span class="n">Ixrct</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iycct</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>
<span class="w">            </span><span class="c">! END OF PHASE 1.</span>

<span class="w">            </span><span class="c">! THE FIRST N ROWS OF V GIVE THE XS IN TERMS OF CERTAIN</span>
<span class="w">            </span><span class="c">! YS.  THESE ROWS WILL NOT BE CHANGED BY LATER OPERATIONS.</span>
<span class="w">            </span><span class="c">!</span>
<span class="w">            </span><span class="c">! WE NOW ATTACK THE MAXIMIZATION PROBLEM BY LOOKING AT THE</span>
<span class="w">            </span><span class="c">! DUAL PROBLEM OF MINIMIZING A FORM GIVEN BY THE</span>
<span class="w">            </span><span class="c">! COEFFICIENTS IN V(N+1,N+1) THROUGH V(M,N+1) WITH SLACK</span>
<span class="w">            </span><span class="c">! TERMS IN THE BOTTOM ROW OF V.</span>
<span class="w">            </span><span class="c">! SEARCH ROW M+1 FOR A SIGNIFICANTLY NEGATIVE ELEMENT.  IF</span>
<span class="w">            </span><span class="c">! THERE ARE NONE, PROCEED TO THE ACTUAL MINIMIZATION</span>
<span class="w">            </span><span class="c">! PROBLEM.  STICK WITH COLUMN JJ UNTIL V(M+1,JJ) &gt;= -REA1.</span>
<span class="w">            </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="k">goto</span><span class="w"> </span><span class="mi">600</span>
<span class="w">        </span><span class="k">end if</span>
<span class="w">        </span><span class="c">! NOW X(L) IS IN ROW IROW, BUT WE WANT IT IN ROW L.</span>
<span class="mi">500</span><span class="w">     </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ixrct</span><span class="p">(</span><span class="n">irow</span><span class="p">)</span>
<span class="w">        </span><span class="n">ll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ixrct</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ll</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! X(L) IS IN ROW IROW, WHILE X(LL) IS IN ROW L.</span>
<span class="w">            </span><span class="n">Ixrct</span><span class="p">(</span><span class="n">irow</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ll</span>
<span class="w">            </span><span class="n">Ixrct</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span><span class="c">! X(L) IS IN ROW IROW, WHILE Y(IYRCT(L)) IS IN ROW L.</span>
<span class="w">            </span><span class="n">Ixrct</span><span class="p">(</span><span class="n">irow</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">Iyrct</span><span class="p">(</span><span class="n">irow</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iyrct</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="w">            </span><span class="n">Ixrct</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span>
<span class="w">        </span><span class="k">end if</span>
<span class="w">        </span><span class="c">! NOW EXCHANGE THE CONTENTS OF ROWS IROW AND L.</span>
<span class="w">        </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">np1</span>
<span class="w">            </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">irow</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span>
<span class="w">            </span><span class="n">v</span><span class="p">(</span><span class="n">irow</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span>
<span class="w">            </span><span class="n">v</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span>
<span class="w">        </span><span class="k">end do</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">Ixrct</span><span class="p">(</span><span class="n">irow</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">400</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Ixrct</span><span class="p">(</span><span class="n">irow</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">irow</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">400</span>
<span class="w">        </span><span class="k">goto</span><span class="w"> </span><span class="mi">500</span>
<span class="mi">600</span><span class="w">     </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jj</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jj</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! IN THE UNLIKELY EVENT THAT SOME V(M+1,J) IS STILL VERY</span>
<span class="w">            </span><span class="c">! SIGNIFICANTLY NEGATIVE WE BACKTRACK TO COLUMN J.  THIS</span>
<span class="w">            </span><span class="c">! COULD NOT HAPPEN IF THERE WERE NO ROUNDOFF ERROR AND WE</span>
<span class="w">            </span><span class="c">! COULD ALLOW DIVISION BY NUMBERS WITH VERY SMALL ABSOLUTE</span>
<span class="w">            </span><span class="c">! VALUE.  OMIT BACKTRACKING IF IBACK=1.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iback</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rea</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span>
<span class="w">                        </span><span class="k">goto</span><span class="w"> </span><span class="mi">700</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                end do</span>
<span class="k">            end if</span>
<span class="k">            goto</span><span class="w"> </span><span class="mi">900</span>
<span class="w">        </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rea1</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            goto</span><span class="w"> </span><span class="mi">600</span>
<span class="w">        </span><span class="k">end if</span>

<span class="w">        </span><span class="c">! WE HAVE V(M+1,JJ) SIGNIFICANTLY NEGATIVE.  SEARCH COLUMN</span>
<span class="w">        </span><span class="c">! JJ FOR A POSITIVE ELEMENT, TREATING A VERY SMALL V(I,J)</span>
<span class="w">        </span><span class="c">! AS A ZERO.  IF THERE ARE NO POSITIVE ELEMENTS THE DUAL</span>
<span class="w">        </span><span class="c">! CONSTRAINTS WERE INCONSISTENT, SO THE ORIGINAL PROBLEM WAS</span>
<span class="w">        </span><span class="c">! INCONSISTENT OR UNBOUNDED.</span>
<span class="mi">700</span><span class="w">     </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="n">inamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">800</span><span class="w">     </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">rea</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">800</span>
<span class="w">            </span><span class="c">! NOW V(I,JJ) &gt; REA.  WE SEARCH ROW I FOR INDICES K SUCH</span>
<span class="w">            </span><span class="c">! THAT V(M+1,K) &gt;= 0.0.OR.K &lt; JJ, AND V(I,K) &lt; -REA, AND</span>
<span class="w">            </span><span class="c">! FIND THE MAXIMUM RATIO (I.E. THE RATIO WITH SMALLEST</span>
<span class="w">            </span><span class="c">! ABSOLUTE VALUE, IF V(M+1,K) &gt;= 0.0) V(M+1,K)/V(I,K).  IF</span>
<span class="w">            </span><span class="c">! THERE IS NO SUCH K WE LOOK AT POSITIVE V(I,K) BELOW.</span>
<span class="w">            </span><span class="n">indst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">850</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rea</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">dist1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">indst</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        if</span><span class="w"> </span><span class="p">(</span><span class="n">dist1</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dist</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">850</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                    </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dist1</span>
<span class="w">                    </span><span class="n">indst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span>
<span class="w">                </span><span class="k">end if</span>
<span class="mi">850</span><span class="w">         </span><span class="k">end do</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">indst</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="c">! IF THERE WAS NO INDEX K SUCH THAT V(M+1,K) &gt;= 0.0.OR.K &lt;</span>
<span class="w">                </span><span class="c">! JJ, AND V(I,K) &lt; -REA, WE LOOK FOR THE SMALLEST (I.E.</span>
<span class="w">                </span><span class="c">! LARGEST IN ABSOLUTE VALUE) RATIO V(M+1,K)/V(I,K) FOR</span>
<span class="w">                </span><span class="c">! V(I,K) &gt; REA AND V(M+1,K) &lt; 0.0, AND PERFORM AN</span>
<span class="w">                </span><span class="c">! ELIMINATION WITH RESOLVENT V(I,K).  THERE IS AT LEAST ONE</span>
<span class="w">                </span><span class="c">! SUCH K, NAMELY JJ.</span>
<span class="w">                </span><span class="c">! THIS WILL FINISH PHASE 2 UNLESS BACKTRACKING IS NECESSARY.</span>
<span class="w">                </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">                </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">rea</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            </span><span class="n">dist1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dist1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dist</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dist1</span>
<span class="w">                                </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span>
<span class="w">                            </span><span class="k">end if</span>
<span class="k">                        end if</span>
<span class="k">                    end if</span>
<span class="k">                end do</span>
<span class="k">            else</span>
<span class="w">                </span><span class="c">! WE NOW COMPUTE V(I,JJ)*DIST AND GO ON TO LOOK AT OTHER</span>
<span class="w">                </span><span class="c">! ROWS TO MINIMIZE THIS QUANTITY (I.E. TO MAXIMIZE ITS</span>
<span class="w">                </span><span class="c">! ABSOLUTE VALUE, IF V(M+1,K) &gt;= 0.0).  THIS IS THE NEGATIVE</span>
<span class="w">                </span><span class="c">! OF THE CHANGE IN V(M+1,JJ).</span>
<span class="w">                </span><span class="n">bmprv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">jj</span><span class="p">)</span><span class="o">*</span><span class="n">dist</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">inamp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="n">bmprv</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">amprv</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">800</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">                </span><span class="n">amprv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bmprv</span>
<span class="w">                </span><span class="n">inamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                </span><span class="n">kpmp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">                </span><span class="n">kpmp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span>
<span class="w">                </span><span class="c">! (KPMP1,KPMP2) GIVES THE POSITION OF THE BEST PROSPECTIVE</span>
<span class="w">                </span><span class="c">! RESOLVENT FOUND SO FAR.</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="mi">800</span>
<span class="w">            </span><span class="k">end if</span>

<span class="k">        else if</span><span class="w"> </span><span class="p">(</span><span class="n">inamp</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! AT THIS POINT INAMP IS POSITIVE IFF THERE WAS AT LEAST ONE</span>
<span class="w">            </span><span class="c">! ELEMENT &gt; REA IN COLUMN JJ.  IF THERE WERE NONE, WE</span>
<span class="w">            </span><span class="c">! TEMPORARILY RELAX REA AND TRY AGAIN.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">irlax</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">irlax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                </span><span class="n">Indic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                </span><span class="n">rea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rea1</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="mi">700</span>
<span class="w">            </span><span class="k">else</span>
<span class="k">                </span><span class="n">Indic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">                </span><span class="k">return</span>
<span class="k">            end if</span>
<span class="k">        else</span>

<span class="w">            </span><span class="c">! CHECK TO SEE IF V(MP1,KPMP2) IS VERY SMALL IN ABSOLUTE</span>
<span class="w">            </span><span class="c">! VALUE OR NEGATIVE.  THIS INDICATES DEGENERACY.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">kpmp2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">rea</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="c">! WE ARE NOW STUCK IN DEGENERATE COLUMN KPMP2.  WE SEARCH</span>
<span class="w">                </span><span class="c">! EACH DEGENERATE COLUMN IN WHICH WE ARE STUCK FOR A</span>
<span class="w">                </span><span class="c">! RESOLVENT WHICH WILL KEEP US FROM GETTING STUCK IN THIS</span>
<span class="w">                </span><span class="c">! COLUMN NEXT TIME, AND TO REDUCE THE ROUND-OFF ERROR WE</span>
<span class="w">                </span><span class="c">! TAKE THE SMALLEST OF THESE (I.E. LARGEST IN ABSOLUTE</span>
<span class="w">                </span><span class="c">! VALUE) AS OUR ACTUAL RESOLVENT.</span>
<span class="w">                </span><span class="nb">amin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">                </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                    </span><span class="c">! COLUMN J MAY BE DEGENERATE IF 0.0 &lt;= V(M+1,J) &lt;= REA,</span>
<span class="w">                    </span><span class="c">! OR V(M+1,J) &lt; 0.0.AND.J &lt; JJ.</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">860</span>
<span class="w">                    </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">rea</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        goto</span><span class="w"> </span><span class="mi">860</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="w">                    </span><span class="c">! WE WILL BE STUCK IN COLUMN J IFF THERE IS AN INDEX ID FOR</span>
<span class="w">                    </span><span class="c">! WHICH V(ID,JJ) &gt; REA AND V(ID,J) &lt; -REA.  IF THIS IS THE</span>
<span class="w">                    </span><span class="c">! CASE, CHOOSING SUCH AN ID SO THAT V(ID,JJ)/V(ID,J) IS</span>
<span class="w">                    </span><span class="c">! MINIMIZED (I.E. MAXIMIZED IN ABSOLUTE VALUE) AND TAKING</span>
<span class="w">                    </span><span class="c">! V(ID,J) AS THE RESOLVENT WILL INSURE THAT WE DONT GET</span>
<span class="w">                    </span><span class="c">! STUCK IN COLUMN J NEXT TIME.</span>
<span class="w">                    </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">                    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">rea</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rea</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                </span><span class="n">dist1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">jj</span><span class="p">)</span><span class="o">/</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span>
<span class="w">                                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dist1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dist</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                    </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dist1</span>
<span class="w">                                    </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">                                </span><span class="k">end if</span>
<span class="k">                            end if</span>
<span class="k">                        end if</span>
<span class="k">                    end do</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="n">dist</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">one</span><span class="o">/</span><span class="n">two</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                        </span><span class="c">! WE HAVE NOW DETERMINED THAT WE ARE STUCK IN COLUMN J.</span>
<span class="w">                        </span><span class="c">! IF V(ID,J) &lt; AMIN THEN V(ID,J) IS THE BEST RESOLVENT</span>
<span class="w">                        </span><span class="c">! FOUND SO FAR.</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nb">amin</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            </span><span class="nb">amin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span>
<span class="w">                            </span><span class="n">kpmp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span>
<span class="w">                            </span><span class="n">kpmp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span>
<span class="w">                        </span><span class="k">end if</span>
<span class="k">                    end if</span>
<span class="w">                    </span><span class="c">! THE BEST RESOLVENT IS V(KPMP1,KPMP2), SO WE DO AN</span>
<span class="w">                    </span><span class="c">! ELIMINATION.</span>
<span class="mi">860</span><span class="w">             </span><span class="k">end do</span>
<span class="k">            end if</span>
<span class="w">            </span><span class="c">! DO AN ELIMINATION WITH RESOLVENT V(KPMP1,KPMP2).</span>
<span class="w">            </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kpmp1</span>
<span class="w">            </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kpmp2</span>
<span class="w">        </span><span class="k">end if</span>

<span class="k">        </span><span class="n">ktjor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ktjor</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ktjor</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">limjor</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">1200</span>
<span class="w">        </span><span class="k">call </span><span class="n">sjelim</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">np1</span><span class="p">,</span><span class="w"> </span><span class="n">np1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="w">        </span><span class="n">itemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iyrct</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">        </span><span class="n">Iyrct</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iycct</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="w">        </span><span class="n">Iycct</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itemp</span>
<span class="w">        </span><span class="c">! RESET REA AND IRLAX.</span>
<span class="w">        </span><span class="n">rea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reakp</span>
<span class="w">        </span><span class="n">irlax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="c">! IF NOW V(M+1,JJ) HAS BEEN MADE NOT SIGNIFICANTLY NEGATIVE,</span>
<span class="w">        </span><span class="c">! WE GO TO THE NEXT COLUMN.  OTHERWISE WE TRY AGAIN IN</span>
<span class="w">        </span><span class="c">! COLUMN JJ.</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rea1</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">600</span>
<span class="w">        </span><span class="k">goto</span><span class="w"> </span><span class="mi">700</span>
<span class="w">        </span><span class="c">! END OF PHASE 2.</span>

<span class="mi">900</span><span class="w">     </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="n">kkk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">        </span><span class="c">! SEARCH FOR A SIGNIFICANTLY NEGATIVE ELEMENT BETWEEN</span>
<span class="w">        </span><span class="c">! V(N+1,N+1) AND V(N+1,M).  IF THERE ARE NONE WE HAVE THE</span>
<span class="w">        </span><span class="c">! MINIMAL POINT OF THE DUAL PROBLEM (AND THUS THE MAXIMAL</span>
<span class="w">        </span><span class="c">! POINT OF THE DIRECT PROBLEM) ALREADY.</span>
<span class="mi">1000</span><span class="w">    </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">np1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rea2</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">1000</span>

<span class="w">            </span><span class="c">! SEARCH FOR A NEGATIVE ELEMENT IN ROW I, TREATING A NUMBER</span>
<span class="w">            </span><span class="c">! WHICH IS VERY SMALL IN ABSOLUTE VALUE AS A ZERO.  IF THERE</span>
<span class="w">            </span><span class="c">! ARE NO NEGATIVE ELEMENTS THE DUAL PROBLEM WAS UNBOUNDED</span>
<span class="w">            </span><span class="c">! BELOW, SO THE ORIGINAL CONSTRAINTS WERE INCONSISTENT.</span>
<span class="w">            </span><span class="c">! FIND THE INDEX K OF THE LARGEST (I.E. SMALLEST IN ABSOLUTE</span>
<span class="w">            </span><span class="c">! VALUE, IF V(M+1,K) &gt;= 0.0) RATIO V(M+1,K)/V(I,K) WITH</span>
<span class="w">            </span><span class="c">! V(I,K) &lt; -REA.</span>
<span class="mi">1050</span><span class="w">        </span><span class="n">indst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rea</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">dist1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">indst</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        if</span><span class="w"> </span><span class="p">(</span><span class="n">dist1</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dist</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">1100</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                    </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span>
<span class="w">                    </span><span class="n">indst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dist1</span>
<span class="w">                </span><span class="k">end if</span>
<span class="mi">1100</span><span class="w">        </span><span class="k">end do</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">indst</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="c">! COMPUTE THE IMPROVEMENT DIST*V(I,N+1) IN THE VALUE OF THE</span>
<span class="w">                </span><span class="c">! FORM USING V(I,K) AS THE RESOLVENT.  SET KKK=1 TO INDICATE</span>
<span class="w">                </span><span class="c">! A SIGNIFICANTLY NEGATIVE V(I,N+1) WAS FOUND, AND LOOK AT</span>
<span class="w">                </span><span class="c">! THE OTHER ROWS TO FIND THE RESOLVENT GIVING THE LARGEST</span>
<span class="w">                </span><span class="c">! IMPROVEMENT.</span>
<span class="w">                </span><span class="n">bmpr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dist</span><span class="o">*</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">np1</span><span class="p">)</span>
<span class="w">                </span><span class="c">! RESET IRLAX SO THAT THE NEXT ROW WHICH NEEDS RELAXING DOES</span>
<span class="w">                </span><span class="c">! NOT TERMINATE THE ROUTINE.  REA WILL REMAIN RELAXED UNTIL</span>
<span class="w">                </span><span class="c">! AFTER THE NEXT ELIMINATION.</span>
<span class="w">                </span><span class="n">irlax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">kkk</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="n">bmpr2</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">ampr2</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">                </span><span class="n">kkk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                </span><span class="n">keep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">                </span><span class="n">keep1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span>
<span class="w">                </span><span class="n">ampr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bmpr2</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">                </span><span class="c">! RELAX REA AND LOOK FOR NEGATIVE ELEMENTS WITH SMALLER</span>
<span class="w">                </span><span class="c">! ABSOLUTE VALUE.</span>
<span class="w">            </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">irlax</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">irlax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                </span><span class="n">Indic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                </span><span class="n">rea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rea1</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="mi">1050</span>
<span class="w">            </span><span class="k">else</span>
<span class="k">                </span><span class="n">Indic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
<span class="w">                </span><span class="k">return</span>
<span class="k">            end if</span>
<span class="w">            </span><span class="c">! KKK=0 HERE IFF NONE OF THE COST COEFFICIENTS ARE</span>
<span class="w">            </span><span class="c">! SIGNIFICANTLY NEGATIVE.</span>
<span class="w">        </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">kkk</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! CHECK TO SEE IF V(MP1,KEEP1) IS VERY SMALL IN ABSOLUTE</span>
<span class="w">            </span><span class="c">! VALUE OR NEGATIVE.  THIS INDICATES DEGENERACY.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">keep1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">rea</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="c">! WE ARE NOW STUCK IN DEGENERATE COLUMN KEEP1.  WE SEARCH</span>
<span class="w">                </span><span class="c">! EACH DEGENERATE COLUMN IN WHICH WE ARE STUCK FOR A</span>
<span class="w">                </span><span class="c">! RESOLVENT WHICH WILL KEEP US FROM GETTING STUCK IN THIS</span>
<span class="w">                </span><span class="c">! COLUMN NEXT TIME.  IF WE ARE NOT USING THE OPTION</span>
<span class="w">                </span><span class="c">! DESCRIBED IN THE COMMENTS PRECEDING STATEMENT 1055, WE</span>
<span class="w">                </span><span class="c">! TAKE THE SMALLEST OF THESE (I.E. THE LARGEST IN ABSOLUTE</span>
<span class="w">                </span><span class="c">! VALUE) AS OUR ACTUAL RESOLVENT IN ORDER TO REDUCE THE</span>
<span class="w">                </span><span class="c">! GROWTH OF ROUND-OFF ERROR.</span>
<span class="w">                </span><span class="nb">amin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">                </span><span class="n">mxrkn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np1</span>
<span class="w">                </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                    </span><span class="c">! COLUMN J MAY BE DEGENERATE IF V(M+1,J) &lt;= REA.</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">rea</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                        </span><span class="c">! WE WILL BE STUCK IN COLUMN J IFF THERE IS AN INDEX ID FOR</span>
<span class="w">                        </span><span class="c">! WHICH V(ID,N+1) &lt; -REA2 AND V(ID,J) &lt; -REA.  IF THIS</span>
<span class="w">                        </span><span class="c">! IS THE CASE, CHOOSING SUCH AN ID SO THAT V(ID,N+1)/V(ID,J)</span>
<span class="w">                        </span><span class="c">! IS MAXIMIZED AND TAKING V(ID,J) AS THE RESOLVENT WILL</span>
<span class="w">                        </span><span class="c">! INSURE THAT WE DONT GET STUCK IN COLUMN J NEXT TIME.</span>
<span class="w">                        </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">one</span>
<span class="w">                        </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">np1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rea2</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rea</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                    </span><span class="n">dist1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">np1</span><span class="p">)</span><span class="o">/</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span>
<span class="w">                                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dist1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">dist</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                        </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dist1</span>
<span class="w">                                        </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">                                    </span><span class="k">end if</span>
<span class="k">                                end if</span>
<span class="k">                            end if</span>
<span class="k">                        end do</span>
<span class="k">                        if</span><span class="w"> </span><span class="p">(</span><span class="n">dist</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">one</span><span class="o">/</span><span class="n">two</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">1120</span>

<span class="w">                        </span><span class="c">! WE HAVE NOW DETERMINED THAT WE ARE STUCK IN COLUMN J.</span>
<span class="w">                        </span><span class="c">! THE FOLLOWING STATEMENTS ATTEMPT TO BREAK DEGENERACY</span>
<span class="w">                        </span><span class="c">! FASTER BY LOOKING ONE ITERATION INTO THE FUTURE, THAT IS,</span>
<span class="w">                        </span><span class="c">! BY CHOOSING FROM THE PROSPECTIVE RESOLVENTS FOUND ABOVE</span>
<span class="w">                        </span><span class="c">! THAT ONE WHICH MINIMIZES THE MINIMUM NUMBER OF STICKING</span>
<span class="w">                        </span><span class="c">! PLACES IN ANY ROW AT THE NEXT STAGE.</span>
<span class="w">                        </span><span class="c">! BECAUSE OF COMPUTER TIME AND THE POSSIBLE LOSS OF ACCURACY</span>
<span class="w">                        </span><span class="c">! DUE TO LESSENED PIVOTING (EVEN THOUGH TIES ARE ALWAYS</span>
<span class="w">                        </span><span class="c">! BROKEN IN FAVOR OF THE RESOLVENT WITH GREATEST ABSOLUTE</span>
<span class="w">                        </span><span class="c">! VALUE), IT IS SUGGESTED THAT THIS OPTION BE OMITTED IF</span>
<span class="w">                        </span><span class="c">! INFORMATION WAS AVAILABLE FROM A PREVIOUS VERTEX.  THIS</span>
<span class="w">                        </span><span class="c">! WILL BE THE CASE IFF THE BACKTRACKING OPTION WAS USED,</span>
<span class="w">                        </span><span class="c">! THAT IS, IFF IBACK=0.</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iback</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                            </span><span class="c">! COMPUTE WHAT THE NEW BOTTOM ROW WOULD BE (EXCEPT FOR</span>
<span class="w">                            </span><span class="c">! POSITION J) IF V(ID,J) WERE USED AS THE RESOLVENT, AND</span>
<span class="w">                            </span><span class="c">! PUT THE RESULTS INTO Y.</span>
<span class="w">                            </span><span class="n">rowq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">v</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span>
<span class="w">                            </span><span class="k">do </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">rowq</span>
<span class="w">                            </span><span class="k">end do</span>
<span class="k">                            </span><span class="n">lrknt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                            </span><span class="c">! WE LOOK FOR A ROW WHICH WILL HAVE A SIGNIFICANTLY NEGATIVE</span>
<span class="w">                            </span><span class="c">! LAST ELEMENT BUT A MINIMUM NUMBER OF PLACES WHERE WE WILL</span>
<span class="w">                            </span><span class="c">! BE STUCK IN DEGENERATE COLUMNS.  LRKNT=-1 MEANS WE HAVE</span>
<span class="w">                            </span><span class="c">! NOT YET FOUND A ROW WHICH WILL HAVE A SIGNIFICANTLY</span>
<span class="w">                            </span><span class="c">! NEGATIVE LAST ELEMENT.</span>
<span class="w">                            </span><span class="k">do </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span>
<span class="w">                                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ii</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                    </span><span class="n">rowq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">v</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span>
<span class="w">                                    </span><span class="n">rtcol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="w"> </span><span class="n">np1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">np1</span><span class="p">)</span><span class="o">*</span><span class="n">rowq</span>
<span class="w">                                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rtcol</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rea2</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                                        </span><span class="c">! IF WE HAVE ALREADY LOCATED A RESOLVENT WHICH WILL FINISH</span>
<span class="w">                                        </span><span class="c">! THE ROUTINE, BUT THE PRESENT PROSPECTIVE RESOLVENT WOULD</span>
<span class="w">                                        </span><span class="c">! GIVE A ROW WITH A SIGNIFICANTLY NEGATIVE LAST ELEMENT, WE</span>
<span class="w">                                        </span><span class="c">! LOOK AT THE NEXT PROSPECTIVE RESOLVENT FOR PIVOTING</span>
<span class="w">                                        </span><span class="c">! PURPOSES.</span>
<span class="w">                                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mxrkn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">1120</span>
<span class="w">                                        </span><span class="n">lrknt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                                        </span><span class="c">! NOW COUNT THE NUMBER (LRKNT) OF STICKING PLACES IN ROW II</span>
<span class="w">                                        </span><span class="c">! AT THE NEXT ITERATION.</span>
<span class="w">                                        </span><span class="k">do </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jj</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                                if</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">rea</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                                    if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="w"> </span><span class="n">jj</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">jj</span><span class="p">)</span><span class="o">*</span><span class="n">rowq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rea</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                                        </span><span class="n">lrknt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lrknt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                                                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lrknt</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">mxrkn</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">1102</span>
<span class="w">                                                    </span><span class="k">end if</span>
<span class="k">                                                end if</span>
<span class="k">                                            end if</span>
<span class="k">                                        end do</span>
<span class="k">                                        if</span><span class="w"> </span><span class="p">(</span><span class="n">lrknt</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">mxrkn</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                        else if</span><span class="w"> </span><span class="p">(</span><span class="n">lrknt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">mxrkn</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                            if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nb">amin</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">1102</span>
<span class="w">                                        </span><span class="k">else</span>
<span class="k">                                            goto</span><span class="w"> </span><span class="mi">1102</span>
<span class="w">                                        </span><span class="k">end if</span>
<span class="k">                                        </span><span class="n">mxrkn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lrknt</span>
<span class="w">                                        </span><span class="nb">amin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span>
<span class="w">                                        </span><span class="n">keep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span>
<span class="w">                                        </span><span class="n">keep1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span>
<span class="w">                                    </span><span class="k">end if</span>
<span class="k">                                end if</span>
<span class="mi">1102</span><span class="w">                        </span><span class="k">end do</span>
<span class="w">                            </span><span class="c">! LRKNT=-1 HERE WOULD MEAN THIS RESOLVENT WOULD FINISH THE</span>
<span class="w">                            </span><span class="c">! ROUTINE.  IF LRKNT &gt;= 0 THEN MXRKN &gt;= 0 ALSO, SO WE WILL</span>
<span class="w">                            </span><span class="c">! NOT HAVE EARLIER FOUND A RESOLVENT WHICH WILL FINISH THE</span>
<span class="w">                            </span><span class="c">! ROUTINE.</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lrknt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">1120</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mxrkn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">1105</span>
<span class="w">                        </span><span class="k">end if</span>
<span class="k">                        if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nb">amin</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="mi">1120</span>
<span class="mi">1105</span><span class="w">                    </span><span class="n">mxrkn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                        </span><span class="nb">amin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span>
<span class="w">                        </span><span class="n">keep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span>
<span class="w">                        </span><span class="n">keep1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="w">                    </span><span class="c">! THE BEST RESOLVENT IS V(KEEP,KEEP1), SO WE DO AN</span>
<span class="w">                    </span><span class="c">! ELIMINATION.</span>
<span class="mi">1120</span><span class="w">            </span><span class="k">end do</span>
<span class="k">            end if</span>
<span class="w">            </span><span class="c">! DO AN ELIMINATION WITH RESOLVENT V(KEEP,KEEP1).</span>
<span class="w">            </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">keep</span>
<span class="w">            </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">keep1</span>

<span class="w">            </span><span class="n">ktjor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ktjor</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ktjor</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">limjor</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                call </span><span class="n">sjelim</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">np1</span><span class="p">,</span><span class="w"> </span><span class="n">np1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">Nparm</span><span class="p">,</span><span class="w"> </span><span class="n">Numgr</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="w">                </span><span class="n">itemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iyrct</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                </span><span class="n">Iyrct</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iycct</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="w">                </span><span class="n">Iycct</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itemp</span>
<span class="w">                </span><span class="c">! RESET REA AND IRLAX.</span>
<span class="w">                </span><span class="n">rea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reakp</span>
<span class="w">                </span><span class="n">irlax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="mi">900</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">        else</span>
<span class="w">            </span><span class="c">! CHECK TO SEE IF ANY OF THE NUMBERS IN THE BOTTOM ROW HAVE</span>
<span class="w">            </span><span class="c">! BECOME VERY SIGNIFICANTLY NEGATIVE.  IF SO, WE MUST</span>
<span class="w">            </span><span class="c">! BACKTRACK TO PHASE 2 (SEE COMMENT ABOVE STATEMENT 1035).</span>
<span class="w">            </span><span class="c">! OMIT BACKTRACKING IF IBACK=1.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iback</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">mp1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rea</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span>
<span class="w">                        </span><span class="k">goto</span><span class="w"> </span><span class="mi">700</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                end do</span>
<span class="k">            end if</span>
<span class="w">            </span><span class="c">! END OF PHASE 3.  WE NOW HAVE THE VERTEX WE ARE SEEKING.</span>

<span class="w">            </span><span class="c">! READ OFF THE Y VALUES FOR THIS VERTEX.</span>
<span class="w">            </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                </span><span class="n">iycj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iycct</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">                </span><span class="n">y</span><span class="p">(</span><span class="n">iycj</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">            do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span>
<span class="w">                </span><span class="n">iyri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iyrct</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                </span><span class="n">y</span><span class="p">(</span><span class="n">iyri</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">np1</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>
<span class="w">            </span><span class="c">! COMPUTE THE XS FROM THE YS.  RECALL THAT IXRCT CONTAINS</span>
<span class="w">            </span><span class="c">! THE FORMER IYCCT.</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">np1</span><span class="p">)</span>
<span class="w">                </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                    </span><span class="n">ixrj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ixrct</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">                    </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">ixrj</span><span class="p">)</span>
<span class="w">                </span><span class="k">end do</span>
<span class="k">            end do</span>

<span class="w">            </span><span class="c">! NOW PUT THE VALUES IN IYCCT INTO THE FIRST N POSITIONS OF</span>
<span class="w">            </span><span class="c">! IYRCT IN DECREASING ORDER.</span>
<span class="w">            </span><span class="c">! TO ACCOMPLISH THIS, MAKE IXRCT(I)=-1 IF IYCCT(J)=I FOR</span>
<span class="w">            </span><span class="c">! SOME J, THEN SCAN IXRCT BACKWARDS.</span>
<span class="w">            </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                </span><span class="n">iycj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Iycct</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">                </span><span class="n">Ixrct</span><span class="p">(</span><span class="n">iycj</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">            </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp1</span>
<span class="mi">1150</span><span class="w">        </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="c">! NOW FILL IN THE REST OF IYRCT BY SCANNING IXRCT AGAIN.</span>
<span class="w">                </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp1</span>
<span class="mi">1160</span><span class="w">            </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">Ixrct</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">Iyrct</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">                    </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">                goto</span><span class="w"> </span><span class="mi">1160</span>
<span class="w">            </span><span class="k">else</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">Ixrct</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">Iyrct</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">                    </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">                goto</span><span class="w"> </span><span class="mi">1150</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">        end if</span>

<span class="mi">1200</span><span class="w">    </span><span class="n">Indic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>

<span class="w">    </span><span class="k">end subroutine </span><span class="n">slnpro</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              conmax
 was developed by Jacob Williams<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>